function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.search);return null==d?"":decodeURIComponent(d[1].replace(/\+/g," "))}(function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.4.4";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?null:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;d.computed>g&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(b||x.identity);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;e>c.call(d,a[h])?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return y(a,function(a){x.isArray(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(i.apply(d,arguments))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=Array(b),d=0;b>d;d++)c[d]=x.pluck(a,""+d);return c},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);d>e;)f[e++]=a,a+=c;return f},x.bind=function(a,b){if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));var c=h.call(arguments,2);return function(){return a.apply(b,c.concat(h.call(arguments)))}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);return 0===b.length&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)};return function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},x.debounce=function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return 0>=a?b():function(){return 1>--a?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&(b[b.length]=c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var E=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==b+"";case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;c.push(a),d.push(b);var g=0,h=!0;if("[object Array]"==e){if(g=a.length,h=g==b.length)for(;g--&&(h=E(a[g],b[g],c,d)););}else{var i=a.constructor,k=b.constructor;if(i!==k&&!(x.isFunction(i)&&i instanceof i&&x.isFunction(k)&&k instanceof k))return!1;for(var l in a)if(x.has(a,l)&&(g++,!(h=x.has(b,l)&&E(a[l],b[l],c,d))))break;if(h){for(l in b)if(x.has(b,l)&&!g--)break;h=!g}}return c.pop(),d.pop(),h};x.isEqual=function(a,b){return E(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(a),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var F={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};F.unescape=x.invert(F.escape);var G={escape:RegExp("["+x.keys(F.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(F.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(G[a],function(b){return F[a][b]})}}),x.result=function(a,b){if(null==a)return null;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),L.call(this,c.apply(x,a))}})};var H=0;x.uniqueId=function(a){var b=++H+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,J={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},K=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=RegExp([(c.escape||I).source,(c.interpolate||I).source,(c.evaluate||I).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(K,function(a){return"\\"+J[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var L=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],L.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return L.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),!function(a,b,c){function d(a,c){var d,e=b.createElement(a||"div");for(d in c)e[d]=c[d];return e}function e(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function f(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=l.substring(0,l.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return n[e]||(o.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",o.cssRules.length),n[e]=1),e}function g(a,b){var d,e,f=a.style;if(f[b]!==c)return b;for(b=b.charAt(0).toUpperCase()+b.slice(1),e=0;e<m.length;e++)if(d=m[e]+b,f[d]!==c)return d}function h(a,b){for(var c in b)a.style[g(a,c)||c]=b[c];return a}function i(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)a[e]===c&&(a[e]=d[e])}return a}function j(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function k(a){return this.spin?void(this.opts=i(a||{},k.defaults,p)):new k(a)}var l,m=["webkit","Moz","ms","O"],n={},o=function(){var a=d("style",{type:"text/css"});return e(b.getElementsByTagName("head")[0],a),a.sheet||a.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};k.defaults={},i(k.prototype,{spin:function(a){this.stop();var b,c,e=this,f=e.opts,g=e.el=h(d(0,{className:f.className}),{position:f.position,width:0,zIndex:f.zIndex}),i=f.radius+f.length+f.width;if(a&&(a.insertBefore(g,a.firstChild||null),c=j(a),b=j(g),h(g,{left:("auto"==f.left?c.x-b.x+(a.offsetWidth>>1):parseInt(f.left,10)+i)+"px",top:("auto"==f.top?c.y-b.y+(a.offsetHeight>>1):parseInt(f.top,10)+i)+"px"})),g.setAttribute("aria-role","progressbar"),e.lines(g,e.opts),!l){var k=0,m=f.fps,n=m/f.speed,o=(1-f.opacity)/(n*f.trail/100),p=n/f.lines;!function q(){k++;for(var a=f.lines;a;a--){var b=Math.max(1-(k+a*p)%n*o,f.opacity);e.opacity(g,f.lines-a,b,f)}e.timeout=e.el&&setTimeout(q,~~(1e3/m))}()}return e},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=c),this},lines:function(a,b){function c(a,c){return h(d(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*i+b.rotate)+"deg) translate("+b.radius+"px,0)",borderRadius:(b.corners*b.width>>1)+"px"})}for(var g,i=0;i<b.lines;i++)g=h(d(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:l&&f(b.opacity,b.trail,i,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&e(g,h(c("#000","0 0 4px #000"),{top:"2px"})),e(a,e(g,c(b.color,"0 0 1px rgba(0,0,0,.1)")));return a},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}}),function(){function a(a,b){return d("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',b)}var b=h(d("group"),{behavior:"url(#default#VML)"});!g(b,"transform")&&b.adj?(o.addRule(".spin-vml","behavior:url(#default#VML)"),k.prototype.lines=function(b,c){function d(){return h(a("group",{coordsize:j+" "+j,coordorigin:-i+" "+-i}),{width:j,height:j})}function f(b,f,g){e(l,e(h(d(),{rotation:360/c.lines*b+"deg",left:~~f}),e(h(a("roundrect",{arcsize:c.corners}),{width:i,height:c.width,left:c.radius,top:-c.width>>1,filter:g}),a("fill",{color:c.color,opacity:c.opacity}),a("stroke",{opacity:0}))))}var g,i=c.length+c.width,j=2*i,k=2*-(c.width+c.length)+"px",l=h(d(),{position:"absolute",top:k,left:k});if(c.shadow)for(g=1;g<=c.lines;g++)f(g,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(g=1;g<=c.lines;g++)f(g);return e(b,l)},k.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}):l=g(b,"animation")}(),"function"==typeof define&&define.amd?define(function(){return k}):a.Spinner=k}(window,document),function(a,b){function c(c,d){function e(a){return mb.preferFlash&&gb&&!mb.ignoreFlash&&mb.flash[a]!==b&&mb.flash[a]}function f(a){return function(b){var c=this._s;return c&&c._a?b=a.call(this,b):(mb._wD(c&&c.id?c.id+": Ignoring "+b.type:pb+"Ignoring "+b.type),b=null),b}}this.setupOptions={url:c||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!0,noSWFCache:!1},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=d||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20130101",this.altURL=this.movieURL=this.version=null,this.enabled=this.swfLoaded=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.didFlashBlock=this.muted=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null},this.html5={usingFlash:null},this.flash={},this.ignoreFlash=this.html5Only=!1;var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb=this,nb=null,ob=null,pb="HTML5::",qb=navigator.userAgent,rb=a.location.href.toString(),sb=document,tb=[],ub=!0,vb=!1,wb=!1,xb=!1,yb=!1,zb=!1,Ab=0,Bb=["log","info","warn","error"],Cb=null,Db=null,Eb=!1,Fb=!1,Gb=0,Hb=null,Ib=[],Jb=null,Kb=Array.prototype.slice,Lb=!1,Mb=qb.match(/(ipad|iphone|ipod)/i),Nb=qb.match(/android/i),Ob=qb.match(/msie/i),Pb=qb.match(/webkit/i),Qb=qb.match(/safari/i)&&!qb.match(/chrome/i),Rb=qb.match(/opera/i),Sb=qb.match(/(mobile|pre\/|xoom)/i)||Mb||Nb,Tb=!rb.match(/usehtml5audio/i)&&!rb.match(/sm2\-ignorebadua/i)&&Qb&&!qb.match(/silk/i)&&qb.match(/OS X 10_6_([3-7])/i),Ub=a.console!==b&&console.log!==b,Vb=sb.hasFocus!==b?sb.hasFocus():null,Wb=Qb&&(sb.hasFocus===b||!sb.hasFocus()),Xb=!Wb,Yb=/(mp3|mp4|mpa|m4a|m4b)/i,Zb=sb.location?sb.location.protocol.match(/http/i):null,$b=Zb?"":"http://",_b=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,ac="mpeg4 aac flv mov mp4 m4v f4v m4a m4b mp4v 3gp 3g2".split(" "),bc=RegExp("\\.("+ac.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!Zb;var cc;try{cc=Audio!==b&&(Rb&&opera!==b&&10>opera.version()?new Audio(null):new Audio).canPlayType!==b}catch(dc){cc=!1}this.hasHTML5=cc,this.setup=function(a){var c=!mb.url;return a!==b&&xb&&Jb&&mb.ok()&&(a.flashVersion!==b||a.url!==b||a.html5Test!==b)&&T(N("setupLate")),q(a),c&&E&&a.url!==b&&mb.beginDelayedInit(),!E&&a.url!==b&&"complete"===sb.readyState&&setTimeout(C,1),mb},this.supported=this.ok=function(){return Jb?xb&&!yb:mb.useHTML5Audio&&mb.hasHTML5},this.getMovie=function(b){return h(b)||sb[b]||a[b]},this.createSound=function(a,c){function d(){return f=R(f),mb.sounds[f.id]=new g(f),mb.soundIDs.push(f.id),mb.sounds[f.id]}var e,f;return e=null,e="soundManager.createSound(): "+N(xb?"notOK":"notReady"),xb&&mb.ok()?(c!==b&&(a={id:a,url:c}),f=p(a),f.url=Y(f.url),f.id.toString().charAt(0).match(/^[0-9]$/)&&mb._wD("soundManager.createSound(): "+N("badID",f.id),2),mb._wD("soundManager.createSound(): "+f.id+" ("+f.url+")",1),U(f.id,!0)?(mb._wD("soundManager.createSound(): "+f.id+" exists",1),mb.sounds[f.id]):($(f)?(e=d(),mb._wD(f.id+": Using HTML5"),e._setup_html5(f)):(l>8&&(null===f.isMovieStar&&(f.isMovieStar=!(!f.serverURL&&!(f.type&&f.type.match(_b)||f.url.match(bc)))),f.isMovieStar&&(mb._wD("soundManager.createSound(): using MovieStar handling"),1<f.loops&&n("noNSLoop"))),f=S(f,"soundManager.createSound(): "),e=d(),8===l?ob._createSound(f.id,f.loops||1,f.usePolicyFile):(ob._createSound(f.id,f.url,f.usePeakData,f.useWaveformData,f.useEQData,f.isMovieStar,f.isMovieStar?f.bufferTime:!1,f.loops||1,f.serverURL,f.duration||null,f.autoPlay,!0,f.autoLoad,f.usePolicyFile),f.serverURL||(e.connected=!0,f.onconnect&&f.onconnect.apply(e))),!f.serverURL&&(f.autoLoad||f.autoPlay)&&e.load(f)),!f.serverURL&&f.autoPlay&&e.play(),e)):(T(e),!1)},this.destroySound=function(a,b){if(!U(a))return!1;var c,d=mb.sounds[a];for(d._iO={},d.stop(),d.unload(),c=0;c<mb.soundIDs.length;c++)if(mb.soundIDs[c]===a){mb.soundIDs.splice(c,1);break}return b||d.destruct(!0),delete mb.sounds[a],!0},this.load=function(a,b){return U(a)?mb.sounds[a].load(b):!1},this.unload=function(a){return U(a)?mb.sounds[a].unload():!1},this.onposition=this.onPosition=function(a,b,c,d){return U(a)?mb.sounds[a].onposition(b,c,d):!1},this.clearOnPosition=function(a,b,c){return U(a)?mb.sounds[a].clearOnPosition(b,c):!1},this.start=this.play=function(a,b){var c=!1;return xb&&mb.ok()?U(a)?mb.sounds[a].play(b):(b instanceof Object||(b={url:b}),b&&b.url&&(mb._wD('soundManager.play(): attempting to create "'+a+'"',1),b.id=a,c=mb.createSound(b).play()),c):(T("soundManager.play(): "+N(xb?"notOK":"notReady")),c)},this.setPosition=function(a,b){return U(a)?mb.sounds[a].setPosition(b):!1},this.stop=function(a){return U(a)?(mb._wD("soundManager.stop("+a+")",1),mb.sounds[a].stop()):!1},this.stopAll=function(){var a;mb._wD("soundManager.stopAll()",1);for(a in mb.sounds)mb.sounds.hasOwnProperty(a)&&mb.sounds[a].stop()},this.pause=function(a){return U(a)?mb.sounds[a].pause():!1},this.pauseAll=function(){var a;for(a=mb.soundIDs.length-1;a>=0;a--)mb.sounds[mb.soundIDs[a]].pause()},this.resume=function(a){return U(a)?mb.sounds[a].resume():!1},this.resumeAll=function(){var a;for(a=mb.soundIDs.length-1;a>=0;a--)mb.sounds[mb.soundIDs[a]].resume()},this.togglePause=function(a){return U(a)?mb.sounds[a].togglePause():!1},this.setPan=function(a,b){return U(a)?mb.sounds[a].setPan(b):!1},this.setVolume=function(a,b){return U(a)?mb.sounds[a].setVolume(b):!1},this.mute=function(a){var b=0;if(a instanceof String&&(a=null),a)return U(a)?(mb._wD('soundManager.mute(): Muting "'+a+'"'),mb.sounds[a].mute()):!1;for(mb._wD("soundManager.mute(): Muting all sounds"),b=mb.soundIDs.length-1;b>=0;b--)mb.sounds[mb.soundIDs[b]].mute();return mb.muted=!0},this.muteAll=function(){mb.mute()},this.unmute=function(a){if(a instanceof String&&(a=null),a)return U(a)?(mb._wD('soundManager.unmute(): Unmuting "'+a+'"'),mb.sounds[a].unmute()):!1;for(mb._wD("soundManager.unmute(): Unmuting all sounds"),a=mb.soundIDs.length-1;a>=0;a--)mb.sounds[mb.soundIDs[a]].unmute();return mb.muted=!1,!0},this.unmuteAll=function(){mb.unmute()},this.toggleMute=function(a){return U(a)?mb.sounds[a].toggleMute():!1},this.getMemoryUse=function(){var a=0;return ob&&8!==l&&(a=parseInt(ob._getMemoryUse(),10)),a},this.disable=function(c){var d;if(c===b&&(c=!1),yb)return!1;for(yb=!0,n("shutdown",1),d=mb.soundIDs.length-1;d>=0;d--)K(mb.sounds[mb.soundIDs[d]]);return o(c),eb.remove(a,"load",u),!0},this.canPlayMIME=function(a){var b;return mb.hasHTML5&&(b=_({type:a})),!b&&Jb&&(b=a&&mb.ok()?!!(l>8&&a.match(_b)||a.match(mb.mimePattern)):null),b},this.canPlayURL=function(a){var b;return mb.hasHTML5&&(b=_({url:a})),!b&&Jb&&(b=a&&mb.ok()?!!a.match(mb.filePattern):null),b},this.canPlayLink=function(a){return a.type!==b&&a.type&&mb.canPlayMIME(a.type)?!0:mb.canPlayURL(a.href)},this.getSoundById=function(a,b){if(!a)throw Error("soundManager.getSoundById(): sID is null/_undefined");var c=mb.sounds[a];return!c&&!b&&mb._wD('"'+a+'" is an invalid sound ID.',2),c},this.onready=function(b,c){if("function"!=typeof b)throw N("needFunction","onready");return xb&&mb._wD(N("queue","onready")),c||(c=a),s("onready",b,c),t(),!0},this.ontimeout=function(b,c){if("function"!=typeof b)throw N("needFunction","ontimeout");return xb&&mb._wD(N("queue","ontimeout")),c||(c=a),s("ontimeout",b,c),t({type:"ontimeout"}),!0},this._writeDebug=function(a,c){var d,e;return mb.debugMode?Ub&&mb.useConsole&&(c&&"object"==typeof c?console.log(a,c):Bb[c]!==b?console[Bb[c]](a):console.log(a),mb.consoleOnly)?!0:(d=h("soundmanager-debug"))?(e=sb.createElement("div"),0===++Ab%2&&(e.className="sm2-alt"),c=c===b?0:parseInt(c,10),e.appendChild(sb.createTextNode(a)),c&&(c>=2&&(e.style.fontWeight="bold"),3===c&&(e.style.color="#ff3333")),d.insertBefore(e,d.firstChild),!0):!1:!1},-1!==rb.indexOf("sm2-debug=alert")&&(this._writeDebug=function(b){a.alert(b)}),this._wD=this._writeDebug,this._debug=function(){var a,b;for(n("currentObj",1),a=0,b=mb.soundIDs.length;b>a;a++)mb.sounds[mb.soundIDs[a]]._debug()},this.reboot=function(b,c){mb.soundIDs.length&&mb._wD("Destroying "+mb.soundIDs.length+" SMSound objects...");var d,e,f;for(d=mb.soundIDs.length-1;d>=0;d--)mb.sounds[mb.soundIDs[d]].destruct();if(ob)try{Ob&&(Db=ob.innerHTML),Cb=ob.parentNode.removeChild(ob),n("flRemoved")}catch(g){n("badRemove",2)}if(Db=Cb=Jb=ob=null,mb.enabled=E=xb=Eb=Fb=vb=wb=yb=Lb=mb.swfLoaded=!1,mb.soundIDs=[],mb.sounds={},b)tb=[];else for(d in tb)if(tb.hasOwnProperty(d))for(e=0,f=tb[d].length;f>e;e++)tb[d][e].fired=!1;return c||mb._wD("soundManager: Rebooting..."),mb.html5={usingFlash:null},mb.flash={},mb.html5Only=!1,mb.ignoreFlash=!1,a.setTimeout(function(){B(),c||mb.beginDelayedInit()},20),mb},this.reset=function(){return n("reset"),mb.reboot(!0,!0)},this.getMoviePercent=function(){return ob&&"PercentLoaded"in ob?ob.PercentLoaded():null},this.beginDelayedInit=function(){zb=!0,C(),setTimeout(function(){return Fb?!1:(G(),A(),Fb=!0)},20),v()},this.destruct=function(){mb._wD("soundManager.destruct()"),mb.disable(!0)},g=function(a){var c,d,e,f,g,h,i,j,k,o,q=this,r=!1,s=[],t=0,u=null;d=c=null,this.sID=this.id=a.id,this.url=a.url,this._iO=this.instanceOptions=this.options=p(a),this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,this.id3={},this._debug=function(){mb._wD(q.id+": Merged options:",q.options)},this.load=function(a){var c=null;if(a!==b?q._iO=p(a,q.options):(a=q.options,q._iO=a,u&&u!==q.url&&(n("manURL"),q._iO.url=q.url,q.url=null)),q._iO.url||(q._iO.url=q.url),q._iO.url=Y(q._iO.url),a=q.instanceOptions=q._iO,mb._wD(q.id+": load ("+a.url+")"),a.url===q.url&&0!==q.readyState&&2!==q.readyState)return n("onURL",1),3===q.readyState&&a.onload&&a.onload.apply(q,[!!q.duration]),q;if(q.loaded=!1,q.readyState=1,q.playState=0,q.id3={},$(a))c=q._setup_html5(a),c._called_load?mb._wD(q.id+": Ignoring request to load again"):(q._html5_canplay=!1,q.url!==a.url&&(mb._wD(n("manURL")+": "+a.url),q._a.src=a.url,q.setPosition(0)),q._a.autobuffer="auto",q._a.preload="auto",q._a._called_load=!0,a.autoPlay&&q.play());else try{q.isHTML5=!1,q._iO=S(R(a)),a=q._iO,8===l?ob._load(q.id,a.url,a.stream,a.autoPlay,a.usePolicyFile):ob._load(q.id,a.url,!!a.stream,!!a.autoPlay,a.loops||1,!!a.autoLoad,a.usePolicyFile)}catch(d){n("smError",2),m("onload",!1),H({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}return q.url=a.url,q},this.unload=function(){return 0!==q.readyState&&(mb._wD(q.id+": unload()"),q.isHTML5?(h(),q._a&&(q._a.pause(),bb(q._a,"about:blank"),u="about:blank")):8===l?ob._unload(q.id,"about:blank"):ob._unload(q.id),e()),q},this.destruct=function(a){mb._wD(q.id+": Destruct"),q.isHTML5?(h(),q._a&&(q._a.pause(),bb(q._a),Lb||g(),q._a._s=null,q._a=null)):(q._iO.onfailure=null,ob._destroySound(q.id)),a||mb.destroySound(q.id,!0)},this.start=this.play=function(a,c){var d,e,f=!0,f=null;if(d=q.id+": play(): ",c=c===b?!0:c,a||(a={}),q.url&&(q._iO.url=q.url),q._iO=p(q._iO,q.options),q._iO=p(a,q._iO),q._iO.url=Y(q._iO.url),q.instanceOptions=q._iO,q._iO.serverURL&&!q.connected)return q.getAutoPlay()||(mb._wD(d+" Netstream not connected yet - setting autoPlay"),q.setAutoPlay(!0)),q;if($(q._iO)&&(q._setup_html5(q._iO),i()),1===q.playState&&!q.paused&&((e=q._iO.multiShot)?mb._wD(d+"Already playing (multi-shot)",1):(mb._wD(d+"Already playing (one-shot)",1),f=q)),null!==f)return f;if(a.url&&a.url!==q.url&&q.load(q._iO),q.loaded?mb._wD(d):0===q.readyState?(mb._wD(d+"Attempting to load"),q.isHTML5||(q._iO.autoPlay=!0),q.load(q._iO),q.instanceOptions=q._iO):2===q.readyState?(mb._wD(d+"Could not load - exiting",2),f=q):mb._wD(d+"Loading - attempting to play..."),null!==f)return f;if(!q.isHTML5&&9===l&&0<q.position&&q.position===q.duration&&(mb._wD(d+"Sound at end, resetting to position:0"),a.position=0),q.paused&&0<=q.position&&(!q._iO.serverURL||0<q.position))mb._wD(d+"Resuming from paused state",1),q.resume();else{if(q._iO=p(a,q._iO),null!==q._iO.from&&null!==q._iO.to&&0===q.instanceCount&&0===q.playState&&!q._iO.serverURL){if(e=function(){q._iO=p(a,q._iO),q.play(q._iO)},q.isHTML5&&!q._html5_canplay?(mb._wD(d+"Beginning load for from/to case"),q.load({oncanplay:e}),f=!1):q.isHTML5||q.loaded||q.readyState&&2===q.readyState||(mb._wD(d+"Preloading for from/to case"),q.load({onload:e}),f=!1),null!==f)return f;q._iO=o()}mb._wD(d+"Starting to play"),(!q.instanceCount||q._iO.multiShotEvents||!q.isHTML5&&l>8&&!q.getAutoPlay())&&q.instanceCount++,q._iO.onposition&&0===q.playState&&j(q),q.playState=1,q.paused=!1,q.position=q._iO.position===b||isNaN(q._iO.position)?0:q._iO.position,q.isHTML5||(q._iO=S(R(q._iO))),q._iO.onplay&&c&&(q._iO.onplay.apply(q),r=!0),q.setVolume(q._iO.volume,!0),q.setPan(q._iO.pan,!0),q.isHTML5?(i(),d=q._setup_html5(),q.setPosition(q._iO.position),d.play()):(f=ob._start(q.id,q._iO.loops||1,9===l?q._iO.position:q._iO.position/1e3,q._iO.multiShot),9===l&&!f&&(mb._wD(d+"No sound hardware, or 32-sound ceiling hit"),q._iO.onplayerror&&q._iO.onplayerror.apply(q)))
}return q},this.stop=function(a){var b=q._iO;return 1===q.playState&&(mb._wD(q.id+": stop()"),q._onbufferchange(0),q._resetOnPosition(0),q.paused=!1,q.isHTML5||(q.playState=0),k(),b.to&&q.clearOnPosition(b.to),q.isHTML5?q._a&&(a=q.position,q.setPosition(0),q.position=a,q._a.pause(),q.playState=0,q._onTimer(),h()):(ob._stop(q.id,a),b.serverURL&&q.unload()),q.instanceCount=0,q._iO={},b.onstop&&b.onstop.apply(q)),q},this.setAutoPlay=function(a){mb._wD(q.id+": Autoplay turned "+(a?"on":"off")),q._iO.autoPlay=a,q.isHTML5||(ob._setAutoPlay(q.id,a),a&&!q.instanceCount&&1===q.readyState&&(q.instanceCount++,mb._wD(q.id+": Incremented instance count to "+q.instanceCount)))},this.getAutoPlay=function(){return q._iO.autoPlay},this.setPosition=function(a){a===b&&(a=0);var c=q.isHTML5?Math.max(a,0):Math.min(q.duration||q._iO.duration,Math.max(a,0));if(q.position=c,a=q.position/1e3,q._resetOnPosition(q.position),q._iO.position=c,q.isHTML5){if(q._a)if(q._html5_canplay){if(q._a.currentTime!==a){mb._wD(q.id+": setPosition("+a+")");try{q._a.currentTime=a,(0===q.playState||q.paused)&&q._a.pause()}catch(d){mb._wD(q.id+": setPosition("+a+") failed: "+d.message,2)}}}else mb._wD(q.id+": setPosition("+a+"): Cannot seek yet, sound not ready")}else a=9===l?q.position:a,q.readyState&&2!==q.readyState&&ob._setPosition(q.id,a,q.paused||!q.playState,q._iO.multiShot);return q.isHTML5&&q.paused&&q._onTimer(!0),q},this.pause=function(a){return q.paused||0===q.playState&&1!==q.readyState?q:(mb._wD(q.id+": pause()"),q.paused=!0,q.isHTML5?(q._setup_html5().pause(),h()):(a||a===b)&&ob._pause(q.id,q._iO.multiShot),q._iO.onpause&&q._iO.onpause.apply(q),q)},this.resume=function(){var a=q._iO;return q.paused?(mb._wD(q.id+": resume()"),q.paused=!1,q.playState=1,q.isHTML5?(q._setup_html5().play(),i()):(a.isMovieStar&&!a.serverURL&&q.setPosition(q.position),ob._pause(q.id,a.multiShot)),!r&&a.onplay?(a.onplay.apply(q),r=!0):a.onresume&&a.onresume.apply(q),q):q},this.togglePause=function(){return mb._wD(q.id+": togglePause()"),0===q.playState?(q.play({position:9!==l||q.isHTML5?q.position/1e3:q.position}),q):(q.paused?q.resume():q.pause(),q)},this.setPan=function(a,c){return a===b&&(a=0),c===b&&(c=!1),q.isHTML5||ob._setPan(q.id,a),q._iO.pan=a,c||(q.pan=a,q.options.pan=a),q},this.setVolume=function(a,c){return a===b&&(a=100),c===b&&(c=!1),q.isHTML5?q._a&&(q._a.volume=Math.max(0,Math.min(1,a/100))):ob._setVolume(q.id,mb.muted&&!q.muted||q.muted?0:a),q._iO.volume=a,c||(q.volume=a,q.options.volume=a),q},this.mute=function(){return q.muted=!0,q.isHTML5?q._a&&(q._a.muted=!0):ob._setVolume(q.id,0),q},this.unmute=function(){q.muted=!1;var a=q._iO.volume!==b;return q.isHTML5?q._a&&(q._a.muted=!1):ob._setVolume(q.id,a?q._iO.volume:q.options.volume),q},this.toggleMute=function(){return q.muted?q.unmute():q.mute()},this.onposition=this.onPosition=function(a,c,d){return s.push({position:parseInt(a,10),method:c,scope:d!==b?d:q,fired:!1}),q},this.clearOnPosition=function(a,b){var c,a=parseInt(a,10);if(isNaN(a))return!1;for(c=0;c<s.length;c++)a!==s[c].position||b&&b!==s[c].method||(s[c].fired&&t--,s.splice(c,1))},this._processOnPosition=function(){var a,b;if(a=s.length,!a||!q.playState||t>=a)return!1;for(a-=1;a>=0;a--)b=s[a],!b.fired&&q.position>=b.position&&(b.fired=!0,t++,b.method.apply(b.scope,[b.position]));return!0},this._resetOnPosition=function(a){var b,c;if(b=s.length,!b)return!1;for(b-=1;b>=0;b--)c=s[b],c.fired&&a<=c.position&&(c.fired=!1,t--);return!0},o=function(){var a,b,c=q._iO,d=c.from,e=c.to;return b=function(){mb._wD(q.id+': "To" time of '+e+" reached."),q.clearOnPosition(e,b),q.stop()},a=function(){mb._wD(q.id+': Playing "from" '+d),null===e||isNaN(e)||q.onPosition(e,b)},null!==d&&!isNaN(d)&&(c.position=d,c.multiShot=!1,a()),c},j=function(){var a,b=q._iO.onposition;if(b)for(a in b)b.hasOwnProperty(a)&&q.onPosition(parseInt(a,10),b[a])},k=function(){var a,b=q._iO.onposition;if(b)for(a in b)b.hasOwnProperty(a)&&q.clearOnPosition(parseInt(a,10))},i=function(){q.isHTML5&&V(q)},h=function(){q.isHTML5&&W(q)},e=function(a){a||(s=[],t=0),r=!1,q._hasTimer=null,q._a=null,q._html5_canplay=!1,q.bytesLoaded=null,q.bytesTotal=null,q.duration=q._iO&&q._iO.duration?q._iO.duration:null,q.durationEstimate=null,q.buffered=[],q.eqData=[],q.eqData.left=[],q.eqData.right=[],q.failures=0,q.isBuffering=!1,q.instanceOptions={},q.instanceCount=0,q.loaded=!1,q.metadata={},q.readyState=0,q.muted=!1,q.paused=!1,q.peakData={left:0,right:0},q.waveformData={left:[],right:[]},q.playState=0,q.position=null,q.id3={}},e(),this._onTimer=function(a){var b,e=!1,f={};return q._hasTimer||a?(q._a&&(a||(0<q.playState||1===q.readyState)&&!q.paused)&&(b=q._get_html5_duration(),b!==c&&(c=b,q.duration=b,e=!0),q.durationEstimate=q.duration,b=1e3*q._a.currentTime||0,b!==d&&(d=b,e=!0),(e||a)&&q._whileplaying(b,f,f,f,f)),e):void 0},this._get_html5_duration=function(){var a=q._iO;return(a=q._a&&q._a.duration?1e3*q._a.duration:a&&a.duration?a.duration:null)&&!isNaN(a)&&1/0!==a?a:null},this._apply_loop=function(a,b){!a.loop&&b>1&&mb._wD("Note: Native HTML5 looping is infinite.",1),a.loop=b>1?"loop":""},this._setup_html5=function(a){var b,a=p(q._iO,a),c=decodeURI,d=Lb?nb:q._a,g=c(a.url);if(Lb?g===fb&&(b=!0):g===u&&(b=!0),d){if(d._s)if(Lb)d._s&&d._s.playState&&!b&&d._s.stop();else if(!Lb&&g===c(u))return q._apply_loop(d,a.loops),d;b||(e(!1),d.src=a.url,fb=u=q.url=a.url,d._called_load=!1)}else q._a=a.autoLoad||a.autoPlay?new Audio(a.url):Rb&&10>opera.version()?new Audio(null):new Audio,d=q._a,d._called_load=!1,Lb&&(nb=d);return q.isHTML5=!0,q._a=d,d._s=q,f(),q._apply_loop(d,a.loops),a.autoLoad||a.autoPlay?q.load():(d.autobuffer=!1,d.preload="auto"),d},f=function(){if(q._a._added_events)return!1;var a;q._a._added_events=!0;for(a in jb)jb.hasOwnProperty(a)&&q._a&&q._a.addEventListener(a,jb[a],!1);return!0},g=function(){var a;mb._wD(q.id+": Removing event listeners"),q._a._added_events=!1;for(a in jb)jb.hasOwnProperty(a)&&q._a&&q._a.removeEventListener(a,jb[a],!1)},this._onload=function(a){var b=!!a||!q.isHTML5&&8===l&&q.duration,a=q.id+": ";return mb._wD(a+(b?"onload()":"Failed to load? - "+q.url),b?1:2),!b&&!q.isHTML5&&(!0===mb.sandbox.noRemote&&mb._wD(a+N("noNet"),1),!0===mb.sandbox.noLocal&&mb._wD(a+N("noLocal"),1)),q.loaded=b,q.readyState=b?3:2,q._onbufferchange(0),q._iO.onload&&q._iO.onload.apply(q,[b]),!0},this._onbufferchange=function(a){return 0===q.playState||a&&q.isBuffering||!a&&!q.isBuffering?!1:(q.isBuffering=1===a,q._iO.onbufferchange&&(mb._wD(q.id+": Buffer state change: "+a),q._iO.onbufferchange.apply(q)),!0)},this._onsuspend=function(){return q._iO.onsuspend&&(mb._wD(q.id+": Playback suspended"),q._iO.onsuspend.apply(q)),!0},this._onfailure=function(a,b,c){q.failures++,mb._wD(q.id+": Failures = "+q.failures),q._iO.onfailure&&1===q.failures?q._iO.onfailure(q,a,b,c):mb._wD(q.id+": Ignoring failure")},this._onfinish=function(){var a=q._iO.onfinish;q._onbufferchange(0),q._resetOnPosition(0),q.instanceCount&&(q.instanceCount--,q.instanceCount||(k(),q.playState=0,q.paused=!1,q.instanceCount=0,q.instanceOptions={},q._iO={},h(),q.isHTML5&&(q.position=0)),(!q.instanceCount||q._iO.multiShotEvents)&&a)&&(mb._wD(q.id+": onfinish()"),a.apply(q))},this._whileloading=function(a,b,c,d){var e=q._iO;q.bytesLoaded=a,q.bytesTotal=b,q.duration=Math.floor(c),q.bufferLength=d,q.durationEstimate=q.isHTML5||e.isMovieStar?q.duration:e.duration?q.duration>e.duration?q.duration:e.duration:parseInt(q.bytesTotal/q.bytesLoaded*q.duration,10),q.isHTML5||(q.buffered=[{start:0,end:q.duration}]),(3!==q.readyState||q.isHTML5)&&e.whileloading&&e.whileloading.apply(q)},this._whileplaying=function(a,c,d,e,f){var g=q._iO;return isNaN(a)||null===a?!1:(q.position=Math.max(0,a),q._processOnPosition(),!q.isHTML5&&l>8&&(g.usePeakData&&c!==b&&c&&(q.peakData={left:c.leftPeak,right:c.rightPeak}),g.useWaveformData&&d!==b&&d&&(q.waveformData={left:d.split(","),right:e.split(",")}),g.useEQData&&f!==b&&f&&f.leftEQ&&(a=f.leftEQ.split(","),q.eqData=a,q.eqData.left=a,f.rightEQ!==b&&f.rightEQ&&(q.eqData.right=f.rightEQ.split(",")))),1===q.playState&&(!q.isHTML5&&8===l&&!q.position&&q.isBuffering&&q._onbufferchange(0),g.whileplaying&&g.whileplaying.apply(q)),!0)},this._oncaptiondata=function(a){mb._wD(q.id+": Caption data received."),q.captiondata=a,q._iO.oncaptiondata&&q._iO.oncaptiondata.apply(q,[a])},this._onmetadata=function(a,b){mb._wD(q.id+": Metadata received.");var c,d,e={};for(c=0,d=a.length;d>c;c++)e[a[c]]=b[c];q.metadata=e,q._iO.onmetadata&&q._iO.onmetadata.apply(q)},this._onid3=function(a,b){mb._wD(q.id+": ID3 data received.");var c,d,e=[];for(c=0,d=a.length;d>c;c++)e[a[c]]=b[c];q.id3=p(q.id3,e),q._iO.onid3&&q._iO.onid3.apply(q)},this._onconnect=function(a){a=1===a,mb._wD(q.id+": "+(a?"Connected.":"Failed to connect? - "+q.url),a?1:2),(q.connected=a)&&(q.failures=0,U(q.id)&&(q.getAutoPlay()?q.play(b,q.getAutoPlay()):q._iO.autoLoad&&q.load()),q._iO.onconnect&&q._iO.onconnect.apply(q,[a]))},this._ondataerror=function(a){0<q.playState&&(mb._wD(q.id+": Data error: "+a),q._iO.ondataerror&&q._iO.ondataerror.apply(q))},this._debug()},F=function(){return sb.body||sb._docElement||sb.getElementsByTagName("div")[0]},h=function(a){return sb.getElementById(a)},p=function(a,c){var d,e,f=a||{};d=c===b?mb.defaultOptions:c;for(e in d)d.hasOwnProperty(e)&&f[e]===b&&(f[e]="object"!=typeof d[e]||null===d[e]?d[e]:p(f[e],d[e]));return f},r={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},q=function(a,c){var d,e=!0,f=c!==b,g=mb.setupOptions;if(a===b){e=[];for(d in g)g.hasOwnProperty(d)&&e.push(d);for(d in r)r.hasOwnProperty(d)&&e.push("object"==typeof mb[d]?d+": {...}":mb[d]instanceof Function?d+": function() {...}":d);return mb._wD(N("setup",e.join(", "))),!1}for(d in a)if(a.hasOwnProperty(d))if("object"!=typeof a[d]||null===a[d]||a[d]instanceof Array||a[d]instanceof RegExp)f&&r[c]!==b?mb[c][d]=a[d]:g[d]!==b?(mb.setupOptions[d]=a[d],mb[d]=a[d]):r[d]===b?(T(N(mb[d]===b?"setupUndef":"setupError",d),2),e=!1):mb[d]instanceof Function?mb[d].apply(mb,a[d]instanceof Array?a[d]:[a[d]]):mb[d]=a[d];else{if(r[d]!==b)return q(a[d],d);T(N(mb[d]===b?"setupUndef":"setupError",d),2),e=!1}return e};var ec=function(a){var a=Kb.call(a),b=a.length;return gc?(a[1]="on"+a[1],b>3&&a.pop()):3===b&&a.push(!1),a},fc=function(a,b){var c=a.shift(),d=[hc[b]];gc?c[d](a[0],a[1]):c[d].apply(c,a)},gc=a.attachEvent,hc={add:gc?"attachEvent":"addEventListener",remove:gc?"detachEvent":"removeEventListener"};eb={add:function(){fc(ec(arguments),"add")},remove:function(){fc(ec(arguments),"remove")}},jb={abort:f(function(){mb._wD(this._s.id+": abort")}),canplay:f(function(){var a,c=this._s;if(c._html5_canplay)return!0;if(c._html5_canplay=!0,mb._wD(c.id+": canplay"),c._onbufferchange(0),a=c._iO.position===b||isNaN(c._iO.position)?null:c._iO.position/1e3,c.position&&this.currentTime!==a){mb._wD(c.id+": canplay: Setting position to "+a);try{this.currentTime=a}catch(d){mb._wD(c.id+": canplay: Setting position of "+a+" failed: "+d.message,2)}}c._iO._oncanplay&&c._iO._oncanplay()}),canplaythrough:f(function(){var a=this._s;a.loaded||(a._onbufferchange(0),a._whileloading(a.bytesLoaded,a.bytesTotal,a._get_html5_duration()),a._onload(!0))}),ended:f(function(){var a=this._s;mb._wD(a.id+": ended"),a._onfinish()}),error:f(function(){mb._wD(this._s.id+": HTML5 error, code "+this.error.code),this._s._onload(!1)}),loadeddata:f(function(){var a=this._s;mb._wD(a.id+": loadeddata"),!a._loaded&&!Qb&&(a.duration=a._get_html5_duration())}),loadedmetadata:f(function(){mb._wD(this._s.id+": loadedmetadata")}),loadstart:f(function(){mb._wD(this._s.id+": loadstart"),this._s._onbufferchange(1)}),play:f(function(){mb._wD(this._s.id+": play()"),this._s._onbufferchange(0)}),playing:f(function(){mb._wD(this._s.id+": playing"),this._s._onbufferchange(0)}),progress:f(function(a){var b,c,d,e=this._s;b=0;var f="progress"===a.type,g=a.target.buffered,h=a.loaded||0,i=a.total||1;if(e.buffered=[],g&&g.length){for(b=0,c=g.length;c>b;b++)e.buffered.push({start:1e3*g.start(b),end:1e3*g.end(b)});if(b=1e3*(g.end(0)-g.start(0)),h=b/(1e3*a.target.duration),f&&1<g.length){for(d=[],c=g.length,b=0;c>b;b++)d.push(1e3*a.target.buffered.start(b)+"-"+1e3*a.target.buffered.end(b));mb._wD(this._s.id+": progress, timeRanges: "+d.join(", "))}f&&!isNaN(h)&&mb._wD(this._s.id+": progress, "+Math.floor(100*h)+"% loaded")}isNaN(h)||(e._onbufferchange(0),e._whileloading(h,i,e._get_html5_duration()),h&&i&&h===i&&jb.canplaythrough.call(this,a))}),ratechange:f(function(){mb._wD(this._s.id+": ratechange")}),suspend:f(function(a){var b=this._s;mb._wD(this._s.id+": suspend"),jb.progress.call(this,a),b._onsuspend()}),stalled:f(function(){mb._wD(this._s.id+": stalled")}),timeupdate:f(function(){this._s._onTimer()}),waiting:f(function(){var a=this._s;mb._wD(this._s.id+": waiting"),a._onbufferchange(1)})},$=function(a){return a.serverURL||a.type&&e(a.type)?!1:a.type?_({type:a.type}):_({url:a.url})||mb.html5Only},bb=function(a,b){a&&(a.src=b,a._called_load=!1),Lb&&(fb=null)},_=function(a){if(!mb.useHTML5Audio||!mb.hasHTML5)return!1;var c,d=a.url||null,a=a.type||null,f=mb.audioFormats;if(a&&mb.html5[a]!==b)return mb.html5[a]&&!e(a);if(!ab){ab=[];for(c in f)f.hasOwnProperty(c)&&(ab.push(c),f[c].related&&(ab=ab.concat(f[c].related)));ab=RegExp("\\.("+ab.join("|")+")(\\?.*)?$","i")}return c=d?d.toLowerCase().match(ab):null,c&&c.length?c=c[1]:a&&(d=a.indexOf(";"),c=(-1!==d?a.substr(0,d):a).substr(6)),c&&mb.html5[c]!==b?d=mb.html5[c]&&!e(c):(a="audio/"+c,d=mb.html5.canPlayType({type:a}),d=(mb.html5[c]=d)&&mb.html5[a]&&!e(a)),d},db=function(){function a(a){var b,c,d=b=!1;if(!f||"function"!=typeof f.canPlayType)return b;if(a instanceof Array){for(b=0,c=a.length;c>b;b++)(mb.html5[a[b]]||f.canPlayType(a[b]).match(mb.html5Test))&&(d=!0,mb.html5[a[b]]=!0,mb.flash[a[b]]=!!a[b].match(Yb));b=d}else a=f&&"function"==typeof f.canPlayType?f.canPlayType(a):!1,b=!(!a||!a.match(mb.html5Test));return b}if(!mb.useHTML5Audio||!mb.hasHTML5)return!1;var c,d,e,f=Audio!==b?Rb&&10>opera.version()?new Audio(null):new Audio:null,g={};e=mb.audioFormats;for(c in e)if(e.hasOwnProperty(c)&&(d="audio/"+c,g[c]=a(e[c].type),g[d]=g[c],c.match(Yb)?(mb.flash[c]=!0,mb.flash[d]=!0):(mb.flash[c]=!1,mb.flash[d]=!1),e[c]&&e[c].related))for(d=e[c].related.length-1;d>=0;d--)g["audio/"+e[c].related[d]]=g[c],mb.html5[e[c].related[d]]=g[c],mb.flash[e[c].related[d]]=g[c];return g.canPlayType=f?a:null,mb.html5=p(mb.html5,g),!0},z={notReady:"Unavailable - wait until onready() has fired.",notOK:"Audio support is not available.",domError:"soundManagerexception caught while appending SWF to DOM.",spcWmode:"Removing wmode, preventing known SWF loading issue(s)",swf404:"soundManager: Verify that %s is a valid path.",tryDebug:"Try soundManager.debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:"soundManager: Non-HTTP page ("+sb.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:"soundManager: Special case: Waiting for SWF to load with window focus...",waitForever:"soundManager: Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:"soundManager: Waiting for 100% SWF load...",needFunction:"soundManager: Function object expected for %s",badID:'Warning: Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:"soundManager: _debug(): Current sound objects",waitOnload:"soundManager: Waiting for window.onload()",docLoaded:"soundManager: Document already loaded",onload:"soundManager: initComplete(): calling soundManager.onload()",onloadOK:"soundManager.onload() complete",didInit:"soundManager: init(): Already called?",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:"soundManager: Failed to remove Flash node.",shutdown:"soundManager.disable(): Shutting down",queue:"soundManager: Queueing %s handler",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying .swf_timedout CSS...",fbLoaded:"Flash loaded",flRemoved:"soundManager: Flash movie removed.",fbHandler:"soundManager: flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:"soundManager.load(): current URL already assigned.",badFV:'soundManager.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",needFlash:"soundManager: Fatal error: Flash is needed to play some required formats, but is not available.",gotFocus:"soundManager: Got window focus.",policy:"Enabling usePolicyFile for data access",setup:"soundManager.setup(): allowed parameters: %s",setupError:'soundManager.setup(): "%s" cannot be assigned with this method.',setupUndef:'soundManager.setup(): Could not find option "%s"',setupLate:"soundManager.setup(): url, flashVersion and html5Test property changes will not take effect until reboot().",noURL:"soundManager: Flash URL required. Call soundManager.setup({url:...}) to get started.",sm2Loaded:"SoundManager 2: Ready.",reset:"soundManager.reset(): Removing event callbacks",mobileUA:"Mobile UA detected, preferring HTML5 by default.",globalHTML5:"Using singleton HTML5 Audio() pattern for this device."},N=function(){var a,b,c=Kb.call(arguments),d=c.shift(),d=z&&z[d]?z[d]:"";if(d&&c&&c.length)for(a=0,b=c.length;b>a;a++)d=d.replace("%s",c[a]);return d},R=function(a){return 8===l&&1<a.loops&&a.stream&&(n("as2loop"),a.stream=!1),a},S=function(a,b){return a&&!a.usePolicyFile&&(a.onid3||a.usePeakData||a.useWaveformData||a.useEQData)&&(mb._wD((b||"")+N("policy")),a.usePolicyFile=!0),a},T=function(a){console!==b&&console.warn!==b?console.warn(a):mb._wD(a)},i=function(){return!1},K=function(a){for(var b in a)a.hasOwnProperty(b)&&"function"==typeof a[b]&&(a[b]=i)},L=function(a){a===b&&(a=!1),(yb||a)&&mb.disable(a)},M=function(a){var b=null;if(a)if(a.match(/\.swf(\?.*)?$/i)){if(b=a.substr(a.toLowerCase().lastIndexOf(".swf?")+4))return a}else a.lastIndexOf("/")!==a.length-1&&(a+="/");return a=(a&&-1!==a.lastIndexOf("/")?a.substr(0,a.lastIndexOf("/")+1):"./")+mb.movieURL,mb.noSWFCache&&(a+="?ts="+(new Date).getTime()),a},x=function(){l=parseInt(mb.flashVersion,10),8!==l&&9!==l&&(mb._wD(N("badFV",l,8)),mb.flashVersion=l=8);var a=mb.debugMode||mb.debugFlash?"_debug.swf":".swf";mb.useHTML5Audio&&!mb.html5Only&&mb.audioFormats.mp4.required&&9>l&&(mb._wD(N("needfl9")),mb.flashVersion=l=9),mb.version=mb.versionNumber+(mb.html5Only?" (HTML5-only mode)":9===l?" (AS3/Flash 9)":" (AS2/Flash 8)"),l>8?(mb.defaultOptions=p(mb.defaultOptions,mb.flash9Options),mb.features.buffering=!0,mb.defaultOptions=p(mb.defaultOptions,mb.movieStarOptions),mb.filePatterns.flash9=RegExp("\\.(mp3|"+ac.join("|")+")(\\?.*)?$","i"),mb.features.movieStar=!0):mb.features.movieStar=!1,mb.filePattern=mb.filePatterns[8!==l?"flash9":"flash8"],mb.movieURL=(8===l?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",a),mb.features.peakData=mb.features.waveformData=mb.features.eqData=l>8},I=function(a,b){return ob?void ob._setPolling(a,b):!1},J=function(){if(mb.debugURLParam.test(rb)&&(mb.debugMode=!0),h(mb.debugID))return!1;var a,b,c,d;if(!(!mb.debugMode||h(mb.debugID)||Ub&&mb.useConsole&&mb.consoleOnly)){a=sb.createElement("div"),a.id=mb.debugID+"-toggle",b={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001},a.appendChild(sb.createTextNode("-")),a.onclick=Q,a.title="Toggle SM2 debug console",qb.match(/msie 6/i)&&(a.style.position="absolute",a.style.cursor="hand");for(d in b)b.hasOwnProperty(d)&&(a.style[d]=b[d]);if(b=sb.createElement("div"),b.id=mb.debugID,b.style.display=mb.debugMode?"block":"none",mb.debugMode&&!h(a.id)){try{c=F(),c.appendChild(a)}catch(e){throw Error(N("domError")+" \n"+e.toString())}c.appendChild(b)}}},U=this.getSoundById,n=function(a,b){return a?mb._wD(N(a),b):""},Q=function(){var a=h(mb.debugID),b=h(mb.debugID+"-toggle");return a?(ub?(b.innerHTML="+",a.style.display="none"):(b.innerHTML="-",a.style.display="block"),void(ub=!ub)):!1},m=function(c,d,e){if(a.sm2Debugger!==b)try{sm2Debugger.handleEvent(c,d,e)}catch(f){}return!0},P=function(){var a=[];return mb.debugMode&&a.push("sm2_debug"),mb.debugFlash&&a.push("flash_debug"),mb.useHighPerformance&&a.push("high_performance"),a.join(" ")},O=function(){var a=N("fbHandler"),b=mb.getMoviePercent(),c={type:"FLASHBLOCK"};return mb.html5Only?!1:void(mb.ok()?(mb.didFlashBlock&&mb._wD(a+": Unblocked"),mb.oMC&&(mb.oMC.className=[P(),"movieContainer","swf_loaded"+(mb.didFlashBlock?" swf_unblocked":"")].join(" "))):(Jb&&(mb.oMC.className=P()+" movieContainer "+(null===b?"swf_timedout":"swf_error"),mb._wD(a+": "+N("fbTimeout")+(b?" ("+N("fbLoaded")+")":""))),mb.didFlashBlock=!0,t({type:"ontimeout",ignoreInit:!0,error:c}),H(c)))},s=function(a,c,d){tb[a]===b&&(tb[a]=[]),tb[a].push({method:c,scope:d||null,fired:!1})},t=function(a){if(a||(a={type:mb.ok()?"onready":"ontimeout"}),!xb&&a&&!a.ignoreInit||"ontimeout"===a.type&&(mb.ok()||yb&&!a.ignoreInit))return!1;var b,c={success:a&&a.ignoreInit?mb.ok():!yb},d=a&&a.type?tb[a.type]||[]:[],e=[],c=[c],f=Jb&&!mb.ok();for(a.error&&(c[0].error=a.error),a=0,b=d.length;b>a;a++)!0!==d[a].fired&&e.push(d[a]);if(e.length)for(a=0,b=e.length;b>a;a++)e[a].scope?e[a].method.apply(e[a].scope,c):e[a].method.apply(this,c),f||(e[a].fired=!0);return!0},u=function(){a.setTimeout(function(){mb.useFlashBlock&&O(),t(),"function"==typeof mb.onload&&(n("onload",1),mb.onload.apply(a),n("onloadOK",1)),mb.waitForWindowLoad&&eb.add(a,"load",u)},1)},hb=function(){if(gb!==b)return gb;var c,d=!1,e=navigator,f=e.plugins,g=a.ActiveXObject;if(f&&f.length)(e=e.mimeTypes)&&e["application/x-shockwave-flash"]&&e["application/x-shockwave-flash"].enabledPlugin&&e["application/x-shockwave-flash"].enabledPlugin.description&&(d=!0);else if(g!==b&&!qb.match(/MSAppHost/i)){try{c=new g("ShockwaveFlash.ShockwaveFlash")}catch(h){}d=!!c}return gb=d},Z=function(){var a,b,c=mb.audioFormats;if(Mb&&qb.match(/os (1|2|3_0|3_1)/i)?(mb.hasHTML5=!1,mb.html5Only=!0,mb.oMC&&(mb.oMC.style.display="none")):mb.useHTML5Audio&&(mb.html5&&mb.html5.canPlayType||(mb._wD("SoundManager: No HTML5 Audio() support detected."),mb.hasHTML5=!1),Tb&&mb._wD("soundManager: Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+(gb?"will use flash fallback for MP3/MP4, if available":" would use flash fallback for MP3/MP4, but none detected."),1)),mb.useHTML5Audio&&mb.hasHTML5)for(b in c)c.hasOwnProperty(b)&&(c[b].required&&!mb.html5.canPlayType(c[b].type)||mb.preferFlash&&(mb.flash[b]||mb.flash[c[b].type]))&&(a=!0);return mb.ignoreFlash&&(a=!1),mb.html5Only=mb.hasHTML5&&mb.useHTML5Audio&&!a,!mb.html5Only},Y=function(a){var b,c,d=0;if(a instanceof Array){for(b=0,c=a.length;c>b;b++)if(a[b]instanceof Object){if(mb.canPlayMIME(a[b].type)){d=b;break}}else if(mb.canPlayURL(a[b])){d=b;break}a[d].url&&(a[d]=a[d].url),a=a[d]}return a},V=function(b){b._hasTimer||(b._hasTimer=!0,!Sb&&mb.html5PollingInterval&&(null===Hb&&0===Gb&&(Hb=a.setInterval(X,mb.html5PollingInterval)),Gb++))},W=function(a){a._hasTimer&&(a._hasTimer=!1,!Sb&&mb.html5PollingInterval&&Gb--)},X=function(){var b;if(null!==Hb&&!Gb)return a.clearInterval(Hb),Hb=null,!1;for(b=mb.soundIDs.length-1;b>=0;b--)mb.sounds[mb.soundIDs[b]].isHTML5&&mb.sounds[mb.soundIDs[b]]._hasTimer&&mb.sounds[mb.soundIDs[b]]._onTimer()},H=function(c){c=c!==b?c:{},"function"==typeof mb.onerror&&mb.onerror.apply(a,[{type:c.type!==b?c.type:null}]),c.fatal!==b&&c.fatal&&mb.disable()},ib=function(){if(!Tb||!hb())return!1;var a,b,c=mb.audioFormats;for(b in c)if(c.hasOwnProperty(b)&&("mp3"===b||"mp4"===b)&&(mb._wD("soundManager: Using flash fallback for "+b+" format"),mb.html5[b]=!1,c[b]&&c[b].related))for(a=c[b].related.length-1;a>=0;a--)mb.html5[c[b].related[a]]=!1},this._setSandboxType=function(a){var c=mb.sandbox;c.type=a,c.description=c.types[c.types[a]!==b?a:"unknown"],"localWithFile"===c.type?(c.noRemote=!0,c.noLocal=!1,n("secNote",2)):"localWithNetwork"===c.type?(c.noRemote=!1,c.noLocal=!0):"localTrusted"===c.type&&(c.noRemote=!1,c.noLocal=!1)},this._externalInterfaceOK=function(a,b){if(mb.swfLoaded)return!1;var c;return m("swf",!0),m("flashtojs",!0),mb.swfLoaded=!0,Wb=!1,Tb&&ib(),b&&b.replace(/\+dev/i,"")===mb.versionNumber.replace(/\+dev/i,"")?void setTimeout(k,Ob?100:1):(c='soundManager: Fatal: JavaScript file build "'+mb.versionNumber+'" does not match Flash SWF build "'+b+'" at '+mb.url+". Ensure both are up-to-date.",setTimeout(function(){throw Error(c)},0),!1)},G=function(a,c){function d(){var a,b=[],c=[];a="SoundManager "+mb.version+(!mb.html5Only&&mb.useHTML5Audio?mb.hasHTML5?" + HTML5 audio":", no HTML5 audio support":""),mb.html5Only?mb.html5PollingInterval&&b.push("html5PollingInterval ("+mb.html5PollingInterval+"ms)"):(mb.preferFlash&&b.push("preferFlash"),mb.useHighPerformance&&b.push("useHighPerformance"),mb.flashPollingInterval&&b.push("flashPollingInterval ("+mb.flashPollingInterval+"ms)"),mb.html5PollingInterval&&b.push("html5PollingInterval ("+mb.html5PollingInterval+"ms)"),mb.wmode&&b.push("wmode ("+mb.wmode+")"),mb.debugFlash&&b.push("debugFlash"),mb.useFlashBlock&&b.push("flashBlock")),b.length&&(c=c.concat([b.join(" + ")])),mb._wD(a+(c.length?" + "+c.join(", "):""),1),kb()}function e(a,b){return'<param name="'+a+'" value="'+b+'" />'}if(vb&&wb)return!1;if(mb.html5Only)return x(),d(),mb.oMC=h(mb.movieID),k(),wb=vb=!0,!1;var f,g,i,j=c||mb.url,l=mb.altURL||j,m=F(),n=P(),o=null,o=sb.getElementsByTagName("html")[0],o=o&&o.dir&&o.dir.match(/rtl/i),a=a===b?mb.id:a;if(x(),mb.url=M(Zb?j:l),c=mb.url,mb.wmode=!mb.wmode&&mb.useHighPerformance?"transparent":mb.wmode,null!==mb.wmode&&(qb.match(/msie 8/i)||!Ob&&!mb.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(Ib.push(z.spcWmode),mb.wmode=null),m={name:a,id:a,src:c,quality:"high",allowScriptAccess:mb.allowScriptAccess,bgcolor:mb.bgColor,pluginspage:$b+"www.macromedia.com/go/getflashplayer",title:"JS/Flash audio component (SoundManager 2)",type:"application/x-shockwave-flash",wmode:mb.wmode,hasPriority:"true"},mb.debugFlash&&(m.FlashVars="debug=1"),mb.wmode||delete m.wmode,Ob)j=sb.createElement("div"),g=['<object id="'+a+'" data="'+c+'" type="'+m.type+'" title="'+m.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+$b+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',e("movie",c),e("AllowScriptAccess",mb.allowScriptAccess),e("quality",m.quality),mb.wmode?e("wmode",mb.wmode):"",e("bgcolor",mb.bgColor),e("hasPriority","true"),mb.debugFlash?e("FlashVars",m.FlashVars):"","</object>"].join("");else for(f in j=sb.createElement("embed"),m)m.hasOwnProperty(f)&&j.setAttribute(f,m[f]);if(J(),n=P(),m=F())if(mb.oMC=h(mb.movieID)||sb.createElement("div"),mb.oMC.id)i=mb.oMC.className,mb.oMC.className=(i?i+" ":"movieContainer")+(n?" "+n:""),mb.oMC.appendChild(j),Ob&&(f=mb.oMC.appendChild(sb.createElement("div")),f.className="sm2-object-box",f.innerHTML=g),wb=!0;else{if(mb.oMC.id=mb.movieID,mb.oMC.className="movieContainer "+n,f=n=null,mb.useFlashBlock||(mb.useHighPerformance?n={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(n={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},o&&(n.left=Math.abs(parseInt(n.left,10))+"px"))),Pb&&(mb.oMC.style.zIndex=1e4),!mb.debugFlash)for(i in n)n.hasOwnProperty(i)&&(mb.oMC.style[i]=n[i]);try{Ob||mb.oMC.appendChild(j),m.appendChild(mb.oMC),Ob&&(f=mb.oMC.appendChild(sb.createElement("div")),f.className="sm2-object-box",f.innerHTML=g),wb=!0}catch(p){throw Error(N("domError")+" \n"+p.toString())}}return vb=!0,d(),!0},A=function(){return mb.html5Only?(G(),!1):ob?!1:mb.url?(ob=mb.getMovie(mb.id),ob||(Cb?(Ob?mb.oMC.innerHTML=Db:mb.oMC.appendChild(Cb),Cb=null,vb=!0):G(mb.id,mb.url),ob=mb.getMovie(mb.id)),"function"==typeof mb.oninitmovie&&setTimeout(mb.oninitmovie,1),lb(),!0):(n("noURL"),!1)},v=function(){setTimeout(w,1e3)},w=function(){var b,c=!1;return!mb.url||Eb?!1:(Eb=!0,eb.remove(a,"load",v),Wb&&!Vb?(n("waitFocus"),!1):(xb||(b=mb.getMoviePercent(),b>0&&100>b&&(c=!0)),void setTimeout(function(){return b=mb.getMoviePercent(),c?(Eb=!1,mb._wD(N("waitSWF")),a.setTimeout(v,1),!1):(xb||(mb._wD("soundManager: No Flash response within expected time. Likely causes: "+(0===b?"SWF load failed, ":"")+"Flash blocked or JS-Flash security error."+(mb.debugFlash?" "+N("checkSWF"):""),2),!Zb&&b&&(n("localFail",2),mb.debugFlash||n("tryDebug",2)),0===b&&mb._wD(N("swf404",mb.url),1),m("flashtojs",!1," (Check flash security or flash blockers)")),void(!xb&&Xb&&(null===b?mb.useFlashBlock||0===mb.flashLoadTimeout?(mb.useFlashBlock&&O(),n("waitForever")):(n("waitForever"),t({type:"ontimeout",ignoreInit:!0})):0===mb.flashLoadTimeout?n("waitForever"):L(!0))))},mb.flashLoadTimeout)))},y=function(){return Vb||!Wb?(eb.remove(a,"focus",y),!0):(Vb=Xb=!0,n("gotFocus"),Eb=!1,v(),eb.remove(a,"focus",y),!0)},lb=function(){Ib.length&&(mb._wD("SoundManager 2: "+Ib.join(" "),1),Ib=[])},kb=function(){lb();var a,b=[];if(mb.useHTML5Audio&&mb.hasHTML5){for(a in mb.audioFormats)mb.audioFormats.hasOwnProperty(a)&&b.push(a+" = "+mb.html5[a]+(!mb.html5[a]&&gb&&mb.flash[a]?" (using flash)":mb.preferFlash&&mb.flash[a]&&gb?" (preferring flash)":mb.html5[a]?"":" ("+(mb.audioFormats[a].required?"required, ":"")+"and no flash support)"));mb._wD("SoundManager 2 HTML5 support: "+b.join(", "),1)}},o=function(b){if(xb)return!1;if(mb.html5Only)return n("sm2Loaded"),xb=!0,u(),m("onload",!0),!0;var c,d=!0;return mb.useFlashBlock&&mb.flashLoadTimeout&&!mb.getMoviePercent()||(xb=!0,yb&&(c={type:!gb&&Jb?"NO_FLASH":"INIT_TIMEOUT"})),mb._wD("SoundManager 2 "+(yb?"failed to load":"loaded")+" ("+(yb?"Flash security/load error":"OK")+")",yb?2:1),yb||b?(mb.useFlashBlock&&mb.oMC&&(mb.oMC.className=P()+" "+(null===mb.getMoviePercent()?"swf_timedout":"swf_error")),t({type:"ontimeout",error:c,ignoreInit:!0}),m("onload",!1),H(c),d=!1):m("onload",!0),yb||(mb.waitForWindowLoad&&!zb?(n("waitOnload"),eb.add(a,"load",u)):(mb.waitForWindowLoad&&zb&&n("docLoaded"),u())),d},j=function(){var a,c=mb.setupOptions;for(a in c)c.hasOwnProperty(a)&&(mb[a]===b?mb[a]=c[a]:mb[a]!==c[a]&&(mb.setupOptions[a]=mb[a]))},k=function(){if(xb)return n("didInit"),!1;if(mb.html5Only)return xb||(eb.remove(a,"load",mb.beginDelayedInit),mb.enabled=!0,o()),!0;A();try{ob._externalInterfaceTest(!1),I(!0,mb.flashPollingInterval||(mb.useHighPerformance?10:50)),mb.debugMode||ob._disableDebug(),mb.enabled=!0,m("jstoflash",!0),mb.html5Only||eb.add(a,"unload",i)}catch(b){return mb._wD("js/flash exception: "+b.toString()),m("jstoflash",!1),H({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),L(!0),o(),!1}return o(),eb.remove(a,"load",mb.beginDelayedInit),!0},C=function(){if(E)return!1;E=!0,j(),J();var c=null,c=null,d=a.console!==b&&"function"==typeof console.log,e=rb.toLowerCase();return-1!==e.indexOf("sm2-usehtml5audio=")&&(c="1"===e.charAt(e.indexOf("sm2-usehtml5audio=")+18),d&&console.log((c?"Enabling ":"Disabling ")+"useHTML5Audio via URL parameter"),mb.setup({useHTML5Audio:c})),-1!==e.indexOf("sm2-preferflash=")&&(c="1"===e.charAt(e.indexOf("sm2-preferflash=")+16),d&&console.log((c?"Enabling ":"Disabling ")+"preferFlash via URL parameter"),mb.setup({preferFlash:c})),!gb&&mb.hasHTML5&&(mb._wD("SoundManager: No Flash detected"+(mb.useHTML5Audio?". Trying HTML5-only mode.":", enabling HTML5."),1),mb.setup({useHTML5Audio:!0,preferFlash:!1})),db(),mb.html5.usingFlash=Z(),Jb=mb.html5.usingFlash,!gb&&Jb&&(Ib.push(z.needFlash),mb.setup({flashLoadTimeout:1})),sb.removeEventListener&&sb.removeEventListener("DOMContentLoaded",C,!1),A(),!0
},cb=function(){return"complete"===sb.readyState&&(C(),sb.detachEvent("onreadystatechange",cb)),!0},D=function(){zb=!0,eb.remove(a,"load",D)},B=function(){Sb&&((!mb.setupOptions.useHTML5Audio||mb.setupOptions.preferFlash)&&Ib.push(z.mobileUA),mb.setupOptions.useHTML5Audio=!0,mb.setupOptions.preferFlash=!1,Mb||Nb&&!qb.match(/android\s2\.3/i))&&(Ib.push(z.globalHTML5),Mb&&(mb.ignoreFlash=!0),Lb=!0)},B(),hb(),eb.add(a,"focus",y),eb.add(a,"load",v),eb.add(a,"load",D),sb.addEventListener?sb.addEventListener("DOMContentLoaded",C,!1):sb.attachEvent?sb.attachEvent("onreadystatechange",cb):(m("onload",!1),H({type:"NO_DOM2_EVENTS",fatal:!0}))}var d=null;void 0!==a.SM2_DEFER&&SM2_DEFER||(d=new c),a.SoundManager=c,a.soundManager=d}(window),function(){var a;a=function(){function a(){this.options_index=0,this.parsed=[]}return a.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName.toUpperCase()?this.add_group(a):this.add_option(a)},a.prototype.add_group=function(a){var b,c,d,e,f,g;for(b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:a.label,children:0,disabled:a.disabled}),f=a.childNodes,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},a.prototype.add_option=function(a,b,c){return"OPTION"===a.nodeName.toUpperCase()?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},a}(),a.select_to_array=function(b){var c,d,e,f,g;for(d=new a,g=b.childNodes,e=0,f=g.length;f>e;e++)c=g[e],d.add_node(c);return d.parsed},this.SelectParser=a}.call(this),function(){var a,b;b=this,a=function(){function a(a,b){this.form_field=a,this.options=null!=b?b:{},this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return a.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.search_contains=this.options.search_contains||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1},a.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option",this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"},a.prototype.mouse_enter=function(){return this.mouse_on_container=!0},a.prototype.mouse_leave=function(){return this.mouse_on_container=!1},a.prototype.input_focus=function(){var a=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return a.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},a.prototype.input_blur=function(){var a=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return a.blur_test()},100))},a.prototype.result_add_option=function(a){var b,c;return a.disabled?"":(a.dom_id=this.container_id+"_o_"+a.array_index,b=a.selected&&this.is_multiple?[]:["active-result"],a.selected&&b.push("result-selected"),null!=a.group_array_index&&b.push("group-option"),""!==a.classes&&b.push(a.classes),c=""!==a.style.cssText?' style="'+a.style+'"':"",'<li id="'+a.dom_id+'" class="'+b.join(" ")+'"'+c+">"+a.html+"</li>")},a.prototype.results_update_field=function(){return this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},a.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},a.prototype.keyup_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},a.prototype.generate_field_id=function(){var a;return a=this.generate_random_id(),this.form_field.id=a,a},a.prototype.generate_random_char=function(){var a,b,c;return a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=Math.floor(Math.random()*a.length),b=a.substring(c,c+1)},a}(),b.AbstractChosen=a}.call(this),function(){var a,b,c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=this,a=jQuery,a.fn.extend({chosen:function(c){var d,e,f;return f=navigator.userAgent.toLowerCase(),e=/(msie) ([\w.]+)/.exec(f)||[],d={name:e[1]||"",version:e[2]||"0"},"msie"===d.name&&("6.0"===d.version||"7.0"===d.version&&7===document.documentMode)?this:this.each(function(){var d;return d=a(this),d.hasClass("chzn-done")?void 0:d.data("chosen",new b(this,c))})}}),b=function(b){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,b),e.prototype.setup=function(){return this.form_field_jq=a(this.form_field),this.current_value=this.form_field_jq.val(),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},e.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},e.prototype.set_up_html=function(){var b,d,e,f,g,h;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",b=["chzn-container"],b.push("chzn-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&b.push(this.form_field.className),this.is_rtl&&b.push("chzn-rtl"),this.f_width=this.form_field_jq.outerWidth(),e={id:this.container_id,"class":b.join(" "),style:"width: "+this.f_width+"px;",title:this.form_field.title},d=a("<div />",e),d.html(this.is_multiple?'<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>':'<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(d),this.container=a("#"+this.container_id),this.dropdown=this.container.find("div.chzn-drop").first(),f=this.container.height(),g=this.f_width-c(this.dropdown),this.dropdown.css({width:g+"px",top:f+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),h=g-c(this.search_container)-c(this.search_field),this.search_field.css({width:h+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},e.prototype.register_observers=function(){var a=this;return this.container.mousedown(function(b){return a.container_mousedown(b)}),this.container.mouseup(function(b){return a.container_mouseup(b)}),this.container.mouseenter(function(b){return a.mouse_enter(b)}),this.container.mouseleave(function(b){return a.mouse_leave(b)}),this.search_results.mouseup(function(b){return a.search_results_mouseup(b)}),this.search_results.mouseover(function(b){return a.search_results_mouseover(b)}),this.search_results.mouseout(function(b){return a.search_results_mouseout(b)}),this.form_field_jq.bind("liszt:updated",function(b){return a.results_update_field(b)}),this.form_field_jq.bind("liszt:activate",function(b){return a.activate_field(b)}),this.form_field_jq.bind("liszt:open",function(b){return a.container_mousedown(b)}),this.search_field.blur(function(b){return a.input_blur(b)}),this.search_field.keyup(function(b){return a.keyup_checker(b)}),this.search_field.keydown(function(b){return a.keydown_checker(b)}),this.search_field.focus(function(b){return a.input_focus(b)}),this.is_multiple?this.search_choices.click(function(b){return a.choices_click(b)}):this.container.click(function(a){return a.preventDefault()})},e.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},e.prototype.container_mousedown=function(b){var c;return this.is_disabled?void 0:(c=null!=b?a(b.target).hasClass("search-choice-close"):!1,b&&"mousedown"===b.type&&!this.results_showing&&b.preventDefault(),this.pending_destroy_click||c?this.pending_destroy_click=!1:(this.active_field?!this.is_multiple&&b&&(a(b.target)[0]===this.selected_item[0]||a(b.target).parents("a.chzn-single").length)&&(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).click(this.click_test_action),this.results_show()),this.activate_field()))},e.prototype.container_mouseup=function(a){return"ABBR"!==a.target.nodeName||this.is_disabled?void 0:this.results_reset(a)},e.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},e.prototype.close_field=function(){return a(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},e.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},e.prototype.test_active_click=function(b){return a(b.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},e.prototype.results_build=function(){var a,b,c,e,f;for(this.parsing=!0,this.results_data=d.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),a="",f=this.results_data,c=0,e=f.length;e>c;c++)b=f[c],b.group?a+=this.result_add_group(b):b.empty||(a+=this.result_add_option(b),b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(b.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(a),this.parsing=!1},e.prototype.result_add_group=function(b){return b.disabled?"":(b.dom_id=this.container_id+"_g_"+b.array_index,'<li id="'+b.dom_id+'" class="group-result">'+a("<div />").text(b.label).html()+"</li>")},e.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){if(this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight(),b>=e)return this.search_results.scrollTop(b-d>0?b-d:0);if(f>c)return this.search_results.scrollTop(c)}},e.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},e.prototype.results_show=function(){var a;if(this.is_multiple){if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1}else this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected);return a=this.is_multiple?this.container.height():this.container.height()-1,this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.dropdown.css({top:a+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},e.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},e.prototype.set_tab_index=function(){var a;return this.form_field_jq.attr("tabindex")?(a=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",a)):void 0},e.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},e.prototype.search_results_mouseup=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c.length?(this.result_highlight=c,this.result_select(b),this.search_field.focus()):void 0},e.prototype.search_results_mouseover=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c?this.result_do_highlight(c):void 0},e.prototype.search_results_mouseout=function(b){return a(b.target).hasClass("active-result")?this.result_clear_highlight():void 0},e.prototype.choices_click=function(b){return b.preventDefault(),!this.active_field||a(b.target).hasClass("search-choice")||this.results_showing?void 0:this.results_show()},e.prototype.choice_build=function(b){var c,d,e,f=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(c=this.container_id+"_c_"+b.array_index,this.choices+=1,d=b.disabled?'<li class="search-choice search-choice-disabled" id="'+c+'"><span>'+b.html+"</span></li>":'<li class="search-choice" id="'+c+'"><span>'+b.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+b.array_index+'"></a></li>',this.search_container.before(d),e=a("#"+c).find("a").first(),e.click(function(a){return f.choice_destroy_link_click(a)}))},e.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),this.is_disabled?b.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(a(b.target)))},e.prototype.choice_destroy=function(a){return this.result_deselect(a.attr("rel"))?(this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),a.parents("li").first().remove(),this.search_field_scale()):void 0},e.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},e.prototype.results_reset_cleanup=function(){return this.current_value=this.form_field_jq.val(),this.selected_item.find("abbr").remove()},e.prototype.result_select=function(a){var b,c,d,e;return this.result_highlight?(b=this.result_highlight,c=b.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(b):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=b,this.selected_item.removeClass("chzn-default")),b.addClass("result-selected"),e=c.substr(c.lastIndexOf("_")+1),d=this.results_data[e],d.selected=!0,this.form_field.options[d.options_index].selected=!0,this.is_multiple?this.choice_build(d):(this.selected_item.find("span").first().text(d.text),this.allow_single_deselect&&this.single_deselect_control_build()),(!a.metaKey&&!a.ctrlKey||!this.is_multiple)&&this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[d.options_index].value}),this.current_value=this.form_field_jq.val(),this.search_field_scale()):void 0},e.prototype.result_activate=function(a){return a.addClass("active-result")},e.prototype.result_deactivate=function(a){return a.removeClass("active-result")},e.prototype.result_deselect=function(b){var c,d;return d=this.results_data[b],this.form_field.options[d.options_index].disabled?!1:(d.selected=!1,this.form_field.options[d.options_index].selected=!1,c=a("#"+this.container_id+"_o_"+b),c.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[d.options_index].value}),this.search_field_scale(),!0)},e.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},e.prototype.winnow_results=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(this.no_results_clear(),j=0,k=this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html(),g=this.search_contains?"":"^",f=new RegExp(g+k.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),n=new RegExp(k.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),s=this.results_data,o=0,q=s.length;q>o;o++)if(c=s[o],!c.disabled&&!c.empty)if(c.group)a("#"+c.dom_id).css("display","none");else if(!this.is_multiple||!c.selected){if(b=!1,i=c.dom_id,h=a("#"+i),f.test(c.html))b=!0,j+=1;else if(this.enable_split_word_search&&(c.html.indexOf(" ")>=0||0===c.html.indexOf("["))&&(e=c.html.replace(/\[|\]/g,"").split(" "),e.length))for(p=0,r=e.length;r>p;p++)d=e[p],f.test(d)&&(b=!0,j+=1);b?(k.length?(l=c.html.search(n),m=c.html.substr(0,l+k.length)+"</em>"+c.html.substr(l+k.length),m=m.substr(0,l)+"<em>"+m.substr(l)):m=c.html,h.html(m),this.result_activate(h),null!=c.group_array_index&&a("#"+this.results_data[c.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&i===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(h))}return 1>j&&k.length?this.no_results(k):this.winnow_results_set_highlight()},e.prototype.winnow_results_clear=function(){var b,c,d,e,f;for(this.search_field.val(""),c=this.search_results.find("li"),f=[],d=0,e=c.length;e>d;d++)b=c[d],b=a(b),f.push(b.hasClass("group-result")?b.css("display","auto"):this.is_multiple&&b.hasClass("result-selected")?void 0:this.result_activate(b));return f},e.prototype.winnow_results_set_highlight=function(){var a,b;return this.result_highlight||(b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first(),null==a)?void 0:this.result_do_highlight(a)},e.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c)},e.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},e.prototype.keydown_arrow=function(){var b,c;return this.result_highlight?this.results_showing&&(c=this.result_highlight.nextAll("li.active-result").first(),c&&this.result_do_highlight(c)):(b=this.search_results.find("li.active-result").first(),b&&this.result_do_highlight(a(b))),this.results_showing?void 0:this.results_show()},e.prototype.keyup_arrow=function(){var a;return this.results_showing||this.is_multiple?this.result_highlight?(a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},e.prototype.keydown_backstroke=function(){var a;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(a=this.search_container.siblings("li.search-choice").last(),a.length&&!a.hasClass("search-choice-disabled")?(this.pending_backstroke=a,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},e.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},e.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},e.prototype.search_field_scale=function(){var b,c,d,e,f,g,h,i,j;if(this.is_multiple){for(d=0,h=0,f="position:absolute; left: -1000px; top: -1000px; display:none;",g=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],i=0,j=g.length;j>i;i++)e=g[i],f+=e+":"+this.search_field.css(e)+";";return c=a("<div />",{style:f}),c.text(this.search_field.val()),a("body").append(c),h=c.width()+25,c.remove(),h>this.f_width-10&&(h=this.f_width-10),this.search_field.css({width:h+"px"}),b=this.container.height(),this.dropdown.css({top:b+"px"})}},e.prototype.generate_random_id=function(){var b;for(b="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();a("#"+b).length>0;)b+=this.generate_random_char();return b},e}(AbstractChosen),d.Chosen=b,c=function(a){var b;return b=a.outerWidth()-a.width()},d.get_side_border_padding=c}.call(this),function(a){function b(a,b){var c=typeof a[b];return"function"===c||!("object"!=c||!a[b])||"unknown"==c}function c(a,b,c){return 0>b&&(b+=a.value.length),"undefined"==typeof c&&(c=b),0>c&&(c+=a.value.length),{start:b,end:c}}function d(){return"object"==typeof document.body&&document.body?document.body:document.getElementsByTagName("body")[0]}var e,f,g,h,i,j,k,l,m;a(document).ready(function(){function n(a,b){return function(){var c=this.jquery?this[0]:this,d=c.nodeName.toLowerCase();return 1!=c.nodeType||"textarea"!=d&&("input"!=d||"text"!=c.type)||(c=[c].concat(Array.prototype.slice.call(arguments)),c=a.apply(this,c),b)?b?this:void 0:c}}var o=document.createElement("textarea");if(d().appendChild(o),"undefined"!=typeof o.selectionStart&&"undefined"!=typeof o.selectionEnd)e=function(a){return{start:a.selectionStart,end:a.selectionEnd,length:a.selectionEnd-a.selectionStart,text:a.value.slice(a.selectionStart,a.selectionEnd)}},f=function(a,b,d){b=c(a,b,d),a.selectionStart=b.start,a.selectionEnd=b.end},m=function(a,b){b?a.selectionEnd=a.selectionStart:a.selectionStart=a.selectionEnd};else{if(!(b(o,"createTextRange")&&"object"==typeof document.selection&&document.selection&&b(document.selection,"createRange")))return d().removeChild(o),void(window.console&&window.console.log&&window.console.log("TextInputs module for Rangy not supported in your browser. Reason: No means of finding text input caret position"));e=function(a){var b,c,d,e=0,f=0;return(d=document.selection.createRange())&&d.parentElement()==a&&(c=a.value.length,b=a.value.replace(/\r\n/g,"\n"),f=a.createTextRange(),f.moveToBookmark(d.getBookmark()),d=a.createTextRange(),d.collapse(!1),f.compareEndPoints("StartToEnd",d)>-1?e=f=c:(e=-f.moveStart("character",-c),e+=b.slice(0,e).split("\n").length-1,f.compareEndPoints("EndToEnd",d)>-1?f=c:(f=-f.moveEnd("character",-c),f+=b.slice(0,f).split("\n").length-1))),{start:e,end:f,length:f-e,text:a.value.slice(e,f)}},f=function(a,b,d){b=c(a,b,d),d=a.createTextRange();var e=b.start-(a.value.slice(0,b.start).split("\r\n").length-1);d.collapse(!0),b.start==b.end?d.move("character",e):(d.moveEnd("character",b.end-(a.value.slice(0,b.end).split("\r\n").length-1)),d.moveStart("character",e)),d.select()},m=function(a,b){var c=document.selection.createRange();c.collapse(b),c.select()}}d().removeChild(o),h=function(a,b,c,d){var e;b!=c&&(e=a.value,a.value=e.slice(0,b)+e.slice(c)),d&&f(a,b,b)},g=function(a){var b=e(a);h(a,b.start,b.end,!0)},l=function(a){var b,c=e(a);return c.start!=c.end&&(b=a.value,a.value=b.slice(0,c.start)+b.slice(c.end)),f(a,c.start,c.start),c.text},i=function(a,b,c,d){var e=a.value;a.value=e.slice(0,c)+b+e.slice(c),d&&(b=c+b.length,f(a,b,b))},j=function(a,b){var c=e(a),d=a.value;a.value=d.slice(0,c.start)+b+d.slice(c.end),c=c.start+b.length,f(a,c,c)},k=function(a,b,c){var d=e(a),g=a.value;a.value=g.slice(0,d.start)+b+d.text+c+g.slice(d.end),b=d.start+b.length,f(a,b,b+d.length)},a.fn.extend({getSelection:n(e,!1),setSelection:n(f,!0),collapseSelection:n(m,!0),deleteSelectedText:n(g,!0),deleteText:n(h,!0),extractSelectedText:n(l,!1),insertText:n(i,!0),replaceSelectedText:n(j,!0),surroundSelectedText:n(k,!0)})})}(jQuery),function(a){var b={tabHandle:".handle",speed:300,action:"click",tabLocation:"left",topPos:"200px",leftPos:"20px",fixedPosition:!1,positioning:"absolute",pathToTabImage:null,imageHeight:null,imageWidth:null,onLoadSlideOut:!1,topReferenceElement:null,height:null},c=function(a,b){var c=a.outerHeight();return"function"==typeof b.height&&(c=b.height(a)),{containerWidth:parseInt(a.outerWidth(),10)+"px",containerHeight:parseInt(c,10)+20+"px",tabWidth:parseInt(b.tabHandle.outerWidth(),10)+"px",tab:parseInt(b.tabHandle.outerHeight(),10)+"px"}},d=function(b,c,d){if(("top"===c.tabLocation||"bottom"===c.tabLocation)&&(b.css({left:c.leftPos}),c.tabHandle.css({right:0})),"top"===c.tabLocation&&(b.css({top:"-"+d.containerHeight}),c.tabHandle.css({bottom:"-"+d.tabHeight})),"bottom"===c.tabLocation&&(b.css({bottom:"-"+d.containerHeight,position:"fixed"}),c.tabHandle.css({top:"-"+d.tabHeight})),"left"===c.tabLocation||"right"===c.tabLocation){var e=parseInt(c.topPos,10),f=parseInt(c.topPos,10),g=0;c.topReferenceElement&&(e=a(c.topReferenceElement).position().top,g=f-e),console.log("diff",g,"top",e,"topPos",f,"height",d.containerHeight),b.css({height:d.containerHeight,top:e}),c.tabHandle.css({top:f+"px"})}"left"===c.tabLocation&&(b.css({left:"-"+d.containerWidth}),c.tabHandle.css({right:"-"+d.tabWidth})),"right"===c.tabLocation&&(b.css({right:"-"+d.containerWidth}),c.tabHandle.css({left:"-"+d.tabWidth}),a("html").css("overflow-x","hidden"))},e={refresh:function(){console.log("this",a(this));var b=a(this).data("tabSlideOut");if(b){var e=c(a(this),b);d(this,b,e),console.log("reset",e)}}};a.fn.tabSlideOut=function(f){if("string"!=typeof f){var g=a.extend(b,f||{}),h=a(this).data("tabSlideOut");h||a(this).data("tabSlideOut",g),g.tabHandle=a(g.tabHandle);var i=this;g.positioning=g.fixedPosition===!0?"fixed":"absolute",!document.all||window.opera||window.XMLHttpRequest||(g.positioning="absolute"),null!=g.pathToTabImage&&g.tabHandle.css({background:"url("+g.pathToTabImage+") no-repeat",width:g.imageWidth,height:g.imageHeight}),g.tabHandle.css({display:"block",textIndent:"-99999px",outline:"none",position:"absolute"}),i.css({"line-height":"1",position:g.positioning});var j=c(i,g);d(i,g,j),g.tabHandle.click(function(a){a.preventDefault()});var k=function(){if(i.hasClass("open")){var a=c(i,g);console.log("props",a),"top"===g.tabLocation?i.animate({top:"-"+a.containerHeight},g.speed).removeClass("open"):"left"===g.tabLocation?i.animate({left:"-"+a.containerWidth},g.speed).removeClass("open"):"right"===g.tabLocation?i.animate({right:"-"+a.containerWidth},g.speed).removeClass("open"):"bottom"===g.tabLocation&&i.animate({bottom:"-"+a.containerHeight},g.speed).removeClass("open")}},l=function(){var a=c(i,g);d(i,g,a),console.log("props out",a),console.log(i[0].scrollHeight),"top"==g.tabLocation?i.animate({top:"-3px"},g.speed).addClass("open"):"left"==g.tabLocation?i.animate({left:"-3px"},g.speed).addClass("open"):"right"==g.tabLocation?i.animate({right:"-3px"},g.speed).addClass("open"):"bottom"==g.tabLocation&&i.animate({bottom:"-3px"},g.speed).addClass("open")},m=function(){i.click(function(a){a.stopPropagation()}),a(document).click(function(){k()})},n=function(){g.tabHandle.click(function(){i.hasClass("open")?k():l()}),m()},o=function(){i.hover(function(){l()},function(){k()}),g.tabHandle.click(function(){i.hasClass("open")&&k()}),m()},p=function(){k(),setTimeout(l,500)};"click"===g.action&&n(),"hover"===g.action&&o(),g.onLoadSlideOut&&p()}else if(e[f])return e[f].apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery),function(a){function b(a){return"object"==typeof a?a:{top:a,left:a}}var c=a.scrollTo=function(b,c,d){a(window).scrollTo(b,c,d)};c.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1,limit:!0},c.window=function(){return a(window)._scrollable()},a.fn._scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||-1!=a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!c)return b;var d=(b.contentWindow||b).document||b.ownerDocument||b;return/webkit/i.test(navigator.userAgent)||"BackCompat"==d.compatMode?d.body:d.documentElement})},a.fn.scrollTo=function(d,e,f){return"object"==typeof e&&(f=e,e=0),"function"==typeof f&&(f={onAfter:f}),"max"==d&&(d=9e9),f=a.extend({},c.defaults,f),e=e||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(e/=2),f.offset=b(f.offset),f.over=b(f.over),this._scrollable().each(function(){function g(a){j.animate(l,e,f.easing,a&&function(){a.call(this,d,f)})}if(null!=d){var h,i=this,j=a(i),k=d,l={},m=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(k)){k=b(k);break}if(k=a(k,this),!k.length)return;case"object":(k.is||k.style)&&(h=(k=a(k)).offset())}a.each(f.axis.split(""),function(a,b){var d="x"==b?"Left":"Top",e=d.toLowerCase(),n="scroll"+d,o=i[n],p=c.max(i,b);
if(h)l[n]=h[e]+(m?0:o-j.offset()[e]),f.margin&&(l[n]-=parseInt(k.css("margin"+d))||0,l[n]-=parseInt(k.css("border"+d+"Width"))||0),l[n]+=f.offset[e]||0,f.over[e]&&(l[n]+=k["x"==b?"width":"height"]()*f.over[e]);else{var q=k[e];l[n]=q.slice&&"%"==q.slice(-1)?parseFloat(q)/100*p:q}f.limit&&/^\d+$/.test(l[n])&&(l[n]=l[n]<=0?0:Math.min(l[n],p)),!a&&f.queue&&(o!=l[n]&&g(f.onAfterFirst),delete l[n])}),g(f.onAfter)}}).end()},c.max=function(b,c){var d="x"==c?"Width":"Height",e="scroll"+d;if(!a(b).is("html,body"))return b[e]-a(b)[d.toLowerCase()]();var f="client"+d,g=b.ownerDocument.documentElement,h=b.ownerDocument.body;return Math.max(g[e],h[e])-Math.min(g[f],h[f])}}(jQuery),function(a){a.fn.zclip=function(b){if("object"==typeof b&&!b.length){var c=a.extend({path:"ZeroClipboard.swf",copy:null,beforeCopy:null,afterCopy:null,clickAfter:!0,setHandCursor:!0,setCSSEffects:!0},b);return this.each(function(){var b=a(this);if(b.is(":visible")&&("string"==typeof c.copy||a.isFunction(c.copy))){ZeroClipboard.setMoviePath(c.path);var d=new ZeroClipboard.Client;a.isFunction(c.copy)&&b.bind("zClip_copy",c.copy),a.isFunction(c.beforeCopy)&&b.bind("zClip_beforeCopy",c.beforeCopy),a.isFunction(c.afterCopy)&&b.bind("zClip_afterCopy",c.afterCopy),d.setHandCursor(c.setHandCursor),d.setCSSEffects(c.setCSSEffects),d.addEventListener("mouseOver",function(){b.trigger("mouseenter")}),d.addEventListener("mouseOut",function(){b.trigger("mouseleave")}),d.addEventListener("mouseDown",function(){b.trigger("mousedown"),d.setText(a.isFunction(c.copy)?b.triggerHandler("zClip_copy"):c.copy),a.isFunction(c.beforeCopy)&&b.trigger("zClip_beforeCopy")}),d.addEventListener("complete",function(d,e){a.isFunction(c.afterCopy)?b.trigger("zClip_afterCopy"):(e.length>500&&(e=e.substr(0,500)+"...\n\n("+(e.length-500)+" characters not shown)"),b.removeClass("hover"),alert("Copied text to clipboard:\n\n "+e)),c.clickAfter&&b.trigger("click")}),d.glue(b[0],b.parent()[0]),a(window).bind("load resize",function(){d.reposition()})}})}return"string"==typeof b?this.each(function(){var c=a(this);b=b.toLowerCase();var d=c.data("zclipId"),e=a("#"+d+".zclip");"remove"==b?(e.remove(),c.removeClass("active hover")):"hide"==b?(e.hide(),c.removeClass("active hover")):"show"==b&&e.show()}):void 0}}(jQuery);var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(a){return"string"==typeof a&&(a=document.getElementById(a)),a.addClass||(a.hide=function(){this.style.display="none"},a.show=function(){this.style.display=""},a.addClass=function(a){this.removeClass(a),this.className+=" "+a},a.removeClass=function(a){for(var b=this.className.split(/\s+/),c=-1,d=0;d<b.length;d++)b[d]==a&&(c=d,d=b.length);return c>-1&&(b.splice(c,1),this.className=b.join(" ")),this},a.hasClass=function(a){return!!this.className.match(new RegExp("\\s*"+a+"\\s*"))}),a},setMoviePath:function(a){this.moviePath=a},dispatch:function(a,b,c){var d=this.clients[a];d&&d.receiveEvent(b,c)},register:function(a,b){this.clients[a]=b},getDOMObjectPosition:function(a,b){var c={left:0,top:0,width:a.width?a.width:a.offsetWidth,height:a.height?a.height:a.offsetHeight};return a&&a!=b&&(c.left+=a.offsetLeft,c.top+=a.offsetTop),c},Client:function(a){this.handlers={},this.id=ZeroClipboard.nextId++,this.movieId="ZeroClipboardMovie_"+this.id,ZeroClipboard.register(this.id,this),a&&this.glue(a)}};ZeroClipboard.Client.prototype={id:0,ready:!1,movie:null,clipText:"",handCursorEnabled:!0,cssEffects:!0,handlers:null,glue:function(a,b,c){this.domElement=ZeroClipboard.$(a);var d=99;this.domElement.style.zIndex&&(d=parseInt(this.domElement.style.zIndex,10)+1),"string"==typeof b?b=ZeroClipboard.$(b):"undefined"==typeof b&&(b=document.getElementsByTagName("body")[0]);var e=ZeroClipboard.getDOMObjectPosition(this.domElement,b);this.div=document.createElement("div"),this.div.className="zclip",this.div.id="zclip-"+this.movieId,$(this.domElement).data("zclipId","zclip-"+this.movieId);var f=this.div.style;if(f.position="absolute",f.left=""+e.left+"px",f.top=""+e.top+"px",f.width=""+e.width+"px",f.height=""+e.height+"px",f.zIndex=d,"object"==typeof c)for(addedStyle in c)f[addedStyle]=c[addedStyle];b.appendChild(this.div),this.div.innerHTML=this.getHTML(e.width,e.height)},getHTML:function(a,b){var c="",d="id="+this.id+"&width="+a+"&height="+b;if(navigator.userAgent.match(/MSIE/)){var e=location.href.match(/^https/i)?"https://":"http://";c+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+e+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+a+'" height="'+b+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+d+'"/><param name="wmode" value="transparent"/></object>'}else c+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+a+'" height="'+b+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+d+'" wmode="transparent" />';return c},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var a=document.getElementsByTagName("body")[0];try{a.removeChild(this.div)}catch(b){}this.domElement=null,this.div=null}},reposition:function(a){if(a&&(this.domElement=ZeroClipboard.$(a),this.domElement||this.hide()),this.domElement&&this.div){var b=ZeroClipboard.getDOMObjectPosition(this.domElement),c=this.div.style;c.left=""+b.left+"px",c.top=""+b.top+"px"}},setText:function(a){this.clipText=a,this.ready&&this.movie.setText(a)},addEventListener:function(a,b){a=a.toString().toLowerCase().replace(/^on/,""),this.handlers[a]||(this.handlers[a]=[]),this.handlers[a].push(b)},setHandCursor:function(a){this.handCursorEnabled=a,this.ready&&this.movie.setHandCursor(a)},setCSSEffects:function(a){this.cssEffects=!!a},receiveEvent:function(a,b){switch(a=a.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=document.getElementById(this.movieId),!this.movie){var c=this;return void setTimeout(function(){c.receiveEvent("load",null)},1)}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var c=this;return setTimeout(function(){c.receiveEvent("load",null)},100),void(this.ready=!0)}this.ready=!0;try{this.movie.setText(this.clipText)}catch(d){}try{this.movie.setHandCursor(this.handCursorEnabled)}catch(d){}break;case"mouseover":this.domElement&&this.cssEffects&&(this.domElement.addClass("hover"),this.recoverActive&&this.domElement.addClass("active"));break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0),this.domElement.removeClass("hover"));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[a])for(var e=0,f=this.handlers[a].length;f>e;e++){var g=this.handlers[a][e];"function"==typeof g?g(this,b):"object"==typeof g&&2==g.length?g[0][g[1]](this,b):"string"==typeof g&&window[g](this,b)}}},!function(a){a(function(){a.support.transition=function(){var a=function(){var a,b=document.createElement("bootstrap"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(a in c)if(void 0!==b.style[a])return c[a]}();return a&&{end:a}}()})}(window.jQuery),!function(a){var b=function(b,c){this.options=c,this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};b.prototype={constructor:b,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this,c=a.Event("show");this.$element.trigger(c),this.isShown||c.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var c=a.support.transition&&b.$element.hasClass("fade");b.$element.parent().length||b.$element.appendTo(document.body),b.$element.show(),c&&b.$element[0].offsetWidth,b.$element.addClass("in").attr("aria-hidden",!1),b.enforceFocus(),c?b.$element.one(a.support.transition.end,function(){b.$element.focus().trigger("shown")}):b.$element.focus().trigger("shown")}))},hide:function(b){b&&b.preventDefault();b=a.Event("hide"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),a.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var b=this;a(document).on("focusin.modal",function(a){b.$element[0]!==a.target&&!b.$element.has(a.target).length&&b.$element.focus()})},escape:function(){var a=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(b){27==b.which&&a.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var b=this,c=setTimeout(function(){b.$element.off(a.support.transition.end),b.hideModal()},500);this.$element.one(a.support.transition.end,function(){clearTimeout(c),b.hideModal()})},hideModal:function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;if(this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?a.proxy(this.$element[0].focus,this.$element[0]):a.proxy(this.hide,this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;d?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b):b()):b&&b()}};var c=a.fn.modal;a.fn.modal=function(c){return this.each(function(){var d=a(this),e=d.data("modal"),f=a.extend({},a.fn.modal.defaults,d.data(),"object"==typeof c&&c);e||d.data("modal",e=new b(this,f)),"string"==typeof c?e[c]():f.show&&e.show()})},a.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},a.fn.modal.Constructor=b,a.fn.modal.noConflict=function(){return a.fn.modal=c,this},a(document).on("click.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f).one("hide",function(){c.focus()})})}(window.jQuery),!function(a){function b(){a(d).each(function(){c(a(this)).removeClass("open")})}function c(b){var c,d=b.attr("data-target");return d||(d=b.attr("href"),d=d&&/#/.test(d)&&d.replace(/.*(?=#[^\s]*$)/,"")),c=d&&a(d),c&&c.length||(c=b.parent()),c}var d="[data-toggle=dropdown]",e=function(b){var c=a(b).on("click.dropdown.data-api",this.toggle);a("html").on("click.dropdown.data-api",function(){c.parent().removeClass("open")})};e.prototype={constructor:e,toggle:function(){var d,e,f=a(this);if(!f.is(".disabled, :disabled"))return d=c(f),e=d.hasClass("open"),b(),e||d.toggleClass("open"),f.focus(),!1},keydown:function(b){var e,f,g,h,i;if(/(38|40|27)/.test(b.keyCode)&&(e=a(this),b.preventDefault(),b.stopPropagation(),!e.is(".disabled, :disabled"))){if(g=c(e),h=g.hasClass("open"),!h||h&&27==b.keyCode)return 27==b.which&&g.find(d).focus(),e.click();f=a("[role=menu] li:not(.divider):visible a",g),f.length&&(i=f.index(f.filter(":focus")),38==b.keyCode&&i>0&&i--,40==b.keyCode&&i<f.length-1&&i++,~i||(i=0),f.eq(i).focus())}}};var f=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),d=c.data("dropdown");d||c.data("dropdown",d=new e(this)),"string"==typeof b&&d[b].call(c)})},a.fn.dropdown.Constructor=e,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=f,this},a(document).on("click.dropdown.data-api",b).on("click.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.dropdown-menu",function(a){a.stopPropagation()}).on("click.dropdown.data-api",d,e.prototype.toggle).on("keydown.dropdown.data-api",d+", [role=menu]",e.prototype.keydown)}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.button.defaults,c)};b.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.data(),e=c.is("input")?"val":"html";a+="Text",d.resetText||c.data("resetText",c[e]()),c[e](d[a]||this.options[a]),setTimeout(function(){"loadingText"==a?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},b.prototype.toggle=function(){var a=this.$element.closest('[data-toggle="buttons-radio"]');a&&a.find(".active").removeClass("active"),this.$element.toggleClass("active")};var c=a.fn.button;a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("button"),f="object"==typeof c&&c;e||d.data("button",e=new b(this,f)),"toggle"==c?e.toggle():c&&e.setState(c)})},a.fn.button.defaults={loadingText:"loading..."},a.fn.button.Constructor=b,a.fn.button.noConflict=function(){return a.fn.button=c,this},a(document).on("click.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle")})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.typeahead.defaults,c),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=a(this.options.menu),this.shown=!1,this.listen()};b.prototype={constructor:b,select:function(){var a=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(a)).change(),this.hide()},updater:function(a){return a},show:function(){var b=a.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:b.top+b.height,left:b.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var b;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(b=a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source,b?this.process(b):this)},process:function(b){var c=this;return b=a.grep(b,function(a){return c.matcher(a)}),b=this.sorter(b),b.length?this.render(b.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var b,c=[],d=[],e=[];b=a.shift();)b.toLowerCase().indexOf(this.query.toLowerCase())?~b.indexOf(this.query)?d.push(b):e.push(b):c.push(b);return c.concat(d,e)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var c=this;return b=a(b).map(function(b,d){return b=a(c.options.item).attr("data-value",d),b.find("a").html(c.highlighter(d)),b[0]}),b.first().addClass("active"),this.$menu.html(b),this},next:function(){var b=this.$menu.find(".active").removeClass("active"),c=b.next();c.length||(c=a(this.$menu.find("li")[0])),c.addClass("active")},prev:function(){var a=this.$menu.find(".active").removeClass("active"),b=a.prev();b.length||(b=this.$menu.find("li").last()),b.addClass("active")},listen:function(){this.$element.on("focus",a.proxy(this.focus,this)).on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",a.proxy(this.keydown,this)),this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this)).on("mouseleave","li",a.proxy(this.mouseleave,this))},eventSupported:function(a){var b=a in this.$element;return b||(this.$element.setAttribute(a,"return;"),b="function"==typeof this.$element[a]),b},move:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault(),this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()}},keydown:function(b){this.suppressKeyPressRepeat=~a.inArray(b.keyCode,[40,38,9,13,27]),this.move(b)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}a.stopPropagation(),a.preventDefault()},focus:function(){this.focused=!0},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(a){a.stopPropagation(),a.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(b){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")},mouseleave:function(){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var c=a.fn.typeahead;a.fn.typeahead=function(c){return this.each(function(){var d=a(this),e=d.data("typeahead"),f="object"==typeof c&&c;e||d.data("typeahead",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},a.fn.typeahead.Constructor=b,a.fn.typeahead.noConflict=function(){return a.fn.typeahead=c,this},a(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(){var b=a(this);b.data("typeahead")||b.typeahead(b.data())})}(window.jQuery),!function(a){var b=function(b,c){if(this.$element=a(b),this.type=this.$element.data("uploadtype")||(this.$element.find(".thumbnail").length>0?"image":"file"),this.$input=this.$element.find(":file"),0!==this.$input.length){this.name=this.$input.attr("name")||c.name,this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]'),0===this.$hidden.length&&(this.$hidden=a('<input type="hidden" />'),this.$element.prepend(this.$hidden)),this.$preview=this.$element.find(".fileupload-preview");var d=this.$preview.css("height");"inline"!=this.$preview.css("display")&&"0px"!=d&&"none"!=d&&this.$preview.css("line-height",d),this.original={exists:this.$element.hasClass("fileupload-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()},this.$remove=this.$element.find('[data-dismiss="fileupload"]'),this.$element.find('[data-trigger="fileupload"]').on("click.fileupload",a.proxy(this.trigger,this)),this.listen()}};b.prototype={listen:function(){this.$input.on("change.fileupload",a.proxy(this.change,this)),a(this.$input[0].form).on("reset.fileupload",a.proxy(this.reset,this)),this.$remove&&this.$remove.on("click.fileupload",a.proxy(this.clear,this))},change:function(a,b){if("clear"!==b){var c=void 0!==a.target.files?a.target.files[0]:a.target.value?{name:a.target.value.replace(/^.+\\/,"")}:null;if(!c)return void this.clear();if(this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name),"image"===this.type&&this.$preview.length>0&&("undefined"!=typeof c.type?c.type.match("image.*"):c.name.match("\\.(gif|png|jpe?g)$"))&&"undefined"!=typeof FileReader){var d=new FileReader,e=this.$preview,f=this.$element;d.onload=function(a){e.html('<img src="'+a.target.result+'" '+("none"!=e.css("max-height")?'style="max-height: '+e.css("max-height")+';"':"")+" />"),f.addClass("fileupload-exists").removeClass("fileupload-new")},d.readAsDataURL(c)}else this.$preview.text(c.name),this.$element.addClass("fileupload-exists").removeClass("fileupload-new")}},clear:function(a){if(this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name",""),navigator.userAgent.match(/msie/i)){var b=this.$input.clone(!0);this.$input.after(b),this.$input.remove(),this.$input=b}else this.$input.val("");this.$preview.html(""),this.$element.addClass("fileupload-new").removeClass("fileupload-exists"),a&&(this.$input.trigger("change",["clear"]),a.preventDefault())},reset:function(){this.clear(),this.$hidden.val(this.original.hiddenVal),this.$preview.html(this.original.preview),this.original.exists?this.$element.addClass("fileupload-exists").removeClass("fileupload-new"):this.$element.addClass("fileupload-new").removeClass("fileupload-exists")},trigger:function(a){this.$input.trigger("click"),a.preventDefault()}},a.fn.fileupload=function(c){return this.each(function(){var d=a(this),e=d.data("fileupload");e||d.data("fileupload",e=new b(this,c)),"string"==typeof c&&e[c]()})},a.fn.fileupload.Constructor=b,a(document).on("click.fileupload.data-api",'[data-provides="fileupload"]',function(b){var c=a(this);if(!c.data("fileupload")){c.fileupload(c.data());var d=a(b.target).closest('[data-dismiss="fileupload"],[data-trigger="fileupload"]');d.length>0&&(d.trigger("click.fileupload"),b.preventDefault())}})}(window.jQuery),$.ui.plugin.add("draggable","snap2",{start:function(){var a=$(this).data("ui-draggable"),b=a.options;a.snap2Elements=[],$(b.snap2.constructor!==String?b.snap2.items||":data(ui-draggable)":b.snap2).each(function(){var b=$(this),c=b.offset();this!==a.element[0]&&a.snap2Elements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(a,b){var c,d,e,f,g,h,i,j,k,l,m=$(this).data("ui-draggable"),n=m.options,o=n.snap2Tolerance,p=n.snap2Sides,q=b.offset.left,r=q+m.helperProportions.width,s=b.offset.top,t=s+m.helperProportions.height;for(k=m.snap2Elements.length-1;k>=0;k--)g=m.snap2Elements[k].left,h=g+m.snap2Elements[k].width,i=m.snap2Elements[k].top,j=i+m.snap2Elements[k].height,q>g-o&&h+o>q&&s>i-o&&j+o>s||q>g-o&&h+o>q&&t>i-o&&j+o>t||r>g-o&&h+o>r&&s>i-o&&j+o>s||r>g-o&&h+o>r&&t>i-o&&j+o>t?("inner"!==n.snap2Mode&&(c=Math.abs(i-t)<=o&&-1!==p.indexOf("t"),d=Math.abs(j-s)<=o&&-1!==p.indexOf("b"),e=Math.abs(g-r)<=o&&-1!==p.indexOf("l"),f=Math.abs(h-q)<=o&&-1!==p.indexOf("r"),c&&(b.position.top=m._convertPositionTo("relative",{top:i-m.helperProportions.height,left:0}).top-m.margins.top),d&&(b.position.top=m._convertPositionTo("relative",{top:j,left:0}).top-m.margins.top),e&&(b.position.left=m._convertPositionTo("relative",{top:0,left:g-m.helperProportions.width}).left-m.margins.left),f&&(b.position.left=m._convertPositionTo("relative",{top:0,left:h}).left-m.margins.left)),l=c||d||e||f,"outer"!==n.snap2Mode&&(c=Math.abs(i-s)<=o&&-1!==p.indexOf("t"),d=Math.abs(j-t)<=o&&-1!==p.indexOf("b"),e=Math.abs(g-q)<=o&&-1!==p.indexOf("l"),f=Math.abs(h-r)<=o&&-1!==p.indexOf("r"),c&&(b.position.top=m._convertPositionTo("relative",{top:i,left:0}).top-m.margins.top),d&&(b.position.top=m._convertPositionTo("relative",{top:j-m.helperProportions.height,left:0}).top-m.margins.top),e&&(b.position.left=m._convertPositionTo("relative",{top:0,left:g}).left-m.margins.left),f&&(b.position.left=m._convertPositionTo("relative",{top:0,left:h-m.helperProportions.width}).left-m.margins.left)),!m.snap2Elements[k].snapping&&(c||d||e||f||l)&&m.options.snap2.snap2&&m.options.snap2.snap2.call(m.element,a,$.extend(m._uiHash(),{snap2Item:m.snap2Elements[k].item})),m.snap2Elements[k].snapping=c||d||e||f||l):(m.snap2Elements[k].snapping&&m.options.snap2.release&&m.options.snap2.release.call(m.element,a,$.extend(m._uiHash(),{snap2Item:m.snap2Elements[k].item})),m.snap2Elements[k].snapping=!1)}});var EDIBLE=EDIBLE||{};EDIBLE.namespace=function(a){var b,c=a.split("."),d=EDIBLE;for("EDIBLE"===c[0]&&(c=c.lice(1)),b=0;b<c.length;b+=1)"undefined"==typeof d[c[b]]&&(d[c[b]]={}),d=d[c[b]];return d},EDIBLE.namespace("modules.multiCanvas"),EDIBLE.namespace("modules.multiContext"),EDIBLE.modules.MultiContext=function(){var a=function(){this.contexts=this.canvas.canvases.map(function(a){return a.getContext("2d")}),void 0!==this._fillStyle&&(this.fillStyle=this._fillStyle),void 0!==this._strokeStyle&&(this.strokeStyle=this._strokeStyle),void 0!==this._lineWidth&&(this.lineWidth=this._lineWidth),this._position={ctx:this.contexts[0],x:0,y:0,gx:0,gy:0}},b=function(a,b,c){var d=(this.contexts[c],c*this._maxWidth),e=d+this._maxWidth;return c===this.contexts.length-1&&(e=d+this.canvas.canvases[c].width),a>=d&&e>a?a-d:void 0},c=function(a){return function(b,c,d,e){var f,g,h=!1;for(f=0;f<this.contexts.length;f+=1){if(g=this._pointInContext(b,c,f),rPt=this._pointInContext(b+d,c,f),void 0!==g&&void 0!==rPt){this.contexts[f][a](g,c,d,e);break}if(void 0!==g)this.contexts[f][a](g,c,this._maxWidth-g,e),h=!0;else{if(void 0!==rPt){this.contexts[f][a](0,c,rPt,e);break}h&&this.contexts[f][a](0,c,this._maxWidth,e)}}}},d=function(a){return function(b){var c;if(this["_"+a]=b,b instanceof Array)for(c=0;c<this.contexts.length;c+=1)this.contexts[c][a]=b[c];else for(c=0;c<this.contexts.length;c+=1)this.contexts[c][a]=b;return b}},e=function(a){return function(){return this["_"+a]}},f=function(a){return function(){this.contexts.forEach(function(b){b[a]()})}};MultiContext=function(c,d){this.canvas=c,this._maxWidth=d,this._updateContexts=a.bind(this),this._pointInContext=b.bind(this),this._updateContexts(),this._position={ctx:this.contexts[0],x:0,y:0,gx:0,gy:0}},MultiContext.prototype={constructor:EDIBLE.modules.MultiContext,version:"0.1",createLinearGradient:function(a,b,c,d){var e=[];return e=this.contexts.map(function(e){return e.createLinearGradient(a,b,c,d)}),e.addColorStop=function(a,b){this.map(function(c){c.addColorStop(a,b)})},e}};var g=["save","restore","closePath","beginPath","stroke","fill"];g.forEach(function(a){MultiContext.prototype[a]=f(a)});var h=["clearRect","strokeRect","fillRect","rect"];h.forEach(function(a){MultiContext.prototype[a]=c(a)});var i=function(a,b){var c;for(c=0;c<this.contexts.length;c++)pt=this._pointInContext(a,b,c),void 0!==pt&&(this._position={ctx:this.contexts[c],x:pt,y:b,gx:a,gy:b},this.contexts[c].moveTo(pt,b))},j=function(a,b){var c,d,e=0;for(c=0;c<this.contexts.length;c++){if(d=this.contexts[c],pt=this._pointInContext(a,b,c),void 0!==pt&&d===this._position.ctx){d.lineTo(pt,b),this._position={ctx:d,x:pt,y:b,gx:a,gy:b};break}if(void 0!==pt&&a<this._position.gx){m=(b-this._position.gy)/parseFloat(a-this._position.gx);for(var f=function(c){return m*(c-a)+b},g={ctx:d,x:pt,y:b,gx:a,gy:b};c<this.contexts.indexOf(this._position.ctx);)newY=f(e+this.canvas.canvases[c].width),d.moveTo(this.canvas.canvases[c].width,newY),d.lineTo(pt,b),pt=0,b=newY,e+=this.canvas.canvases[c].width,c+=1,d=this.contexts[c];this._position.ctx.lineTo(pt,b),this._position=g;break}if(void 0!==pt&&a>this._position.gx){console.log("line to the right"),m=(b-this._position.gy)/parseFloat(a-this._position.gx),console.log("slope",m);for(var f=function(c){return m*(c-a)+b},g={ctx:d,x:pt,y:b,gx:a,gy:b};c>this.contexts.indexOf(this._position.ctx);)newY=f(e),console.log("ctx",c,"moveto",0,newY,"lineto",pt,b),d.moveTo(0,newY),d.lineTo(pt,b),pt=this.canvas.canvases[c-1].width,b=newY,e-=this.canvas.canvases[c-1].width,c-=1,d=this.contexts[c];this._position.ctx.lineTo(pt,b),this._position=g;break}e+=this.canvas.canvases[c].width}};MultiContext.prototype.moveTo=i,MultiContext.prototype.lineTo=j;var k=["fillStyle","font","globalAlpha","globalCompositeOperation","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle","textAlign","textBaseline"];return k.forEach(function(a){MultiContext.prototype.__defineSetter__(a,d(a)),MultiContext.prototype.__defineGetter__(a,e(a))}),MultiContext}(),EDIBLE.modules.MultiCanvas=function(){return MultiCanvas=function(a,b){this._maxWidth=void 0!==b?parseFloat(b):3e4,this.canvases=[a],this.mctx=new EDIBLE.modules.MultiContext(this,this._maxWidth)},MultiCanvas.prototype={constructor:EDIBLE.modules.MultiCanvas,version:"0.1",clone:function(a){this.width=a.width,this.height=a.height;var b,c;for(b=0;b<a.canvases.length;b++)c=this.canvases[b].getContext("2d"),c.drawImage(a.canvases[0],0,0,a.canvases[0].width,a.canvases[0].height)},destroy:function(){var a,b=this.canvases[0].parentNode;for(a=0;a<this.canvases.length;a++)b.removeChild(this.canvases[a])},getContext:function(a){if("2d"===a)return this.mctx;throw"Only '2d' contexts are supported."},get height(){return this._height},set height(a){var b;for(b=0;b<this.canvases.length;b++)this.canvases[b].height=a;return this._height=a,a},get width(){return this._width},set width(a){var b,c,d=parseInt(a/this._maxWidth+1),e=this.canvases[0].parentNode;for(b=0;b<this.canvases.length;b+=1)e.removeChild(this.canvases[b]);for(this.canvases=this.canvases.slice(0,1),this.canvases=[],b=0;d>b;b+=1)b>=this.canvases.length&&(c=document.createElement("canvas"),c.height=this._height,c.style.display="inline-block",e.appendChild(c),this.canvases.push(c)),this.canvases[b].width=b===d-1?a-this._maxWidth*(d-1):this._maxWidth;return this._width=a,this.mctx._updateContexts(),a}},MultiCanvas}(),function(a){"use strict";a.widget("edible.wfBase",{_create:function(){console.log("REGISTERING AS NAME",this.widgetName),this.element.data("waveformClass",this.widgetName)},_destroy:function(){this.element.removeData("waveformClass"),this._super("destroy")}})}(jQuery,window,document),$.fn.wf=function(){return this[this.data("waveformClass")].apply(this,arguments)},function(a,b,c,d){"use strict";a.widget("edible.waveform",a.edible.wfBase,{options:{data:[],height:"90px",canvHeight:"75px",topBarHeight:15,dur:1e3,len:1e3,start:0,pxPerMs:.1,name:"audio",filename:"audio.mp3",innerColor:d,fixed:!1,mute:!1,globalVolume:1,_dirty:!0,volume:{x:[0],y:[1]}},width:function(){return this.options.len*this.options.pxPerMs},waveformClass:function(){return"waveform"},isDirty:function(){return this.options._dirty},addVolumeMarker:function(){},exportExtras:function(){return this.options._dirty=!1,{}},debugInfo:function(){return JSON.stringify(this.options,null,4)},slice:function(b){{var d=this.element.offset(),e=b.pageX-d.left,f=c.createElement("div"),g=e/this.options.pxPerMs;a(f)[this.waveformClass](a.extend(!0,{},this.options,{start:this.options.start+g,len:this.options.len-g}))}return this._setOptions({len:e/this.options.pxPerMs}),{waveform:f,pos:e/this.options.pxPerMs}},_computePosFromResize:function(a,b){console.log("ui",b);var c=b.position.left-b.originalPosition.left,d=b.originalPosition.left-this.options.start*this.options.pxPerMs,e=(this.options.dur-this.options.start)*this.options.pxPerMs,f=this.options.start,g=b.size.width/this.options.pxPerMs,h=b.position.left;return 0!==c?(f=this.options.start+c/this.options.pxPerMs,0>f&&(f=0,h=d,g=this.options.len+this.options.start)):b.size.width>e&&(g=this.options.dur-this.options.start),console.log("orig element offset",b.originalElement.offset()),this.element.css("left",h-this.element.parent().offset().left),{len:g,start:f}},_create:function(){this._super("_create");var b,c,d=this,e=a("#waveformTemplate").html();this.element.addClass("edible-waveform").append(_.template(e,this.options)),b=this.element.find(".displayCanvas"),c=this.element.find(".topBar"),this.element.find(".removeWaveform").click(function(a){return d._trigger("destroy"),d._destroy(),a.preventDefault(),!1}),this.options.fixed||this.element.draggable({handle:c,snap2:".track",snap2Mode:"inner",snap2Tolerance:46,snap2Sides:"tb",stack:".edible-waveform"}).resizable({handles:"e, w",stop:function(a,b){var c=d._computePosFromResize(a,b);
console.log("setting new len",c.len,"and start",c.start),d._setOptions(c)},helper:"resizable-helper"}),this.element.disableSelection().css("position","absolute"),this.options._mcanv=new EDIBLE.modules.MultiCanvas(b[0]),this._refresh()},_drawWaveform:function(){var a=this.options.data.length,b=a/this.options.dur,c=this.options.start*b,e=c+this.options.len*b,f=this.options._mcanv,g="#4BF2A7";this.options.innerColor!==d&&f!==d?g=this.options.innerColor(f):g===d&&(g="#4BF2A7",f!==d&&(g=f.getContext("2d").createLinearGradient(0,0,0,parseInt(this.options.canvHeight)),g.addColorStop(0,"#4BF2A7"),g.addColorStop(1,"#32CD32")));new Waveform({canvas:f,data:this.options.data.slice(c,e),innerColor:g,outerColor:"#333",height:this.options.canvHeight,interpolate:!0,width:this.width()})},_refresh:function(){this.options._mcanv.width=this.width(),this.options._mcanv.height=parseInt(this.options.canvHeight),this.element.find(".topBar").css("width",this.width()),this.element.width(this.width()).height(this.options.height),this._drawWaveform()},_destroy:function(){this._super("destroy"),this.element.remove()},_setOptions:function(){this._superApply(arguments),this._refresh(),this._trigger("changed",null,arguments)},_setOption:function(a,b){switch(this.options._dirty=!0,a){case"currentWords":this.options.highlightedWordsRange=d,this.options.currentWords=b;break;case"oogielove":break;default:this.options[a]=b}this._super("_setOption",a,b)}})}(jQuery,window,document),function(a,b,c,d){"use strict";a.widget("edible.textAlignedWaveform",a.edible.waveform,{_create:function(){this._super("_create")},waveformClass:function(){return"textAlignedWaveform"},_drawWaveform:function(){var b,e,f,g,h,i=this,j=this.options.data.length>0,k=this.options.data.length,l=k/this.options.dur,m=this.options.start*l,n=m+this.options.len*l,o=[],p=[],q=0;a.each(this.options.currentWords,function(a,c){if(p.push(q),"gp"===c.alignedWord){for(q+=parseInt(1e3*c.pauseLength),g=[],h=0;h<1e3*c.pauseLength*l;h++)g[h]=0;o.push.apply(o,g)}else b=1e3*c.start,e=1e3*c.end,f=e-b,q+=parseInt(f),j&&(m=parseInt(b*l),n=parseInt(e*l),g=i.options.data.slice(m,n),o.push.apply(o,g))}),this.options.len=q;var r=this.options._mcanv;r.getContext("2d").canvas.width=this.width(),r.getContext("2d").canvas.height=parseInt(this.options.canvHeight),this.element.find(".topBar").css("width",this.width());var s="#4BF2A7";r!==d&&(s=r.getContext("2d").createLinearGradient(0,0,0,parseInt(this.options.canvHeight)),s.addColorStop(0,"#333"),s.addColorStop(1,"#777")),j||(o=[]);var t="#FF7F24";r!==d&&(t=r.getContext("2d").createLinearGradient(0,0,0,parseInt(this.options.canvHeight)),t.addColorStop(0,"#FF7F24"),t.addColorStop(1,"#FA9A50"));var u=s;if("highlightedWordsRange"in this.options&&this.options.highlightedWordsRange!==d){var v,w=this.options.highlightedWordsRange,x=this.options.pxPerMs,y=p[w[0]]*x;v=w[1]+1>=p.length?i.width():p[w[1]+1]*x,u=function(a){var b=a*i.width();return b>=y&&v>b?t:s}}var z=(new Waveform({canvas:r,data:o,innerColor:u,outerColor:"#eee",height:this.options.canvHeight,interpolate:!0,width:this.width()}),function(a,b,c){c.save(),c.fillStyle="red",c.strokeStyle="#cccccc",c.beginPath(),c.moveTo(a-5,b-15),c.lineTo(a-5,b-5),c.lineTo(a,b),c.lineTo(a+5,b-5),c.lineTo(a+5,b-15),c.lineTo(a-5,b-15),c.closePath(),c.fill(),c.stroke()}),A=function(b,d,e,f){var g=c.createElement("div");return a(g).addClass("emphasisPointBox").width(e).height(f).css({left:b,top:d}).appendTo(i.element)};a(this.element).find(".emphasisPointBox").remove(),a.each(this.options.currentWords,function(b,c){if(c.hasOwnProperty("emphasisPoint")&&c.emphasisPoint){var d=p[b+1]*i.options.pxPerMs,e=20;z(d,e,r.getContext("2d"));var f=A(d-5,e,10,15);f.data("wordIndex",b),f.click(function(){i.options.emphasisPointFunc(a(this).data("wordIndex"))})}})}})}(jQuery,window,document),function(){function a(a){throw a}function b(a){return function(){return a}}function c(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function d(a){return a!==Vb}function e(a){return a!=Xb}function f(a){return"array"==c(a)}function g(a){var b=c(a);return"array"==b||"object"==b&&"number"==typeof a.length}function h(a){return"string"==typeof a}function i(a){return"boolean"==typeof a}function j(a){var b=typeof a;return"object"==b&&a!=Xb||"function"==b}function k(a,b){var c=a.split("."),e=Zb;!(c[0]in e)&&e.execScript&&e.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&d(b)?e[f]=b:e=e[f]?e[f]:e[f]={}}function l(a,b){function c(){}c.prototype=b.prototype,a.Va=b.prototype,a.prototype=new c,a.prototype.constructor=a}function m(){return ac.concat.apply(ac,arguments)}function n(a){var b=a.length;if(b>0){for(var c=Array(b),d=0;b>d;d++)c[d]=a[d];return c}return[]}function o(a,b,c){return 2>=arguments.length?ac.slice.call(a,b):ac.slice.call(a,b,c)}function p(a,b,c){if(!g(a)||!g(b)||a.length!=b.length)return Yb;var d=a.length;c=c||r;for(var e=0;d>e;e++)if(!c(a[e],b[e]))return Yb;return Wb}function q(a,b){return a>b?1:b>a?-1:0}function r(a,b){return a===b}function s(){if(!arguments.length)return[];for(var a=[],b=0;;b++){for(var c=[],d=0;d<arguments.length;d++){var e=arguments[d];if(b>=e.length)return a;c.push(e[b])}a.push(c)}}function t(){}function u(b){if(b instanceof t)return b;if("function"==typeof b.t)return b.t(Yb);if(g(b)){var c=0,d=new t;return d.next=function(){for(;;){if(c>=b.length&&a(fc),c in b)return b[c++];c++}},d}a(Error("Not implemented"))}function v(b,c,d){if(g(b))try{cc(b,c,d)}catch(e){e!==fc&&a(e)}else{b=u(b);try{for(;;)c.call(d,b.next(),Vb,b)}catch(f){f!==fc&&a(f)}}}function w(a,b,c){var d=u(a);return a=new t,a.next=function(){for(;;){var a=d.next();return b.call(c,a,Vb,d)}},a}function x(a){if(g(a))return n(a);a=u(a);var b=[];return v(a,function(a){b.push(a)}),b}function y(b,c){try{return u(b).next()}catch(d){return d!=fc&&a(d),c}}function z(){}function A(a){if(!g(a))return Yb;for(var b=0,c=a.length;c>b;b++)if(window.isNaN(a[b]))return Yb;return Wb}function B(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function C(a,b,c){var d,e={};for(d in a)e[d]=b.call(c,a[d],d,a);return e}function D(a){var b,c=0;for(b in a)c++;return c}function E(a){for(var b in a)return b}function F(a){var b,c=[],d=0;for(b in a)c[d++]=a[b];return c}function G(a){var b,c=[],d=0;for(b in a)c[d++]=b;return c}function H(a){for(var b in a)delete a[b]}function I(a,b){b in a&&delete a[b]}function J(a,b,c){return b in a?a[b]:c}function K(a){var b,c={};for(b in a)c[b]=a[b];return c}function L(a){for(var b,c,d=1;d<arguments.length;d++){c=arguments[d];for(b in c)a[b]=c[b];for(var e=0;e<hc.length;e++)b=hc[e],Object.prototype.hasOwnProperty.call(c,b)&&(a[b]=c[b])}}function M(){var b=arguments.length;if(1==b&&f(arguments[0]))return M.apply(Xb,arguments[0]);b%2&&a(Error("Uneven number of arguments"));for(var c={},d=0;b>d;d+=2)c[arguments[d]]=arguments[d+1];return c}function N(a){if("function"==typeof a.w)return a.w();if(h(a))return a.split("");if(g(a)){for(var b=[],c=a.length,d=0;c>d;d++)b.push(a[d]);return b}return F(a)}function O(b){this.e={},this.g=[];var c=arguments.length;if(c>1){c%2&&a(Error("Uneven number of arguments"));for(var d=0;c>d;d+=2)this.set(arguments[d],arguments[d+1])}else b&&this.W(b)}function P(a){if(a.u!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];Object.prototype.hasOwnProperty.call(a.e,d)&&(a.g[c++]=d),b++}a.g.length=c}if(a.u!=a.g.length){for(var e={},c=b=0;b<a.g.length;)d=a.g[b],Object.prototype.hasOwnProperty.call(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}function Q(a){this.e=new O,a&&this.W(a)}function R(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+(a[$b]||(a[$b]=++_b)):b.substr(0,1)+a}function S(a,b){for(var c=new Q,d=N(b),e=0;e<d.length;e++){var f=d[e];a.contains(f)&&c.add(f)}return c}function T(a,b){for(var c=a.R(),d=N(b),e=d.length,f=0;e>f;f++)c.remove(d[f]);return c}function U(b){if(b!=Xb)try{b.clear()}catch(c){a(Error("Input graph is not a jsnx graph type"))}else b=new gc.Ba;return b}function V(b,d,e){var f;if(b.hasOwnProperty("adj"))try{return f=W(b.adj,d,b.f()),"graph"in b&&"object"===c(b.graph)&&(f.graph=K(b.graph)),"node"in b&&"object"===c(b.node)&&(f.node=C(b.node,function(a){return K(a)})),f}catch(h){a(Error("Input is not a correct jsnx graph"))}if("object"===c(b))try{return W(b,d,e)}catch(i){try{var j=U(d);if(j.i(b),j.f()&&!j.d()){var k={};B(b,function(a,b){cc(a,function(a){a in k||j.h(b,a)}),k[b]=1})}else{var l=[];B(b,function(a,b){cc(a,function(a){l.push([b,a])})}),j.a(l)}return j}catch(m){a(Error("Input is not known type."))}}if(g(b))try{var n=U(d);return n.a(b),n}catch(o){a(Error("Input is not valid edge list"))}}function W(b,c,d){var e,f,h=U(c);return h.i(b),d?h.d()?(h.f()?(e=[],B(b,function(b,c){g(b)&&a(Error()),B(b,function(a,b){B(a,function(a,d){e.push([c,b,d,a])})})})):(e=[],B(b,function(b,c){g(b)&&a(Error()),B(b,function(a,b){B(a,function(a){e.push([c,b,a])})})})),h.a(e)):h.f()?(f=new Q,B(b,function(b,c){g(b)&&a(Error()),B(b,function(a,b){f.contains([c,b].toString())||(e=[],B(a,function(a,d){e.push([c,b,d,a])}),h.a(e),f.add([b,c].toString()))})})):(f=new Q,B(b,function(b,c){g(b)&&a(Error()),B(b,function(a,b){f.contains([c,b].toString())||(e=[],B(a,function(a){e.push([c,b,a])}),h.a(e),f.add([b,c].toString()))})})):h.f()&&!h.d()?(f=new Q,B(b,function(b,c){g(b)&&a(Error()),B(b,function(a,b){f.contains([c,b].toString())||(h.h(c,b,a),f.add([b,c].toString()))})})):(e=[],B(b,function(b,c){g(b)&&a(Error()),B(b,function(a,b){e.push([c,b,a])})}),h.a(e)),h}function X(a){this.name="JSNetworkXException",this.message=a}function Y(a){X.call(this,a),this.name="JSNetworkXError"}function Z(a){X.call(this,a),this.name="JSNetworkXPointlessConcept"}function $(a){X.call(this,a),this.name="JSNetworkXAlgorithmError"}function _(a){$.call(this,a),this.name="JSNetworkXUnfeasible"}function ab(a){_.call(this,a),this.name="JSNetworkXNoPath"}function bb(a){$.call(this,a),this.name="JSNetworkXUnbounded"}function cb(a){function b(a,b){return a[b[0]]=b[1],a}a=ob(a);var c={};return v(a,function(a){c=b.call(Vb,c,a)}),c}function db(a){return a instanceof t||"function"==c(a.t)}function eb(b){return h(b)||g(b)||"length"in b?b.length:qb(b)?D(b):void a(new TypeError)}function fb(a,b,c,d){if(i(c)&&(d=c,c=Xb),d){var e=b;b=function(a){e.apply(this,a)}}db(a)?v(a,b,c):g(a)||h(a)?cc(a,b,c):j(a)&&fb(G(a),b,c)}function gb(b,c,d){return g(b)?ec(b,c,d):db(b)?w(b,c,d):j(b)?C(b,c,d):void a(new TypeError)}function hb(){var b=arguments,c=b[0];if(g(c))return s.apply(Xb,b);if(db(c)){var c=new t,d=b.length;return c.next=function(){for(var a=[],c=0;d>c;c++)a.push(b[c].next());return a},c}return j(c)?s.apply(Xb,ec(b,G)):void a(new TypeError)}function ib(b,c,d){if(0===arguments.length)return[];1===arguments.length?(c=b,b=0,d=1):2===arguments.length?d=1:3===arguments.length&&0===arguments[2]&&a("range() step argument must not be zero");var e,f=new t,g=0>d,h=b;return f.next=function(){return(g&&c>=h||!g&&h>=c)&&a(fc),e=h,h+=d,e},f}function jb(b){var c=lb(b),d=c.length;if(2>d)return new t;var e=lb(ib(2));return b=new t,b.next=function(){var b=ec(e,function(a){return c[a]});return this.next=function(){var b,f=Yb;for(b=2;b--;)if(e[b]!=b+d-2){f=Wb;break}for(f||a(fc),e[b]+=1,f=b+1;2>f;f++)e[f]=e[f-1]+1;return ec(e,function(a){return c[a]})},b},b}function kb(b){var c=lb(b),d=c.length;if(2>d)return new t;var e=lb(ib(d)),f=lb(ib(d,d-2,-1));b=new t;var g,h=new t,i=Wb;return b.next=function(){return this.next=g.next,ec(e.slice(0,2),function(a){return c[a]})},h.next=function(){return i},g=pb(h,function(b){return b||a(fc),i=Yb,ib(1,-1,-1)},function(a){if(!i){if(f[a]-=1,0!==f[a]){var b=f[a],g=e[a];return e[a]=e[e.length-b],e[e.length-b]=g,i=Wb,ob([ec(e.slice(0,2),function(a){return c[a]})])}e.splice.apply(e,[a,e.length].concat(e.slice(a+1).concat([e[a]]))),f[a]=d-a}},function(a){return a}),b}function lb(b){return g(b)?n(b):db(b)?x(b):j(b)?G(b):void a(new TypeError)}function mb(a){var b=[];return B(a,function(a,c){b.push([c,a])}),b}function nb(a){var b=new t,c=u(G(a));return b.next=function(){var b=c.next();return[b,a[b]]},b}function ob(a){return"object"===c(a)&&!g(a)&&!db(a)&&(a=G(a)),u(a)}function pb(b){var c=new t,e=o(arguments,1);if(0===e.length)return b;try{b=u(b)}catch(f){return c.next=function(){"Not implemented"===f.message&&a(new TypeError)},c}var g=Xb;return c.next=function(){var a,f;try{for(;!d(a);)a=g.next()}catch(h){for(;!d(f)||!d(a);)f=b.next(),a=e[0](f);if(db(a))return g=pb.apply(Xb,m([a],o(e,1))),c.next();g=Xb}return a},c}function qb(a){var b=Object.prototype.hasOwnProperty;if(!a||"object"!==c(a)||a.nodeType||a==a.window)return Yb;try{if(a.constructor&&!b.call(a,"constructor")&&!b.call(a.constructor.prototype,"isPrototypeOf"))return Yb}catch(d){return Yb}for(var e in a);return e===Vb||b.call(a,e)}function rb(a,b){b=b||[];var d=c(a);if("object"==d&&qb(a)||"array"==d){var e;e=b;var f;a:{f=function(b){return a===b[0]};for(var g=e.length,i=h(e)?e.split(""):e,j=0;g>j;j++)if(j in i&&f.call(Vb,i[j])){f=j;break a}f=-1}if(e=0>f?Xb:h(e)?e.charAt(f):e[f],e!==Xb)return e[1];if(a.R)return e=[a,a.R()],b.push(e),e[1];d="array"==d?[]:{},e=[a,d],b.push(e);for(var k in a)d[k]=rb(a[k],b);return d}return a}function sb(a){function b(){}var c,d={};b.prototype=a.constructor.prototype;for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);d=rb(d),a=new b;for(c in d)a[c]=d[c];return a}function tb(a){var b=[];return vb(new ub,a,b),b.join("")}function ub(){this.V=Vb}function vb(b,c,d){switch(typeof c){case"string":wb(c,d);break;case"number":d.push(isFinite(c)&&!isNaN(c)?c:"null");break;case"boolean":d.push(c);break;case"undefined":d.push("null");break;case"object":if(c==Xb){d.push("null");break}if(f(c)){var e=c.length;d.push("[");for(var g="",h=0;e>h;h++)d.push(g),g=c[h],vb(b,b.V?b.V.call(c,String(h),g):g,d),g=",";d.push("]");break}d.push("{"),e="";for(h in c)Object.prototype.hasOwnProperty.call(c,h)&&(g=c[h],"function"!=typeof g&&(d.push(e),wb(h,d),d.push(":"),vb(b,b.V?b.V.call(c,h,g):g,d),e=","));d.push("}");break;case"function":break;default:a(Error("Unknown type: "+typeof c))}}function wb(a,b){b.push('"',a.replace(jc,function(a){if(a in ic)return ic[a];var b=a.charCodeAt(0),c="\\u";return 16>b?c+="000":256>b?c+="00":4096>b&&(c+="0"),ic[a]=c+b.toString(16)}),'"')}function xb(a,b){return this instanceof xb?(this.graph={},this.node={},this.adj={},a!=Xb&&V(a,this),L(this.graph,b||{}),void(this.edge=this.adj)):new xb(a,b)}function yb(a,b){return this instanceof yb?(this.graph={},this.node={},this.adj={},this.pred={},this.succ=this.adj,a!=Xb&&V(a,this),L(this.graph,b||{}),void(this.edge=this.adj)):new yb(a,b)}function zb(a,b){return this instanceof zb?void xb.call(this,a,b):new zb(a,b)}function Ab(a,b){return this instanceof Ab?void yb.call(this,a,b):new Ab(a,b)}function Bb(a,b){var c={};return B(a.Z,function(a,d){b in a&&(c[d]=a[b])}),c}function Cb(b,c){if(b.d()&&a(new Y("triangles() is not defined for directed graphs.")),b.q(c))return Math.floor(Db(b,c).next()[2]/2);var d={};return v(Db(b,c),function(a){d[a[0]]=Math.floor(a[2]/2)}),d}function Db(b,c){b.f()&&a(new Y("Not defined for multigraphs."));var d;return d=c!=Xb?pb(b.b(c),function(a){return[a,b.k(a)]}):nb(b.adj),w(d,function(a){var c=new Q(G(a[1])),d=0;return c.remove(a[0]),v(c,function(a){var e=new Q(G(b.k(a)));e.remove(a),d+=S(c,e).c()}),[a[0],c.c(),d]})}function Eb(b,e,f){if(b.d()&&a(new Y("Clustering algorithms are not defined for directed graphs.")),f!=Xb){var g=f;b.f()&&a(new Y("Not defined for multigraphs.")),d(g)||(g="weight");var h;if(0===b.p().length)f=1;else{f=b.p(Wb);var i=function(a){return J(a[2],g,1)};f="function"==c(i)?gb(f,function(){return i.apply(Xb,arguments)}):lb(f),f=Math.max.apply(Xb,f)}h=f,f=e!=Xb?pb(b.b(e),function(a){return[a,b.k(a)]}):nb(b.adj),f=w(f,function(a){var c=a[0],d=new Q(G(a[1]));d.remove(c);var e=0,f=new Q;return v(d,function(a){var i=J(b.k(c)[a],g,1)/h;f.add(a);var j=T(new Q(G(b.k(a))),f);v(S(d,j),function(d){var f=J(b.k(a)[d],g,1)/h;d=J(b.k(c)[d],g,1)/h,e+=Math.pow(i*f*d,1/3)})}),[c,d.c(),2*e]})}else f=Db(b,e);var j={};return v(f,function(a){j[a[0]]=0===a[2]?0:a[2]/(a[1]*(a[1]-1))}),b.q(e)?F(j)[0]:j}function Fb(b){var c=-1,d={},e=new Q;v(b.o(),function(a){var b=new Q(G(a[1]));b.remove(a[0]);var f=b.c();f>c?(d[a[0]]=e=b,c=f):d[a[0]]=b});var f=new Q(G(d)),g=T(f,e),h=new Q,i=[],j=[];return b=new t,b.next=function(){0===g.c()&&0===i.length&&a(fc);var b,k;if(!(0<g.c())){var l=i.pop();return f=l[0],h=l[1],g=l[2],j.pop(),this.next()}b=y(g),g.remove(b),j.push(b),f.remove(b),h.add(b);var o=d[b],l=S(f,o),o=S(h,o);if(0===l.c()&&(0===o.c()&&(k=n(j)),j.pop(),k))return k;if(0===o.c()&&1===l.c())return k=m(j,l.w()),j.pop(),k;var p,q,r=l.c(),s=-1;for(k=u(o);(b=y(k,Xb))!==Xb&&(b=S(l,d[b]),q=b.c(),!(q>s&&(p=b,s=q,s===r))););if(s===r)return j.pop(),this.next();for(c=-1,k=u(l);(b=y(k,Xb))!==Xb&&(b=S(l,d[b]),q=b.c(),!(q>c&&(e=b,c=q,c===r-1))););return s>c&&(e=p),i.push([f,h,g]),f=l,h=o,g=T(f,e),this.next()},b}function Gb(a,b,c,d,e){var f,g,h,i,j=-1,k=b.c();for(g=u(c);(h=y(g,Xb))!==Xb;)if(h=S(b,a[h]),i=h.c(),i>j&&(f=h,j=i,i===k))return;v(b,function(c){c=S(b,a[c]);var d=c.c();d>j&&(f=c,j=d)}),k=T(b,f),v(k,function(f){b.remove(f),d.push(f);var g=a[f];f=S(b,g),g=S(c,g),f.J()&&g.J()?e.push(n(d)):g.J()&&1===f.c()?e.push(m(d,f.w())):Gb(a,f,g,d,e),c.add(d.pop())})}function Hb(a,b,c){c!=Xb||(c=x(Fb(a))),b!=Xb||(b=a.z());var d;if(f(b))d={},cc(b,function(a){d[a]=dc(c,function(b){return 0<=bc(b,a)||0<=bc(b,a+"")}).length});else{var e=b;d=dc(c,function(a){return 0<=bc(a,e)||0<=bc(a,e+"")}).length}return d}function Ib(a,b){if(a.v()!=b.v())return Yb;var c,d=a.l(),e=Cb(a),f=Hb(a),g=[];for(c in d)g.push([d[c],e[c],f[c]]);g.sort(function(a,b){return a[0]!==b[0]?a[0]-b[0]:a[1]!==b[1]?a[1]-b[1]:a[2]-b[2]});var d=b.l(),e=Cb(b),f=Hb(b),h=[];for(c in d)h.push([d[c],e[c],f[c]]);return h.sort(function(a,b){return a[0]!==b[0]?a[0]-b[0]:a[1]!==b[1]?a[1]-b[1]:a[2]-b[2]}),p(g,h,function(a,b){return p(a,b)})?Wb:Yb}function Jb(a,b){if(a.v()!=b.v())return Yb;var c,d=a.l(),e=Cb(a),f=[];for(c in d)f.push([d[c],e[c]]);f.sort(function(a,b){return a[0]!==b[0]?a[0]-b[0]:a[1]-b[1]});var d=b.l(),e=Cb(b),g=[];for(c in d)g.push([d[c],e[c]]);return g.sort(function(a,b){return a[0]!==b[0]?a[0]-b[0]:a[1]-b[1]}),p(f,g,function(a,b){return p(a,b)})?Wb:Yb}function Kb(a,b){if(a.v()!=b.v())return Yb;var c=F(a.l());c.sort();var d=F(b.l());return d.sort(),p(c,d)?Wb:Yb}function Lb(b,c){return"eg"===c?Nb(b):c==Xb||"hh"===c?Mb(b):void a(new X("`opt_method` must be 'eg' or 'hh'"))}function Mb(a){if(0===a.length)return Wb;if(!A(a)||0>Math.min.apply(Xb,a)||0!==kc.n.apply(Xb,a)%2)return Yb;for(a=n(a);0<a.length&&(ac.sort.call(a,q),!(0>a[0]));){var b=a.pop();if(0===b)return Wb;if(b>a.length)break;for(var c=a.length-1,b=a.length-(b+1);c>b;c--)a[c]-=1}return Yb}function Nb(a){if(0===a.length)return Wb;if(!A(a)||0>Math.min.apply(Xb,a)||0!==kc.n.apply(Xb,a)%2)return Yb;var b,c=a.length,d=n(a).sort(function(a,b){return b-a}),e=[];for(b=1,a=d.length;a>b;b++)d[b]<d[b-1]&&e.push(b);var f,g;for(b=0,a=e.length;a>b;b++)if(f=kc.n.apply(Xb,d.slice(0,e[b])),g=e[b]*(e[b]-1)+kc.n.apply(Xb,x(w(ib(e[b],c),function(a){return Math.min(e[b],d[a])}))),f>g)return Yb;return Wb}function Ob(a){var b={},c={},d=new Q,e=[],f=[],g=0,h=Yb;return v(a.K(),function(i){var j,k,l,m;if(!d.contains(i))for(m=[i];0<m.length;){i=m[m.length-1],i in b||(g+=1,b[i]=g),h=Wb,j=a.C(i);for(l=0;l<j.length;l++)if(k=j[l],!(k in b)){m.push(k),h=Yb;break}if(h){for(c[i]=b[i],l=0;l<j.length;l++)k=j[l],d.contains(k)||(c[i]=b[k]>b[i]?Math.min(c[i],c[k]):Math.min(c[i],b[k]));if(m.pop(),c[i]===b[i]){for(d.add(i),j=[i];0<e.length&&b[e[e.length-1]]>b[i];)k=e.pop(),d.add(k),j.push(k);f.push(j)}else e.push(i)}}}),f.sort(function(a,b){return b.length-a.length}),f}function Pb(a,b){var c=Qb(a,b);return c.name("complete_graph("+a+")"),a>1&&c.a(c.d()?kb(ib(a)):jb(ib(a))),c}function Qb(a,b){a instanceof xb&&(b=a,a=Xb),a!=Xb||(a=0);var c;return b!=Xb?(c=b,c.clear()):c=new xb,c.i(ib(a)),c.name("empty_graph("+a+")"),c}function Rb(a,b){var c=Qb(a,b);return c.name("path_graph("+a+")"),c.a(w(ib(a-1),function(a){return[a,a+1]})),c}function Sb(a,b,c){var d;return d=c?yb():xb(),d.i(ib(a)),d.name("gnp_random_graph("+a+","+b+")"),0>=b?d:b>=1?Pb(a,d):(a=d.d()?kb(ib(a)):jb(ib(a)),v(a,function(a){Math.random()<b&&d.h(a[0],a[1])}),d)}function Tb(b,e,f){var g=e;"function"==c(e)&&(g={},v(b.K(),function(a){g[a]=e(a)}));var h;if(!d(f)||f){var i=g,j=new b.constructor;j.name("("+b.name()+")"),j.a(b.f()?w(b.j(Wb,Wb),function(a){return[J(i,a[0],a[0]),J(i,a[1],a[1]),a[2],K(a[3])]}):w(b.j(Wb),function(a){return[J(i,a[0],a[0]),J(i,a[1],a[1]),K(a[2])]})),j.i(w(b,function(a){return J(i,a,a)})),f={};for(h in b.node)f[J(i,h,h)]=K(b.node[h]);L(j.node,f),L(j.graph,K(b.graph)),h=j}else{var k=g;if(h=new Q(G(k)),0<S(h,k).c()){h=yb(mb(k)),h.A(h.O());try{j=oc.Ja.Xa(h)}catch(l){l instanceof _&&a(new _("The node label sets are overlapping and no ordering can resolve the mapping. Use copy=True."))}j.reverse()}else j=h;var n,o=b.f(),p=b.d();v(j,function(c){var d;c in k&&(d=k[c],b.q(c)||a(new Y("Node "+c+" is not in the graph.")),b.F(d,b.node[c]),o?(n=ec(b.p(c,Wb,Wb),function(a){return[d,a[1],a[2],a[3]]}),p&&(n=m(n,ec(b.H(c,Wb,Wb),function(a){return[a[0],d,a[2],a[3]]})))):(n=ec(b.p(c,Wb),function(a){return[d,a[1],a[2]]}),p&&(n=m(n,ec(b.H(c,Wb),function(a){return[a[0],d,a[2]]})))),b.N(c),b.a(n))}),h=b}return h}var Ub,Vb=void 0,Wb=!0,Xb=null,Yb=!1,Zb=this,$b="closure_uid_"+(1e9*Math.random()>>>0),_b=0,ac=Array.prototype,bc=ac.indexOf?function(a,b,c){return ac.indexOf.call(a,b,c)}:function(a,b,c){if(c=c==Xb?0:0>c?Math.max(0,a.length+c):c,h(a))return h(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},cc=ac.forEach?function(a,b,c){ac.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=h(a)?a.split(""):a,f=0;d>f;f++)f in e&&b.call(c,e[f],f,a)},dc=ac.filter?function(a,b,c){return ac.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=h(a)?a.split(""):a,i=0;d>i;i++)if(i in g){var j=g[i];b.call(c,j,i,a)&&(e[f++]=j)}return e},ec=ac.map?function(a,b,c){return ac.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=h(a)?a.split(""):a,g=0;d>g;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},fc="StopIteration"in Zb?Zb.StopIteration:Error("StopIteration");t.prototype.next=function(){a(fc)},t.prototype.t=function(){return this},z.ca=function(){return z.ea?z.ea:z.ea=new z},z.prototype.va=0,z.ca();var gc={};k("jsnx.utils.is_list_of_ints",A),k("jsnx.utils.cumulative_sum",function(a){var b=0;return w(a,function(a){return b+=a})}),k("jsnx.utils.generate_unique_node",function(){return":"+(z.ca().va++).toString(36)});var hc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");Ub=O.prototype,Ub.u=0,Ub.Q=0,Ub.c=function(){return this.u},Ub.w=function(){P(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.e[this.g[b]]);return a},Ub.J=function(){return 0==this.u},Ub.clear=function(){this.e={},this.Q=this.u=this.g.length=0},Ub.remove=function(a){return Object.prototype.hasOwnProperty.call(this.e,a)?(delete this.e[a],this.u--,this.Q++,this.g.length>2*this.u&&P(this),Wb):Yb},Ub.set=function(a,b){Object.prototype.hasOwnProperty.call(this.e,a)||(this.u++,this.g.push(a),this.Q++),this.e[a]=b},Ub.W=function(a){var b;a instanceof O?(P(a),b=a.g.concat(),a=a.w()):(b=G(a),a=F(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])},Ub.R=function(){return new O(this)},Ub.t=function(b){P(this);var c=0,d=this.g,e=this.e,f=this.Q,g=this,h=new t;return h.next=function(){for(;;){f!=g.Q&&a(Error("The map has changed since the iterator was created")),c>=d.length&&a(fc);var h=d[c++];return b?h:e[h]}},h},Ub=Q.prototype,Ub.c=function(){return this.e.c()},Ub.add=function(a){this.e.set(R(a),a)},Ub.W=function(a){a=N(a);for(var b=a.length,c=0;b>c;c++)this.add(a[c])},Ub.remove=function(a){return this.e.remove(R(a))},Ub.clear=function(){this.e.clear()},Ub.J=function(){return this.e.J()},Ub.contains=function(a){return a=R(a),Object.prototype.hasOwnProperty.call(this.e.e,a)},Ub.w=function(){return this.e.w()},Ub.R=function(){return new Q(this)},Ub.t=function(){return this.e.t(Yb)},k("jsnx.to_networkx_graph",V),k("jsnx.convert_to_undirected",gc.Ia),k("jsnx.convert_to_undirected",gc.Ha),k("jsnx.to_dict_of_lists",gc.Wa),X.prototype=Error(),X.prototype.constructor=X,k("jsnx.JSNetworkXException",X),l(Y,X),k("jsnx.JSNetworkXError",Y),l(Z,X),k("jsnx.JSNetworkXPointlessConcept",Z),l($,X),k("jsnx.JSNetworkXAlgorithmError",$),l(_,$),k("jsnx.JSNetworkXUnfeasible",_),l(ab,_),k("jsnx.JSNetworkXNoPath",ab),l(bb,$),k("jsnx.JSNetworkXUnbounded",bb),k("jsnx.forEach",fb),k("jsnx.toArray",lb),k("jsnx.sentinelIterator",function(a,b){var c=new t;return c.next=function(){return y(a,b)},c});var ic={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\u000b"},jc=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,kc={Qa:function(a){return Math.floor(Math.random()*a)},Ya:function(a,b){return a+Math.random()*(b-a)},Ga:function(a,b,c){return Math.min(Math.max(a,b),c)},ua:function(a,b){var c=a%b;return 0>c*b?c+b:c},Na:function(a,b,c){return a+c*(b-a)},Pa:function(a,b,c){return Math.abs(a-b)<=(c||1e-6)},aa:function(a){return kc.ua(a,360)},ha:function(a){return a*Math.PI/180},Aa:function(a){return 180*a/Math.PI},Ea:function(a,b){return b*Math.cos(kc.ha(a))},Fa:function(a,b){return b*Math.sin(kc.ha(a))},Ca:function(a,b,c,d){return kc.aa(kc.Aa(Math.atan2(d-b,c-a)))},Da:function(a,b){var c=kc.aa(b)-kc.aa(a);return c>180?c-=360:-180>=c&&(c=360+c),c},Ta:function(a){return 0==a?0:0>a?-1:1},Oa:function(a,b,c,d){c=c||function(a,b){return a==b},d=d||function(b){return a[b]};for(var e=a.length,f=b.length,g=[],h=0;e+1>h;h++)g[h]=[],g[h][0]=0;for(var i=0;f+1>i;i++)g[0][i]=0;for(h=1;e>=h;h++)for(i=1;e>=i;i++)g[h][i]=c(a[h-1],b[i-1])?g[h-1][i-1]+1:Math.max(g[h-1][i],g[h][i-1]);for(var j=[],h=e,i=f;h>0&&i>0;)c(a[h-1],b[i-1])?(j.unshift(d(h-1,i-1)),h--,i--):g[h-1][i]>g[h][i-1]?h--:i--;return j},n:function(){var a;a=arguments;var b=function(a,b){return a+b};if(a.reduce)a=a.reduce(b,0);else{var c=0;cc(a,function(a){c=b.call(Vb,c,a)}),a=c}return a},oa:function(){return kc.n.apply(Xb,arguments)/arguments.length},Ua:function(){var a=arguments.length;if(2>a)return 0;var b=kc.oa.apply(Xb,arguments),a=kc.n.apply(Xb,ec(arguments,function(a){return Math.pow(a-b,2)}))/(a-1);return Math.sqrt(a)},Ma:function(a){return isFinite(a)&&0==a%1},La:function(a){return isFinite(a)&&!isNaN(a)},Sa:function(a,b){return Math.floor(a+(b||2e-15))},Ra:function(a,b){return Math.ceil(a-(b||2e-15))}};k("jsnx.classes.Graph",xb),k("jsnx.Graph",xb),xb.__name__="Graph",xb.prototype.ra=Xb,xb.prototype.graph=xb.prototype.ra,xb.prototype.Z=Xb,xb.prototype.node=xb.prototype.Z,xb.prototype.ma=Xb,xb.prototype.adj=xb.prototype.ma,xb.prototype.pa=Xb,xb.prototype.edge=xb.prototype.pa,xb.prototype.name=function(a){return d(a)?void(this.graph.name=a.toString()):this.graph.name||""},xb.prototype.name=xb.prototype.name,xb.prototype.toString=function(){return this.name()},xb.prototype.toString=xb.prototype.toString,xb.prototype.t=function(){return ob(this.adj)},xb.prototype.__iterator__=xb.prototype.t,xb.prototype.k=function(b){return b in this.adj||a({name:"KeyError",message:"Graph does not contain node "+b+"."}),this.adj[b]},xb.prototype.get_node=xb.prototype.k,xb.prototype.F=function(b,d){d!=Xb||(d={}),"object"!==c(d)&&a(new Y("The attr_dict argument must be an object.")),b in this.adj?L(this.node[b],d||{}):(this.adj[b]={},this.node[b]=d||{})},xb.prototype.add_node=xb.prototype.F,xb.prototype.i=function(a,b){var c,d,e,g,h;b=b||{},fb(a,function(a){c=!(a in this.adj),f(a)?(d=a[0],e=a[1],d in this.adj?(h=this.node[d],L(h,b,e)):(this.adj[d]={},g=K(b),L(g,e),this.node[d]=g)):c?(this.adj[a]={},this.node[a]=K(b)):L(this.node[a],b)},this)},xb.prototype.add_nodes_from=xb.prototype.i,xb.prototype.N=function(b){var c,d=this.adj;b in this.node||a(new Y("The node "+b+" is not in the graph")),c=G(d[b]),I(this.node,b),cc(c,function(a){I(d[a],b)}),I(d,b)},xb.prototype.remove_node=xb.prototype.N,xb.prototype.U=function(a){var b=this.adj;fb(a,function(a){try{I(this.node,a),B(b[a],function(c,d){I(b[d],a)}),I(b,a)}catch(c){}},this)},xb.prototype.remove_nodes_from=xb.prototype.U,xb.prototype.K=function(a){return a?nb(this.node):ob(G(this.adj))},xb.prototype.nodes_iter=xb.prototype.K,xb.prototype.z=function(a){return x(this.K(a))},xb.prototype.nodes=xb.prototype.z,xb.prototype.L=function(){return D(this.adj)},xb.prototype.number_of_nodes=xb.prototype.L,xb.prototype.v=function(){return D(this.adj)},xb.prototype.order=xb.prototype.v,xb.prototype.q=function(a){return!f(a)&&a in this.adj},xb.prototype.has_node=xb.prototype.q,xb.prototype.h=function(b,d,e){e=e||{},"object"!==c(e)&&a(new Y("The attr_dict argument must be an object.")),b in this.adj||(this.adj[b]={},this.node[b]={}),d in this.adj||(this.adj[d]={},this.node[d]={});var f=J(this.adj[b],d,{});L(f,e),this.adj[b][d]=f,this.adj[d][b]=f},xb.prototype.add_edge=xb.prototype.h,xb.prototype.a=function(b,d){d=d||{},"object"!==c(d)&&a(new Y("The attr_dict argument must be an object.")),fb(b,function(b){var c,e,f,g=eb(b);3===g?(c=b[0],e=b[1],f=b[2]):2===g?(c=b[0],e=b[1],f={}):a(new Y("Edge tuple "+b.toString()+" must be a 2-tuple or 3-tuple.")),c in this.adj||(this.adj[c]={},this.node[c]={}),e in this.adj||(this.adj[e]={},this.node[e]={}),b=J(this.adj[c],e,{}),L(b,d,f),this.adj[c][e]=b,this.adj[e][c]=b},this)},xb.prototype.add_edges_from=xb.prototype.a,xb.prototype.la=function(b,c,e){e=e||{},h(c)||(e=c,c="weight"),this.a(gb(b,function(b){var e={};return e[c]=b[2],d(e[c])||a(new TypeError("Values must consist of three elements: "+tb(b))),[b[0],b[1],e]}),e)},xb.prototype.add_weighted_edges_from=xb.prototype.la,xb.prototype.s=function(b,c){try{I(this.adj[b],c),b!=c&&I(this.adj[c],b)}catch(d){d instanceof TypeError&&a(new Y("The edge "+b+"-"+c+" is not in the graph")),a(d)}},xb.prototype.remove_edge=xb.prototype.s,xb.prototype.A=function(a){fb(a,function(a){var b=a[0];a=a[1],b in this.adj&&a in this.adj[b]&&(I(this.adj[b],a),b!=a&&I(this.adj[a],b))},this)},xb.prototype.remove_edges_from=xb.prototype.A,xb.prototype.S=function(a,b){return a in this.adj&&b in this.adj[a]},xb.prototype.has_edge=xb.prototype.S,xb.prototype.C=function(b){return b in this.adj||a(new Y("The node "+b+" is not in the graph.")),lb(this.adj[b])},xb.prototype.neighbors=xb.prototype.C,xb.prototype.Y=function(b){return b in this.adj||a(new Y("The node "+b+" is not in the graph.")),ob(this.adj[b])},xb.prototype.neighbors_iter=xb.prototype.Y,xb.prototype.p=function(a,b){return lb(this.j(a,b))},xb.prototype.edges=xb.prototype.p,xb.prototype.j=function(b,c){i(b)&&(c=b,b=Xb);var d,e,f={};return d=b!=Xb?gb(this.b(b),function(a){return[a,this.adj[a]]},this):nb(this.adj),c?pb(d,function(b){e=b[0];var c=new t,d=nb(b[1]);return c.next=function(){try{return d.next()}catch(b){b===fc&&(f[e]=1),a(b)}},c},function(a){return a[0]in f?void 0:[e,a[0],a[1]]}):pb(d,function(b){e=b[0];var c=new t,d=ob(b[1]);return c.next=function(){try{return d.next()}catch(b){b===fc&&(f[e]=1),a(b)}},c},function(a){return a in f?void 0:[e,a]})},xb.prototype.edges_iter=xb.prototype.j,xb.prototype.X=function(a,b,c){return d(c)||(c=Xb),a in this.adj?J(this.adj[a],b,c):c},xb.prototype.get_edge_data=xb.prototype.X,xb.prototype.na=function(){return lb(gb(this.o(),function(a){return G(a[1])}))},xb.prototype.adjacency_list=xb.prototype.na,xb.prototype.o=function(){return nb(this.adj)},xb.prototype.adjacency_iter=xb.prototype.o,xb.prototype.l=function(a,b){return this.q(a)?this.m(a,b).next()[1]:cb(x(this.m(a,b)))
},xb.prototype.degree=xb.prototype.l,xb.prototype.m=function(a,b){var c;return c=a!=Xb?gb(this.b(a),function(a){return[a,this.adj[a]]},this):nb(this.adj),b?gb(c,function(a){var c=a[0];a=a[1];var d,e=0;for(d in a)e+=+J(a[d],b,1);return e+=+(c in a&&J(a[c],b,1)),[c,e]}):gb(c,function(a){return[a[0],D(a[1])+ +(a[0]in a[1])]})},xb.prototype.degree_iter=xb.prototype.m,xb.prototype.clear=function(){this.name(""),H(this.adj),H(this.node),H(this.graph)},xb.prototype.clear=xb.prototype.clear,xb.prototype.copy=function(){return sb(this)},xb.prototype.copy=xb.prototype.copy,xb.prototype.f=b(Yb),xb.prototype.is_multigraph=xb.prototype.f,xb.prototype.d=b(Yb),xb.prototype.is_directed=xb.prototype.d,xb.prototype.B=function(){var a=new yb;return a.name(this.name()),a.i(this),a.a(function(){var a;return pb(this.o(),function(b){return a=b[0],nb(b[1])},function(b){return[a,b[0],rb(b[1])]})}.call(this)),a.graph=rb(this.graph),a.node=rb(this.node),a},xb.prototype.to_directed=xb.prototype.B,xb.prototype.P=function(){return sb(this)},xb.prototype.to_undirected=xb.prototype.P,xb.prototype.r=function(a){a=this.b(a);var b=new this.constructor,c=b.adj,d=this.adj;return fb(a,function(a){var b={};c[a]=b,B(d[a],function(d,e){e in c&&(b[e]=d,c[e][a]=d)})}),fb(b,function(a){b.node[a]=this.node[a]},this),b.graph=this.graph,b},xb.prototype.subgraph=xb.prototype.r,xb.prototype.wa=function(){return ec(dc(mb(this.adj),function(a){return a[0]in a[1]}),function(a){return a[0]})},xb.prototype.nodes_with_selfloops=xb.prototype.wa,xb.prototype.O=function(a){return a?ec(dc(mb(this.adj),function(a){return a[0]in a[1]}),function(a){var b=a[0];return[b,b,a[1][b]]}):ec(dc(mb(this.adj),function(a){return a[0]in a[1]}),function(a){return[a[0],a[0]]})},xb.prototype.selfloop_edges=xb.prototype.O,xb.prototype.xa=function(){return this.O().length},xb.prototype.number_of_selfloops=xb.prototype.xa,xb.prototype.size=function(a){var b=kc.n.apply(Xb,F(this.l(Xb,a)))/2;return a!=Xb?b:Math.floor(b)},xb.prototype.size=xb.prototype.size,xb.prototype.D=function(a,b){return a==Xb?Math.floor(this.size()):b in this.adj[a]?1:0},xb.prototype.number_of_edges=xb.prototype.D,xb.prototype.ka=function(a,b){var c=lb(a),d=c[0],c=gb(o(c,1),function(a){return[d,a]});this.a(c,b)},xb.prototype.add_star=xb.prototype.ka,xb.prototype.ja=function(a,b){var c=lb(a),c=s(o(c,0,c.length-1),o(c,1));this.a(c,b)},xb.prototype.add_path=xb.prototype.ja,xb.prototype.ia=function(a,b){var c=lb(a),c=s(c,m(o(c,1),[c[0]]));this.a(c,b)},xb.prototype.add_cycle=xb.prototype.ia,xb.prototype.b=function(b){if(b!=Xb)if(this.q(b))b=ob([b.toString()]);else{var c=this.adj,d=new t,e=pb(b,function(a){return a in c?a.toString():void 0});d.next=function(){try{return e.next()}catch(b){b instanceof TypeError&&a(new Y("nbunch is not a node or a sequence of nodes")),a(b)}},b=d}else b=ob(this.adj);return b},xb.prototype.nbunch_iter=xb.prototype.b,k("jsnx.classes.DiGraph",yb),k("jsnx.DiGraph",yb),l(yb,xb),yb.__name__="DiGraph",yb.prototype.F=function(b,d){d!=Xb||(d={}),"object"!==c(d)&&a(new Y("The attr_dict argument must be an object.")),b in this.succ?L(this.node[b],d):(this.succ[b]={},this.pred[b]={},this.node[b]=d)},yb.prototype.add_node=yb.prototype.F,yb.prototype.i=function(a,b){var c,d,e,g,h;b=b||{},fb(ob(a),function(a){c=!(a in this.succ),f(a)?(d=a[0],e=a[1],d in this.succ?(h=this.node[d],L(h,b,e)):(this.succ[d]={},this.pred[d]={},g=K(b),L(g,e),this.node[d]=g)):c?(this.succ[a]={},this.pred[a]={},this.node[a]=K(b)):L(this.node[a],b)},this)},yb.prototype.add_nodes_from=yb.prototype.i,yb.prototype.N=function(b){b in this.node||a(new Y("The node "+b+" is not in the graph"));var c=this.succ[b];I(this.node,b),B(c,function(a,c){I(this.pred[c],b)},this),I(this.succ,b),B(this.pred[b],function(a,c){I(this.succ[c],b)},this),I(this.pred,b)},yb.prototype.remove_node=yb.prototype.N,yb.prototype.U=function(a){var b;fb(a,function(a){a in this.succ&&(b=this.succ[a],I(this.node,a),B(b,function(b,c){I(this.pred[c],a)},this),I(this.succ,a),B(this.pred[a],function(b,c){I(this.succ[c],a)},this),I(this.pred,a))},this)},yb.prototype.remove_nodes_from=yb.prototype.U,yb.prototype.h=function(b,d,e){e=e||{},"object"!==c(e)&&a(new Y("The attr_dict argument must be an object.")),b in this.succ||(this.succ[b]={},this.pred[b]={},this.node[b]={}),d in this.succ||(this.succ[d]={},this.pred[d]={},this.node[d]={});var f=J(this.adj[b],d,{});L(f,e),this.succ[b][d]=f,this.pred[d][b]=f},yb.prototype.add_edge=yb.prototype.h,yb.prototype.a=function(b,d){d=d||{},"object"!==c(d)&&a(new Y("The attr_dict argument must be an object.")),fb(b,function(b){var c,e,f,g=eb(b);3===g?(c=b[0],e=b[1],f=b[2]):2===g?(c=b[0],e=b[1],f={}):a(new Y("Edge tuple "+b.toString()+" must be a 2-tuple or 3-tuple.")),c in this.succ||(this.succ[c]={},this.pred[c]={},this.node[c]={}),e in this.succ||(this.succ[e]={},this.pred[e]={},this.node[e]={}),b=J(this.adj[c],e,{}),L(b,d,f),this.succ[c][e]=b,this.pred[e][c]=b},this)},yb.prototype.add_edges_from=yb.prototype.a,yb.prototype.s=function(b,c){try{I(this.succ[b],c),I(this.pred[c],b)}catch(d){d instanceof TypeError&&a(new Y("The edge "+b+"-"+c+" is not in the graph")),a(d)}},yb.prototype.remove_edge=yb.prototype.s,yb.prototype.A=function(a){fb(a,function(a){var b=a[0];a=a[1],b in this.succ&&a in this.succ[b]&&(I(this.succ[b],a),I(this.pred[a],b))},this)},yb.prototype.remove_edges_from=yb.prototype.A,yb.prototype.ta=function(a,b){return a in this.succ&&b in this.succ[a]},yb.prototype.has_successor=yb.prototype.ta,yb.prototype.sa=function(a,b){return a in this.pred&&b in this.pred[a]},yb.prototype.has_predecessor=yb.prototype.sa,yb.prototype.ga=function(b){return b in this.succ||a(new Y("The node "+b+" is not in the digraph.")),ob(this.succ[b])},yb.prototype.successors_iter=yb.prototype.ga,yb.prototype.za=function(b){return b in this.pred||a(new Y("The node "+b+" is not in the digraph.")),ob(this.pred[b])},yb.prototype.predecessors_iter=yb.prototype.za,yb.prototype.ba=function(b){return b in this.succ||a(new Y("The node "+b+" is not in the digraph.")),lb(this.succ[b])},yb.prototype.successors=yb.prototype.ba,yb.prototype.ya=function(b){return b in this.succ||a(new Y("The node "+b+" is not in the digraph.")),lb(this.pred[b])},yb.prototype.predecessors=yb.prototype.ya,yb.prototype.C=yb.prototype.ba,yb.prototype.neighbors=yb.prototype.C,yb.prototype.Y=yb.prototype.ga,yb.prototype.neighbors_iter=yb.prototype.Y,yb.prototype.j=function(a,b){i(a)&&(b=a,a=Xb);var c,d,e;return c=a!=Xb?gb(this.b(a),function(a){return[a,this.adj[a]]},this):mb(this.adj),b?pb(c,function(a){return d=a[0],e=a[1],nb(e)},function(a){return[d,a[0],a[1]]}):pb(c,function(a){return d=a[0],e=a[1],nb(e)},function(a){return[d,a[0]]})},yb.prototype.edges_iter=yb.prototype.j,yb.prototype.T=yb.prototype.j,yb.prototype.out_edges_iter=yb.prototype.T,yb.prototype.$=xb.prototype.p,yb.prototype.out_edges=yb.prototype.$,yb.prototype.I=function(a,b){i(a)&&(b=a,a=Xb);var c,d;return c=a!=Xb?gb(this.b(a),function(a){return[a,this.pred[a]]},this):mb(this.pred),b?pb(c,function(a){return d=a[0],nb(a[1])},function(a){return[a[0],d,a[1]]}):pb(c,function(a){return d=a[0],nb(a[1])},function(a){return[a[0],d]})},yb.prototype.in_edges_iter=yb.prototype.I,yb.prototype.H=function(a,b){return lb(this.I(a,b))},yb.prototype.in_edges=yb.prototype.H,yb.prototype.m=function(a,b){var c;return c=a!=Xb?hb(gb(this.b(a),function(a){return[a,this.succ[a]]},this),gb(this.b(a),function(a){return[a,this.pred[a]]},this)):hb(nb(this.succ),nb(this.pred)),b?gb(c,function(a){var c,d=a[0][1],e=a[1][1],f=0;for(c in d)f+=+J(d[c],b,1);for(c in e)f+=+J(e[c],b,1);return[a[0][0],f]}):gb(c,function(a){return[a[0][0],eb(a[0][1])+eb(a[1][1])]})},yb.prototype.degree_iter=yb.prototype.m,yb.prototype.G=function(a,b){var c;return c=a!=Xb?gb(this.b(a),function(a){return[a,this.pred[a]]},this):nb(this.pred),b?gb(c,function(a){var c,d=0,e=a[1];for(c in e)d+=+J(e[c],b,1);return[a[0],d]}):gb(c,function(a){return[a[0],D(a[1])]})},yb.prototype.in_degree_iter=yb.prototype.G,yb.prototype.M=function(a,b){var c;return c=a!=Xb?gb(this.b(a),function(a){return[a,this.succ[a]]},this):nb(this.succ),b?gb(c,function(a){var c,d=0,e=a[1];for(c in e)d+=+J(e[c],b,1);return[a[0],d]}):gb(c,function(a){return[a[0],D(a[1])]})},yb.prototype.out_degree_iter=yb.prototype.M,yb.prototype.da=function(a,b){return this.q(a)?this.G(a,b).next()[1]:cb(this.G(a,b))},yb.prototype.in_degree=yb.prototype.da,yb.prototype.fa=function(a,b){return this.q(a)?this.M(a,b).next()[1]:cb(this.M(a,b))},yb.prototype.out_degree=yb.prototype.fa,yb.prototype.clear=function(){H(this.succ),H(this.pred),H(this.node),H(this.graph)},yb.prototype.clear=yb.prototype.clear,yb.prototype.f=b(Yb),yb.prototype.is_multigraph=yb.prototype.f,yb.prototype.d=b(Wb),yb.prototype.is_directed=yb.prototype.d,yb.prototype.B=function(){return sb(this)},yb.prototype.to_directed=yb.prototype.B,yb.prototype.P=function(a){var b=new xb;b.name(this.name()),b.i(this);var c,d=this.pred;return b.a(a?pb(this.o(),function(a){return c=a[0],nb(a[1])},function(a){return a[0]in d[c]?[c,a[0],rb(a[1])]:void 0}):pb(this.o(),function(a){return c=a[0],nb(a[1])},function(a){return[c,a[0],rb(a[1])]})),b.graph=rb(this.graph),b.node=rb(this.node),b},yb.prototype.to_undirected=yb.prototype.P,yb.prototype.reverse=function(a){return(a=!d(a)||a)?(a=new this.constructor(Xb,{name:"Reverse of ("+this.name()+")"}),a.i(this),a.a(gb(this.j(Wb),function(a){return[a[1],a[0],rb(a[2])]})),a.graph=rb(this.graph),a.node=rb(this.node)):(a=this.succ,this.succ=this.pred,this.pred=a,this.adj=this.succ,a=this),a},yb.prototype.reverse=yb.prototype.reverse,yb.prototype.r=function(a){a=this.b(a);var b=new this.constructor,c=b.succ,d=b.pred,e=this.succ;return fb(a,function(a){c[a]={},d[a]={}}),fb(c,function(a){var b=c[a];B(e[a],function(e,f){f in c&&(b[f]=e,d[f][a]=e)})}),fb(b,function(a){b.node[a]=this.node[a]},this),b.graph=this.graph,b},yb.prototype.subgraph=yb.prototype.r,l(zb,xb),k("jsnx.classes.MultiGraph",zb),k("jsnx.MultiGraph",zb),zb.__name__="MultiGraph",zb.prototype.h=function(b,d,e,f){var g,i;if(e!=Xb&&!h(e)&&"number"!=typeof e&&(f=e,e=Xb),f=f||{},"object"!==c(f)&&a(new Y("The attr_dict argument must be an object.")),b in this.adj||(this.adj[b]={},this.node[b]={}),d in this.adj||(this.adj[d]={},this.node[d]={}),d in this.adj[b]){if(i=this.adj[b][d],e==Xb)for(e=D(i);e in i;)e+=1;g=J(i,e,{}),L(g,f),i[e]=g}else e!=Xb||(e=0),g={},L(g,f),i=M(e,g),this.adj[b][d]=i,this.adj[d][b]=i},zb.prototype.add_edge=zb.prototype.h,zb.prototype.a=function(b,d){d=d||{},"object"!==c(d)&&a(new Y("The attr_dict argument must be an object.")),fb(b,function(b){var c,e,f=eb(b),g=Xb,h={};if(4===f?(c=b[0],e=b[1],g=b[2],h=b[3]):3===f?(c=b[0],e=b[1],h=b[2]):2===f?(c=b[0],e=b[1]):a(new Y("Edge tuple "+tb(b)+" must be a 2-tuple, 3-tuple or 4-tuple.")),b=c in this.adj?J(this.adj[c],e,{}):{},g==Xb)for(g=D(b);g in b;)g+=1;b=J(b,g,{}),L(b,d,h),this.h(c,e,g,b)},this)},zb.prototype.add_edges_from=zb.prototype.a,zb.prototype.s=function(b,c,d){!(b in this.adj&&c in this.adj[b]||!a(new Y("The edge "+b+"-"+c+" is not in the graph")));var e=this.adj[b][c];d!=Xb?(d in e||a(new Y("The edge "+b+"-"+c+" with key "+d+" is not in the graph")),I(e,d)):I(e,E(e)),0===D(e)&&(I(this.adj[b],c),b!=c&&I(this.adj[c],b))},zb.prototype.remove_edge=zb.prototype.s,zb.prototype.A=function(b){fb(b,function(b){try{this.s(b[0],b[1],b[2])}catch(c){c instanceof Y||a(c)}},this)},zb.prototype.remove_edges_from=zb.prototype.A,zb.prototype.S=function(a,b,c){return c!=Xb?a in this.adj&&b in this.adj[a]&&c in this.adj[a][b]:a in this.adj&&b in this.adj[a]},zb.prototype.has_edge=zb.prototype.S,zb.prototype.p=function(a,b,c){return x(this.j(a,b,c))},zb.prototype.edges=zb.prototype.p,zb.prototype.j=function(b,c,d){i(b)&&(i(c)&&(d=c),c=b,b=Xb);var e,f,g={};return b=b!=Xb?gb(this.b(b),function(a){return[a,this.adj[a]]},this):nb(this.adj),c?pb(b,function(b){e=b[0];var c=new t,d=nb(b[1]);return c.next=function(){try{return d.next()}catch(b){b===fc&&(g[e]=1),a(b)}},c},function(a){return f=a[0],f in g?void 0:nb(a[1])},function(a){return d?[e,f,a[0],a[1]]:[e,f,a[1]]}):pb(b,function(b){e=b[0];var c=new t,d=nb(b[1]);return c.next=function(){try{return d.next()}catch(b){b===fc&&(g[e]=1),a(b)}},c},function(a){return f=a[0],f in g?void 0:nb(a[1])},function(a){return d?[e,f,a[0]]:[e,f]})},zb.prototype.edges_iter=zb.prototype.j,zb.prototype.X=function(a,b,c,e){return d(e)||(e=Xb),a in this.adj&&b in this.adj[a]?c!=Xb?J(this.adj[a][b],c,e):this.adj[a][b]:e},zb.prototype.get_edge_data=zb.prototype.X,zb.prototype.m=function(a,b){var c;return c=a!=Xb?gb(this.b(a),function(a){return[a,this.adj[a]]},this):nb(this.adj),b!=Xb?w(c,function(a){var c=a[0];a=a[1];var d=0;return B(a,function(a){B(a,function(a){d+=J(a,b,1)})}),c in a&&B(a[c],function(a){d+=J(a,b,1)}),[c,d]}):w(c,function(a){var b=a[0];a=a[1];var c=0;return B(a,function(a){c+=D(a)}),[b,c+ +(b in a&&D(a[b]))]})},zb.prototype.degree_iter=zb.prototype.m,zb.prototype.f=b(Wb),zb.prototype.is_multigraph=zb.prototype.f,zb.prototype.d=b(Yb),zb.prototype.is_directed=zb.prototype.d,zb.prototype.B=function(){var a=new Ab;return a.i(this),a.a(function(){var a,b;return pb(this.o(),function(b){return a=b[0],nb(b[1])},function(a){return b=a[0],nb(a[1])},function(c){return[a,b,c[0],rb(c[1])]})}.call(this)),a.graph=rb(this.graph),a.node=rb(this.node),a},zb.prototype.to_directed=zb.prototype.B,zb.prototype.O=function(a,b){var c=[];return a?b?B(this.adj,function(a,b){b in a&&B(a[b],function(a,d){c.push([b,b,d,a])})}):B(this.adj,function(a,b){b in a&&B(a[b],function(a){c.push([b,b,a])})}):b?B(this.adj,function(a,b){b in a&&B(a[b],function(a,d){c.push([b,b,d])})}):B(this.adj,function(a,b){b in a&&B(a[b],function(){c.push([b,b])})}),c},zb.prototype.selfloop_edges=zb.prototype.O,zb.prototype.D=function(a,b){return a==Xb?this.size():a in this.adj&&b in this.adj[a]?D(this.adj[a][b]):0},zb.prototype.number_of_edges=zb.prototype.D,zb.prototype.r=function(a){a=this.b(a);var b=new this.constructor,c=b.adj,d=this.adj;return v(a,function(a){var b={};c[a]=b,B(d[a],function(d,e){if(e in c){var f=K(d);b[e]=f,c[e][a]=f}})}),B(this.node,function(a,c){b.node[c]=a}),b.graph=this.graph,b},zb.prototype.subgraph=zb.prototype.r,l(Ab,yb);var lc,mc=Ab.prototype,nc=zb.prototype;for(lc in nc)nc.hasOwnProperty(lc)&&"constructor"!==lc&&(mc[lc]=nc[lc]);k("jsnx.classes.MultiDiGraph",Ab),k("jsnx.MultiDiGraph",Ab),Ab.__name__="MultiDiGraph",Ab.prototype.h=function(b,d,e,f){var g,i;if(e!=Xb&&!h(e)&&"number"!=typeof e&&(f=e,e=Xb),f=f||{},"object"!==c(f)&&a(new Y("The attr_dict argument must be an object.")),b in this.succ||(this.succ[b]={},this.pred[b]={},this.node[b]={}),d in this.succ||(this.succ[d]={},this.pred[d]={},this.node[d]={}),d in this.succ[b]){if(i=this.adj[b][d],e==Xb)for(e=D(i);e in i;)e+=1;g=J(i,e,{}),L(g,f),i[e]=g}else e!=Xb||(e=0),g={},L(g,f),i=M(e,g),this.succ[b][d]=i,this.pred[d][b]=i},Ab.prototype.add_edge=Ab.prototype.h,Ab.prototype.s=function(b,c,d){!(b in this.adj&&c in this.adj[b]||!a(new Y("The edge "+b+"-"+c+" is not in the graph")));var e=this.adj[b][c];d!=Xb?(d in e||a(new Y("The edge "+b+"-"+c+" with key "+d+" is not in the graph")),I(e,d)):I(e,E(e)),0===D(e)&&(I(this.succ[b],c),I(this.pred[c],b))},Ab.prototype.remove_edge=Ab.prototype.s,Ab.prototype.j=function(a,b,c){i(a)&&(i(b)&&(c=b),b=a,a=Xb);var d,e;return a=a!=Xb?gb(this.b(a),function(a){return[a,this.adj[a]]},this):mb(this.adj),b?pb(a,function(a){return d=a[0],nb(a[1])},function(a){return e=a[0],nb(a[1])},function(a){return c?[d,e,a[0],a[1]]:[d,e,a[1]]}):pb(a,function(a){return d=a[0],nb(a[1])},function(a){return e=a[0],nb(a[1])},function(a){return c?[d,e,a[0]]:[d,e]})},Ab.prototype.edges_iter=Ab.prototype.j,Ab.prototype.T=Ab.prototype.j,Ab.prototype.out_edges_iter=Ab.prototype.T,Ab.prototype.$=function(a,b,c){return x(this.T(a,b,c))},Ab.prototype.out_edges=Ab.prototype.$,Ab.prototype.I=function(a,b,c){i(a)&&(b=a,a=Xb);var d,f;return a=e?gb(this.b(a),function(a){return[a,this.pred[a]]},this):mb(this.pred),b?pb(a,function(a){return d=a[0],nb(a[1])},function(a){return f=a[0],nb(a[1])},function(a){return c?[f,d,a[0],a[1]]:[f,d,a[1]]}):pb(a,function(a){return d=a[0],nb(a[1])},function(a){return f=a[0],nb(a[1])},function(a){return c?[f,d,a[0]]:[f,d]})},Ab.prototype.in_edges_iter=Ab.prototype.I,Ab.prototype.H=function(a,b,c){return x(this.I(a,b,c))},Ab.prototype.in_edges=Ab.prototype.H,Ab.prototype.m=function(a,b){var c;return c=a!=Xb?hb(w(this.b(a),function(a){return[a,this.succ[a]]},this),w(this.b(a),function(a){return[a,this.pred[a]]},this)):hb(nb(this.succ),nb(this.pred)),b!=Xb?gb(c,function(a){var c=a[0][1],d=0;return B(a[1][1],function(a){B(a,function(a){d+=+J(a,b,1)})}),B(c,function(a){B(a,function(a){d+=+J(a,b,1)})}),[a[0][0],d]}):gb(c,function(a){var b=0,c=0;return B(a[1][1],function(a){b+=eb(a)}),B(a[0][1],function(a){c+=eb(a)}),[a[0][0],b+c]})},Ab.prototype.degree_iter=Ab.prototype.m,Ab.prototype.G=function(a,b){var c;return c=a!=Xb?gb(this.b(a),function(a){return[a,this.pred[a]]},this):nb(this.pred),b!=Xb?gb(c,function(a){var c=0;return B(a[1],function(a){B(a,function(a){c+=+J(a,b,1)})}),[a[0][0],c]}):gb(c,function(a){var b=0;return B(a[1],function(a){b+=D(a)}),[a[0],b]})},Ab.prototype.in_degree_iter=Ab.prototype.G,Ab.prototype.M=function(a,b){var c;return c=a!=Xb?gb(this.b(a),function(a){return[a,this.succ[a]]},this):nb(this.succ),b!=Xb?gb(c,function(a){var c=0;return B(a[1],function(a){B(a,function(a){c+=+J(a,b,1)})}),[a[0][0],c]}):gb(c,function(a){var b=0;return B(a[1],function(a){b+=D(a)}),[a[0],b]})},Ab.prototype.out_degree_iter=Ab.prototype.M,Ab.prototype.f=b(Wb),Ab.prototype.is_multigraph=Ab.prototype.f,Ab.prototype.d=b(Wb),Ab.prototype.is_directed=Ab.prototype.d,Ab.prototype.B=function(){return sb(this)},Ab.prototype.to_directed=Ab.prototype.B,Ab.prototype.P=function(a){var b=new zb;b.name(this.name()),b.i(this);var c,d,e=this;return b.a(a?pb(this.o(),function(a){return c=a[0],nb(a[1])},function(a){return d=a[0],nb(a[1])},function(a){return e.S(d,c,a[0])?[c,d,a[0],rb(a[1])]:void 0}):pb(this.o(),function(a){return c=a[0],nb(a[1])},function(a){return d=a[0],nb(a[1])},function(a){return[c,d,a[0],rb(a[1])]})),b.graph=rb(this.graph),b.node=rb(this.node),b},Ab.prototype.to_undirected=Ab.prototype.P,Ab.prototype.r=function(a){a=this.b(a);var b=new this.constructor,c=b.succ,d=b.pred,e=this.succ;return v(a,function(a){c[a]={},d[a]={}}),fb(c,function(a){var b=c[a];B(e[a],function(e,f){if(f in c){var g=K(e);b[f]=g,d[f][a]=g}})}),fb(b,function(a){b.node[a]=this.node[a]},this),b.graph=this.graph,b},Ab.prototype.subgraph=Ab.prototype.r,Ab.prototype.reverse=function(a){return(a=!d(a)||a)?(a=new this.constructor(Xb,{name:"Reverse of ("+this.name()+")"}),a.i(this),a.a(w(this.j(Wb,Wb),function(a){return[a[1],a[0],a[2],rb(a[3])]})),a.graph=rb(this.graph),a.node=rb(this.node)):(a=this.succ,this.succ=this.pred,this.pred=a,this.adj=this.succ,a=this),a},Ab.prototype.reverse=Ab.prototype.reverse,k("jsnx.nodes",function(a){return a.z()}),k("jsnx.nodes_iter",function(a){return a.K()}),k("jsnx.edges",function(a,b){return a.p(b)}),k("jsnx.edges_iter",function(a,b){return a.j(b)}),k("jsnx.degree",function(a,b,c){return a.l(b,c)}),k("jsnx.neighbors",function(a,b){return a.C(b)}),k("jsnx.number_of_nodes",function(a){return a.L()}),k("jsnx.number_of_edges",function(a){return a.D()}),k("jsnx.density",function(a){var b=a.L(),c=a.D();return 0===c?0:a.d()?c/(b*(b-1)):2*c/(b*(b-1))}),k("jsnx.degree_histogram",function(a){a=F(a.l());for(var b=Math.max.apply(Math,a)+1,c=[],d=0;b>d;d++)c[d]=0;return cc(a,function(a){c[a]+=1}),c}),k("jsnx.is_directed",function(a){return a.d()}),k("jsnx.freeze",function(b){function c(){a(new Y("Frozen graph can't be modified"))}return b.F=c,b.i=c,b.N=c,b.U=c,b.h=c,b.a=c,b.s=c,b.A=c,b.clear=c,b.qa=Wb,b}),k("jsnx.is_frozen",function(a){return!!a.qa}),k("jsnx.subgraph",function(a,b){return a.r(b)}),k("jsnx.create_empty_copy",function(a,b){d(b)||(b=Wb);var c=new a.constructor;return b&&c.i(a),c}),k("jsnx.info",function(b,c){var d="";if(c!=Xb)b.q(c)||a(new Y("node "+c+" not in graph")),d=d+("Node "+c+" has the following properties:\n")+("Degree: "+b.l(c)+"\n"),d+="Neighbors: "+b.C(c).join(" ");else{var d=d+("Name: "+b.name()+"\n"),d=d+("Type: "+b.constructor.__name__+"\n"),d=d+("Number of nodes: "+b.L()+"\n"),d=d+("Number of edges: "+b.D()+"\n"),e=b.L();if(e>0)if(b.d())d+="Average in degree: "+(kc.n.apply(Xb,F(b.da()))/e).toFixed(4)+"\n",d+="Average out degree: "+(kc.n.apply(Xb,F(b.fa()))/e).toFixed(4);else var f=kc.n.apply(Xb,F(b.l())),d=d+("Average degree: "+(f/e).toFixed(4))}return d}),k("jsnx.set_node_attributes",function(a,b,c){B(c,function(c,d){a.Z[d][b]=c})}),k("jsnx.get_node_attributes",Bb),k("jsnx.set_edge_attributes",function(a,b,c){B(c,function(b,c){c=c.split(","),a.k(c[0])[c[1]]=b})}),Bb=function(a,b){var c={};return B(a.p(Wb),function(a){b in a[2]&&(c[[a[0],a[1]]]=a[2][b])}),c},k("jsnx.get_edge_attributes",{}.Ka);var oc={};k("jsnx.triangles",Cb),k("jsnx.average_clustering",function(a,b,c,d){2===arguments.length?h(b)?(c=b,b=Xb):i(b)&&(d=b,b=Xb):3===arguments.length&&i(c)&&(d=c,c=Xb),c!=Xb||(c=Xb),d!=Xb||(d=Wb);var e=F(Eb(a,b,c));return d||(e=dc(e,function(a){return a>0})),kc.n.apply(kc,e)/e.length}),k("jsnx.clustering",Eb),k("jsnx.transitivity",function(a){var b=0,c=0;return v(Db(a),function(a){c+=a[1]*(a[1]-1),b+=a[2]}),0===b?0:b/c}),k("jsnx.square_clustering",function(a,b){var c=b==Xb?a:a.b(b),d={};return v(c,function(b){var c=d[b]=0;v(jb(G(a.k(b))),function(e){var f=e[0];e=e[1];var g=S(new Q(G(a.k(f))),G(a.k(e)));g.remove(b),g=g.c(),d[b]+=g;var h=g+1,i=a.k(f);e in i&&(h+=1),c+=(D(a.k(f))-h)*(D(a.k(e))-h)+g}),c>0&&(d[b]/=c)}),a.q(b)?F(d)[0]:d}),k("jsnx.find_cliques",Fb),k("jsnx.find_cliques_recursive",function(a){var b={};v(a.o(),function(a){var c=new Q(G(a[1]));c.remove(a[0]),b[a[0]]=c});a:{for(var c in b){a=Yb;break a}a=Wb}if(a)return[];a=new Q(G(b)),c=new Q;var d=[];return Gb(b,a,c,[],d),d}),k("jsnx.graph_clique_number",function(a,b){b!=Xb||(b=Fb(a));var c=0;return fb(b,function(a){c=a.length>c?a.length:c}),c}),k("jsnx.graph_number_of_cliques",function(a,b){return b!=Xb||(b=Fb(a)),lb(b).length}),k("jsnx.number_of_cliques",Hb),k("jsnx.algorithms.isomorphism.could_be_isomorphic",Ib),k("jsnx.could_be_isomorphic",Ib),k("jsnx.algorithms.isomorphism.fast_could_be_isomorphic",Jb),k("jsnx.fast_could_be_isomorphic",Jb),k("jsnx.algorithms.isomorphism.faster_could_be_isomorphic",Kb),k("jsnx.faster_could_be_isomorphic",Kb),k("jsnx.is_valid_degree_sequence",Lb),k("jsnx.is_valid_degree_sequence_havel_hakimi",Mb),k("jsnx.is_valid_degree_sequence_erdos_gallai",Nb),k("jsnx.strongly_connected_components",Ob),k("jsnx.simple_cycles",function(b){function c(a){function b(a){var c;for(l.remove(a);0<k[a].length;)c=k[a].pop(),l.contains(c)&&b(c)}var f,g,h=Yb,i=d.ba(a);for(n.push(a),l.add(a),f=0;f<i.length;f++)g=i[f],g===e?(h=n.slice(0),h.push(e),o.push(h),h=Wb):l.contains(g)||c(g)&&(h=Wb);if(h)b(a);else for(f=0;f<i.length;f++)g=i[f],0<=bc(k[g],a)||k[g].push(a);return a!==n.pop()&&console.log("DANGER WILL ROBINSON!"),h}b.d()||a(new Y("simple_cycles() is not defined for undirected graphs."));var d,e,f,g,h,i,j,k={},l=new Q,m=b.z(),n=[],o=[],p={};for(g=0;g<m.length;g++)k[m[g]]=[],p[m[g]]=g;for(f=0;f<m.length-1;)if(e=m[f],g=b.r(m.slice(f)),h=Ob(g),0===h.length)f=m.length;else{for(d=j=i=Vb,g=0;g<h.length;g++)for(f=0;f<h[g].length;f++)i===Vb?(i=h[g][f],d=h[g],j=p[i]):p[h[g][f]]<j&&(i=h[g][f],d=h[g],j=p[i]);for(d=b.r(d),e=i,f=p[i],h=d.z(),g=0;g<h.length;g++)l.remove(h[g]),k[h[g]]=[];c(e),f++}return o}),k("jsnx.complete_graph",Pb),k("jsnx.cycle_graph",function(a,b){var c=Rb(a,b);return c.name("cycle_graph("+a+")"),a>1&&c.h(a-1,0),c}),k("jsnx.empty_graph",Qb),k("jsnx.null_graph",function(a){return a=Qb(0,a),a.name("null_graph()"),a}),k("jsnx.path_graph",Rb),k("jsnx.trivial_graph",function(a){return a=Qb(1,a),a.name("null_graph()"),a}),k("jsnx.fast_gnp_random_graph",function(a,b,c){c!=Xb||(c=Yb);var d=Qb(a);if(d.name("fast_gnp_random_graph("+a+","+b+")"),0>=b||b>=1)return Sb(a,b,c);var e=1,f=-1;if(b=Math.log(1-b),c)for(d=yb(d);a>e;){for(c=Math.log(1-Math.random()),f=f+1+Math.floor(c/b),e===f&&(f+=1);f>=a&&a>e;)f-=a,e+=1,e==f&&(f+=1);a>e&&d.h(e,f)}else for(;a>e;){for(c=Math.log(1-Math.random()),f=f+1+Math.floor(c/b);f>=e&&a>e;)f-=e,e+=1;a>e&&d.h(e,f)}return d}),k("jsnx.gnp_random_graph",Sb),k("jsnx.binomial_graph",Sb),k("jsnx.erdos_renyi_graph",Sb),k("jsnx.havel_hakimi_graph",function(b,c){Lb(b)||a(new Y("Invalid degree sequence")),c!=Xb&&(c.d()&&a(new Y("Directed Graph not supported")),c.f()&&a(new Y("Havel-Hakimi requires simple graph")));var d=b.length,e=Qb(d,c);if(0===d||0===Math.max.apply(Xb,b))return e;for(d=x(w(e,function(a){return[b[a],a]}));0<d.length;){if(d.sort(function(a,b){return a[0]!==b[0]?a[0]-b[0]:+a[1]-+b[1]}),0>d[0][0])return Yb;var f=d.pop();if(0===f[0])break;if(f[0]>d.length)return Yb;for(var g=d.length,h=g-f[0];g>h;h++)e.h(f[1],d[h][1]),d[h][0]-=1}return e.name("havel_hakimi_graph "+e.v()+" nodes "+e.size()+" edges"),e}),k("jsnx.relabel_nodes",Tb),k("jsnx.convert_node_labels_to_integers",function(b,c,d,e){3===arguments.length&&i(d)?(e=d,d=Xb):2===arguments.length&&(i(c)?(e=c,c=Xb):h(c)&&(d=c,c=Xb)),c!=Xb||(c=0),d!=Xb||(d="default"),e!=Xb||(e=Wb);var f,g,j,k,l={};if("default"===d)for(f=b.z(),g=0,j=c,k=f.length;k>g;g++,j++)l[f[g]]=j;else if("sorted"===d)for(f=b.z(),f.sort(),g=0,j=c,k=f.length;k>g;g++,j++)l[f[g]]=j;else if("increasing degree"===d)for(f=x(b.m()),f.sort(function(a,b){return a[1]-b[1]}),g=0,j=c,k=f.length;k>g;g++,j++)l[f[g][0]]=j;else if("decreasing degree"===d)for(f=x(b.m()),f.sort(function(a,b){return b[1]-a[1]}),g=0,j=c,k=f.length;k>g;g++,j++)l[f[g][0]]=j;else a(new Y("Unkown node ordering: "+d));return g=Tb(b,l),g.name("("+b.name()+")_with_int_labels"),e||(g.node_labels=l),g})}(),function(){var a;a=function(){function a(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(i=a.length,e=[],h=[],c=[],d=[],f=[],j=[],g=l=0,t=i-1;t>=0?t>l:l>t;g=t>=0?++l:--l)e[g]=(b[g+1]-b[g])/(a[g+1]-a[g]),g>0&&(h[g]=(e[g-1]+e[g])/2);for(h[0]=e[0],h[i-1]=e[i-2],k=[],g=m=0,u=i-1;u>=0?u>m:m>u;g=u>=0?++m:--m)0===e[g]&&k.push(g);for(n=0,p=k.length;p>n;n++)g=k[n],h[g]=h[g+1]=0;for(g=o=0,v=i-1;v>=0?v>o:o>v;g=v>=0?++o:--o)c[g]=h[g]/e[g],d[g]=h[g+1]/e[g],f[g]=Math.pow(c[g],2)+Math.pow(d[g],2),j[g]=3/Math.sqrt(f[g]);for(k=[],g=r=0,w=i-1;w>=0?w>r:r>w;g=w>=0?++r:--r)f[g]>9&&k.push(g);for(s=0,q=k.length;q>s;s++)g=k[s],h[g]=j[g]*c[g]*e[g],h[g+1]=j[g]*d[g]*e[g];this.x=a.slice(0,i),this.y=b.slice(0,i),this.m=h}return a.prototype.interpolate=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(g=l=m=this.x.length-2;(0>=m?0>=l:l>=0)&&!(this.x[g]<=a);g=0>=m?++l:--l);return b=this.x[g+1]-this.x[g],h=(a-this.x[g])/b,i=Math.pow(h,2),j=Math.pow(h,3),c=2*j-3*i+1,e=j-2*i+h,d=-2*j+3*i,f=j-i,k=c*this.y[g]+e*b*this.m[g]+d*this.y[g+1]+f*b*this.m[g+1]},a}(),window.MonotonicCubicSpline=a}.call(this),function(a,b,c,d){"use strict";a.widget("edible.musicWaveform",a.edible.waveform,{MAX_VOL:1.5,_create:function(){var a,b,c;this.options._graph=this._createGraph();var e=this.options._graph.nodes().slice(0).sort(function(a,b){return parseFloat(a)-parseFloat(b)});if(this.options._beatOrder=e.slice(0),this.options.currentBeats===d){if(this.options.currentBeats=e,console.log(this.options.currentBeats),0!==this.options.start||this.options.dur!==this.options.len){for(b=this.options.currentBeats.slice(0),this.options.currentBeats=[],c=0;c<b.length;c++)a=1e3*parseFloat(b[c]),a>=this.options.start&&a<this.options.start+this.options.len&&this.options.currentBeats.push(b[c]);this.options.start=1e3*parseFloat(this.options.currentBeats[0])}}else this.options.start=1e3*parseFloat(this.options.currentBeats[0]);this._super("_create");var f=this;this.element.resizable({stop:function(a,b){var c=f.options.len,d=f.options.start,e=f._computePosFromResize(a,b);console.log("setting new len",e.len,"and start",e.start),f._updateCurrentBeatsFromResize(c,d,e.len,e.start),f._setOptions(e),f._refresh()}})},_updateCurrentBeatsFromResize:function(a,b,c,d){var e,f,g,h,i=this.options.currentBeats[0],j=this.options.currentBeats;if(d>b)return e=d-b,f=this._msToBeat(e),console.log("old BEATS",j),this.options.currentBeats=j.slice(f),void console.log("new BEATS",j);if(b>d){if(e=b-d,g=1e3*parseFloat(i)-e,g>=0){for(h=this.options._beatOrder.indexOf(i),console.log("old BEATS",j);1e3*parseFloat(j[0])>g&&h>0;)j.unshift(this.options._beatOrder[--h]);return void console.log("new BEATS",j)}throw"RESIZED TOO FAR! CLEAN UP THE MUSIC RESIZE CODE, STEVE"}if(c>a){for(h=this.options._beatOrder.indexOf(j[j.length-1]),console.log("old BEATS (nl > ol)",j);1e3*parseFloat(j[j.length-1])<d+c&&h<this.options._beatOrder.length-1;)j.push(this.options._beatOrder[++h]);return void console.log("new BEATS",j)}return a>c?(console.log("old BEATS (nl < ol)",j),f=this._msToBeat(c),this.options.currentBeats=j.slice(0,f),void console.log("new BEATS",j)):void 0},waveformClass:function(){return"musicWaveform"},_updateBeatSet:function(){var a,b={},c=this.options.currentBeats;for(a=0;a<c.length;a++)b[c[a]]=!0;this.options._beatSet=b},_refresh:function(){this._super("_refresh"),this._updateBeatSet(),this.findLoops()},addLoop:function(b){var c,e,f,g,h=this.options.len,i=this.options.start,j=this.options.currentBeats,k=0,l=this.options._graph;if(this.options._simpleCycles!==d){for(c=this.options._simpleCycles[0],e=0;e<j.length;e++)if(j[e]===c[0]){f=e;break}if(g=[f,1].concat(c),Array.prototype.splice.apply(this.options.currentBeats,g),a.each(c.slice(0,-1),function(a,b){k+=1e3*l.succ[b][c[a+1]].duration}),console.log("OLD LEN",h,"CYC LEN",k,"NEW LEN",h+k),this._setOptions({len:h+k}),"left"===b){i-(this.options.len-h)}return void(this.options.hasOwnProperty("loopCallback")&&this.options.loopCallback())}},_linearCycles:function(){var a,b,c,d,e,f=this.options.currentBeats,g=this.options._graph.subgraph(f),h=this.options._beatOrder,i=this.options._beatSet,j=[];for(a=0;a<h.length;a++)if(c=h[a],c in i)for(b=a+1;b<h.length;b++)d=h[b],d in i&&c in g.succ[d]&&(e=h.slice(a,b+1),e.push(c),j.push(e));return j.sort(function(a,b){return a.length-b.length}),j},findLoops:function(){if(!this.options.hasOwnProperty("musicGraph"))return[];if(this.element.find(".loopControlLeft").remove(),this.element.find(".loopControlRight").remove(),!(Object.keys(this.options._beatSet).length>140)){var b,e=(this.options._graph,this),f=this._linearCycles();console.log("cycles",f),f.length>0?(e.options._simpleCycles=f,b=c.createElement("div"),a(b).html('<i class="icon-repeat icon-white"></i>').addClass("loopControlRight").click(function(){return e.addLoop("right"),event.preventDefault(),!1}),e.element.append(b)):(e.options._simpleCycles=d,e.element.find(".loopControlLeft").remove(),e.element.find(".loopControlRight").remove())}},exportExtras:function(){this.options._dirty=!1;var a=this.options._mcanv.getContext("2d"),b=this.options.volume.x.slice(0),c=this.options.volume.y.slice(0),d=this.options.pxPerMs;return b.splice(0,0,0),b.push((a.canvas.width-1)/d),c.splice(0,0,c[0]),c.push(c[c.length-1]),{starts:this.options._exportStarts,durations:this.options._exportDurations,distances:this.options._exportDistances,volume:{x:b,y:c}}},slice:function(b){var d=this.element.offset(),e=b.pageX-d.left,f=c.createElement("div"),g=e/this.options.pxPerMs,h=this._msToBeat(g),i=this.options._beatToTime[h];console.log("beat index",h,"slice time",i);var j=a.extend(!0,{},this.options,{start:i,len:this.options.len-i}),k=this.options.currentBeats.slice(h);j.currentBeats=k,console.log("new beats",k);a(f)[this.waveformClass()](j);return this._setOptions({currentBeats:this.options.currentBeats.slice(0,h),len:i,_nextBeatHidden:this.options.currentBeats[h]}),{waveform:f,pos:i}},_msToBeat:function(b){if(!this.options.hasOwnProperty("_timeToBeat"))throw"No _timeToBeat in options";var c=this.options._timeToBeat,d=null,e=null;return a.each(c,function(a,c){(null==d||Math.abs(a-b)<Math.abs(d-b))&&(d=a,e=c)}),e},_drawWaveform:function(){if(!this.options.hasOwnProperty("_graph"))return void this._super("_drawWaveform");var b,e,f,g,h,i,j=this,k=this.options.data.length>0,l=this.options.data.length,m=l/this.options.dur,n=this.options.start*m,o=n+this.options.len*m,p=[],q=this.options._graph,r=this.options.currentBeats;
console.log("CURRENT BEATS LEN",r.length,r);var s=0;this.options._timeToBeat={},this.options._beatToTime=[],this.options._exportStarts=[],this.options._exportDurations=[],this.options._exportDistances=[],r[0]===this.options._beatOrder[0]&&(j.options._timeToBeat[s]=0,j.options._exportStarts.push(0),j.options._exportDurations.push(parseFloat(r[0])),j.options._exportDistances.push(0),console.log("Using the intro",r[0]),e=1e3*parseFloat(r[0]),s+=e,k&&(o=parseInt(e*m),g=j.options.data.slice(0,o),p.push.apply(p,g))),a.each(r,function(a,c){if(a===r.length-1&&c===j.options._beatOrder[j.options._beatOrder.length-1])b=1e3*parseFloat(c),e=parseFloat(j.options.dur),f=e-b,h=parseFloat(j.options.dur)/1e3-parseFloat(c),i=0;else if(a===r.length-1)console.log("hanging final beat","len",j.options.len),b=1e3*parseFloat(c),f=j.options.len-s,0>f&&(f=0),h=f/1e3,e=b+f,console.log("current duration",s),console.log("start",b,"end",e),i=0;else{if(b=1e3*parseFloat(c),q.succ[c].hasOwnProperty(r[a+1]))h=q.succ[c][r[a+1]].duration,i=q.succ[c][r[a+1]].distance;else{var d=Object.keys(q.succ[c])[0];h=q.succ[c][d].duration,i=1}f=1e3*h,e=b+f}j.options._timeToBeat[s]=a,j.options._beatToTime[a]=s,j.options._exportStarts.push(parseFloat(c)),j.options._exportDurations.push(h),j.options._exportDistances.push(i),s+=f,k&&(n=parseInt(b*m),o=parseInt(e*m),g=j.options.data.slice(n,o),p.push.apply(p,g))}),this.options.len=s;var t=this.options._mcanv;a(t).attr("width",this.width()),this.element.find(".topBar").css("width",this.width());var u="#4BF2A7";t!==d&&(u=t.getContext("2d").createLinearGradient(0,0,0,parseInt(this.options.canvHeight,10)),u.addColorStop(0,"#333"),u.addColorStop(1,"#777")),k||(p=[]);new Waveform({canvas:t,data:p,innerColor:u,outerColor:"#eee",height:this.options.canvHeight,interpolate:!0,width:this.width()});this.options._tmpCanv!==d&&this.options._tmpCanv.destroy();var v=c.createElement("canvas");a(v).appendTo("body"),this.options._tmpCanv=new EDIBLE.modules.MultiCanvas(v),this.options._tmpCanv.clone(t),this.options._tmpCanv.canvases.forEach(function(b){a(b).css("display","none")}),setTimeout(function(){j._drawVolume(!0)},0)},addVolumeMarker:function(a){var b,c=this.element.offset(),d=a.pageX-c.left,e=a.pageY-c.top-this.options.topBarHeight,f=d/this.options.pxPerMs,g=this.options._mcanv.getContext("2d"),h=this,i=function(a){return h.MAX_VOL-h.MAX_VOL*a/g.canvas.height},j=this.options.volume.x;for(b=0;b<j.length;b++)if(j[b]>f){j.splice(b,0,f),this.options.volume.y.splice(b,0,i(e));break}b===j.length&&(j.push(f),this.options.volume.y.push(i(e))),this._drawVolume(!0)},_drawVolume:function(b){var e=this;this.options._mcanv.clone(this.options._tmpCanv);var f=this.options._mcanv.getContext("2d");f.strokeStyle="#CFB52B",f.lineWidth=3,f.beginPath();var g,h=this.options.volume.x.slice(0),i=this.options.volume.y.slice(0),j=this.options.pxPerMs,k=(f.canvas.width-1)/j,l=!1;for(g=0;g<h.length;g++)if(h[g]>=k){l=!0;break}l&&(this.options.volume.x=h.slice(0,g),this.options.volume.y=i.slice(0,g)),h.splice(0,0,0),h.push((f.canvas.width-1)/j),i.splice(0,0,i[0]),i.push(i[i.length-1]);var m=function(a){return f.canvas.height-f.canvas.height*a/e.MAX_VOL},n=function(a){return a*j},o=h.map(n),p=i.map(m);f.moveTo(n(h[0]),m(i[0]));var g,q=new MonotonicCubicSpline(o,p),r=3;for(g=0;g<f.canvas.width;g+=r)f.lineTo(g,q.interpolate(g));if(f.stroke(),b!==d&&b){a(this.element).find(".volumeHandle").remove();var s,t=function(a,b){var c=b.position.left+4,d=b.position.top+4-e.options.topBarHeight,f=c/e.options.pxPerMs,g=e.options._mcanv.getContext("2d"),h=function(a){return e.MAX_VOL-e.MAX_VOL*a/g.canvas.height},i=b.helper.data("i"),j=!0;i>0&&e.options.volume.x[i-1]>=f&&(j=!1),i<e.options.volume.x.length-1&&e.options.volume.x[i+1]<=f&&(j=!1),j&&(e.options.volume.x[i]=f,e.options.volume.y[i]=h(d))};for(h=this.options.volume.x,i=this.options.volume.y,g=0;g<h.length;g++)s=c.createElement("div"),a(s).addClass("volumeHandle").data("vx",h[g]).data("vy",i[g]).data("i",g).css({left:n(h[g])-4,top:m(i[g])+this.options.topBarHeight-4}).appendTo(this.element).draggable({containment:a(this.element),drag:function(a,b){t(a,b),e._drawVolume(!1)},stop:function(a,b){t(a,b),e._drawVolume(!0)}})}},_createGraph:function(){if(!this.options.hasOwnProperty("musicGraph"))return d;var a=this.options.musicGraph,b=new jsnx.DiGraph;return b.add_nodes_from(a.nodes),console.log("nodes",b),b.add_edges_from(a.edges),console.log("with edges",b),b},_setOption:function(a,b){switch(this.options._dirty=!0,a){case"musicGraph":this.options.musicGraph=b,this.options._graph=this._createGraph();break;default:this.options[a]=b}this._super("_setOption",a,b)}})}(jQuery,window,document),function(a,b,c,d){"use strict";a.widget("edible.timeline",{options:{width:"1200px",tracks:4,wf:[],_dirtyWaveforms:[],pxPerMs:.05,sound:d,position:0,clickMode:"volume",linkGroups:[],_dirty:!0},_create:function(){var b=this;console.log("in timeline _create");var e,f=a("#trackTemplate").html();for(this.element.addClass("edible-timeline"),e=0;e<this.options.tracks;e++)this.element.append(_.template(f));this.element.css("height",95*this.options.tracks+"px"),this.element.find(".track").each(function(b){a(this).css("top",95*b+"px")}).droppable({accept:".edible-waveform",drop:function(c,d){var e=d.draggable,f=a(this);e.parent()!==f&&(e.appendTo(f),e.css("top",0)),a.each(b.options.wf,function(c,d){if(d.elt===e[0]){var g=d.pos;d.pos=b.pxToMs(e.position().left);var h=d.pos-g,i=b.msToPx(h);return a.each(b.element.find(".track"),function(a,b){return f[0]===b?(d.track=a,!1):void 0}),void a.each(b.options.linkGroups,function(c,e){return-1!==e.indexOf(d.elt)?(a.each(b.options.wf,function(b,c){c.elt!==d.elt&&-1!==e.indexOf(c.elt)&&(c.pos+=h,a(c.elt).css("left","+="+i+"px"))}),!1):void 0})}})},hoverClass:"track-drop-hover"}).bind("click.edibletimeline",function(a){var c=b.element.offset(),e=a.pageX-c.left,f=b.element.scrollLeft(),g=(e+f)/b.options.pxPerMs;b._setOptions({position:g}),b.options.sound!==d&&b.options.sound.setPosition(g)}),this.element.css("height",this.element[0].scrollHeight+20+"px");var g=c.createElement("div");a(g).addClass("playhead").css("height",95*this.options.tracks+"px").appendTo(this.element),this.options._dirtyWaveforms=this.options.wf.slice(0),this._refresh()},_refresh:function(){var b=this;a.each(this.options._dirtyWaveforms,function(c,e){b.element.find(".track:eq("+e.track+")").append(e.elt),a(e.elt).css("left",b.msToPx(e.pos)),a(e.elt).wf("option","fixed")||a(e.elt).draggable({containment:".edible-timeline"}),a(e.elt).wf({pxPerMs:b.options.pxPerMs,changed:function(c,f){f[0].changed===d&&(e.pos=b.pxToMs(a(e.elt).position().left))},destroy:function(){var a;for(a=0;a<b.options.wf.length;a++)if(b.options.wf[a]===e){b.options.wf.splice(a,1),b._refresh();break}}})}),a.each(this.options.wf,function(c,d){a(d.elt).unbind("click.edibletimeline"),"split"===b.options.clickMode?a(d.elt).bind("click.edibletimeline",function(c){var e=a(this).wf("slice",c);console.log("POS OF NEW WF",d.pos+e.pos),console.log("POS OF OLD WF",d.pos),b.addWaveform({elt:e.waveform,track:d.track,pos:d.pos+e.pos}),console.log("POS OF OLD WF",d.pos)}):"volume"===b.options.clickMode&&a(d.elt).bind("click.edibletimeline",function(b){a(this).wf("addVolumeMarker",b)})}),this.options._dirtyWaveforms=[],this.element.width(this.options.width);var c;c=this.options.position*this.options.pxPerMs,this.element.find(".playhead").css("left",c+"px")},_destroy:function(){a.each(this.options.wf,function(b,c){a(c.elt).unbind(".edibletimeline").wf("destroy")}),this.element.removeClass("edible-timeline").html("")},addWaveform:function(a){this.options.wf.push(a),this.options._dirtyWaveforms.push(a),this._refresh()},msToPx:function(a){return parseFloat(a)*this.options.pxPerMs},pxToMs:function(a){return parseFloat(a)/this.options.pxPerMs},"export":function(){this.options._dirty=!1;var b=[];return a.each(this.options.wf,function(c,d){if(console.log("SCORE START",d.pos/1e3,"WF POS",d.pos),!a(d.elt).wf("option","mute")){var e=a(d.elt);b.push({globalVolume:e.wf("option","globalVolume"),waveformClass:e.wf("waveformClass"),extra:e.wf("exportExtras"),filename:e.wf("option","filename"),name:e.wf("option","name"),scoreStart:d.pos/1e3,wfStart:e.wf("option","start")/1e3,duration:e.wf("option","len")/1e3})}}),b},isDirty:function(){if(this.options._dirty)return!0;var b;for(b=0;b<this.options.wf.length;b++)if(a(wf.elt).wf("isDirty"))return!0;return!1},_setOptions:function(){this._superApply(arguments),this._refresh()},_setOption:function(a,b){switch(this.options._dirty=!0,a){case"pxPerMs":this.options._dirtyWaveforms=this.options.wf.slice(0),this.options[a]=b;break;default:this.options[a]=b}this._super("_setOption",a,b),this._refresh()}})}(jQuery,window,document),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};window.Waveform=b=function(){function b(a){if(this.redraw=c(this.redraw,this),this.container=a.container,this.canvas=a.canvas,this.data=a.data||[],this.outerColor=a.outerColor||"transparent",this.innerColor=a.innerColor||"#000000",this.interpolate=!0,a.interpolate===!1&&(this.interpolate=!1),null==this.canvas){if(!this.container)throw"Either canvas or container option must be passed";this.canvas=this.createCanvas(this.container,a.width||this.container.clientWidth,a.height||this.container.clientHeight)}this.patchCanvasForIE(this.canvas),this.context=this.canvas.getContext("2d"),this.width=parseInt(this.context.canvas.width,10),this.height=parseInt(this.context.canvas.height,10),a.data&&this.update(a)}return b.name="Waveform",b.prototype.setData=function(a){return this.data=a},b.prototype.setDataInterpolated=function(a){return this.setData(this.interpolateArray(a,this.width))},b.prototype.setDataCropped=function(a){return this.setData(this.expandArray(a,this.width))},b.prototype.update=function(a){return null!=a.interpolate&&(this.interpolate=a.interpolate),this.interpolate===!1?this.setDataCropped(a.data):this.setDataInterpolated(a.data),this.redraw()},b.prototype.redraw=function(){var a,b,c,d,e,f,g,h;for(this.clear(),this.context.fillStyle=this.innerColor,c=this.height/2,b=0,g=this.data,h=[],e=0,f=g.length;f>e;e++)a=g[e],d=this.width/this.data.length,"function"==typeof this.innerColor&&(this.context.fillStyle=this.innerColor(b/this.width,a)),this.context.clearRect(d*b,c-c*a,d,c*a*2),this.context.fillRect(d*b,c-c*a,d,c*a*2),h.push(b++);return h},b.prototype.clear=function(){return this.context.fillStyle=this.outerColor,this.context.clearRect(0,0,this.width,this.height),this.context.fillRect(0,0,this.width,this.height)},b.prototype.patchCanvasForIE=function(a){var b;return"undefined"!=typeof window.G_vmlCanvasManager?(a=window.G_vmlCanvasManager.initElement(a),b=a.getContext,a.getContext=function(){var c;return c=b.apply(a,arguments),a.getContext=b,c}):void 0},b.prototype.createCanvas=function(a,b,c){var d;return d=document.createElement("canvas"),a.appendChild(d),d.width=b,d.height=c,d},b.prototype.expandArray=function(a,b,c){var d,e,f,g;if(null==c&&(c=0),e=[],a.length>b)e=a.slice(a.length-b,a.length);else for(d=f=0,g=b-1;g>=0?g>=f:f>=g;d=g>=0?++f:--f)e[d]=a[d]||c;return e},b.prototype.linearInterpolate=function(a,b,c){return a+(b-a)*c},b.prototype.interpolateArray=function(a,b){var c,d,e,f,g,h,i;for(g=new Array,h=new Number((a.length-1)/(b-1)),g[0]=a[0],f=1;b-1>f;)i=f*h,e=new Number(Math.floor(i)).toFixed(),c=new Number(Math.ceil(i)).toFixed(),d=i-e,g[f]=this.linearInterpolate(a[e],a[c],d),f++;return g[b-1]=a[a.length-1],g},b.prototype.optionsForSyncedStream=function(a){var b,c;return null==a&&(a={}),b=!1,c=this,{whileplaying:this.redraw,whileloading:function(){var d;return b||(d=this,c.innerColor=function(b){return b<d.position/d.durationEstimate?a.playedColor||"rgba(255,  102, 0, 0.8)":b<d.bytesLoaded/d.bytesTotal?a.loadedColor||"rgba(0, 0, 0, 0.8)":a.defaultColor||"rgba(0, 0, 0, 0.4)"},b=!0),this.redraw}}},b.prototype.dataFromSoundCloudTrack=function(b){var c=this;return a.get("http://waveformjs.org/w",{url:b.waveform_url},function(a){return c.update({data:a})})},b}(),a=function(){var a,b,c,d,e,f,g,h,i,j;return g=function(a){var b,c,d;return d=document.createElement("script"),b=!1,d.src=a,d.async=!0,d.onload=d.onreadystatechange=function(){return b||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(b=!0,d.onload=d.onreadystatechange=null,!d||!d.parentNode)?void 0:d.parentNode.removeChild(d)},c||(c=document.getElementsByTagName("head")[0]),c.appendChild(d)},c=function(a){return encodeURIComponent(a)},e=function(d,f,h,i){var k,l;l=-1===(d||"").indexOf("?")?"?":"&",f=f||{};for(k in f)f.hasOwnProperty(k)&&(l+=c(k)+"="+c(f[k])+"&");return e="json"+ ++b,j[e]=function(a){h(a);try{delete j[e]}catch(b){}return j[e]=null},g(d+l+(i||a.callbackName||"callback")+"="+e),e},i=function(a){var b;return b=a},b=0,d=void 0,h=void 0,f=void 0,j=this,a={},{get:e,init:i}}()}.call(this),function(a){function b(b){return a.less[b.split("/")[1]]}function c(){"development"===p.env?(p.optimization=0,p.watchTimer=setInterval(function(){p.watchMode&&e(function(a,b,c,d,e){b&&j(b.toCSS(),d,e.lastModified)})},p.poll)):p.optimization=3}function d(){for(var a=document.getElementsByTagName("style"),b=0;b<a.length;b++)a[b].type.match(x)&&new p.Parser({filename:document.location.href.replace(/#.*$/,""),dumpLineNumbers:p.dumpLineNumbers}).parse(a[b].innerHTML||"",function(c,d){var e=d.toCSS(),f=a[b];f.type="text/css",f.styleSheet?f.styleSheet.cssText=e:f.innerHTML=e})}function e(a,b){for(var c=0;c<p.sheets.length;c++)h(p.sheets[c],a,b,p.sheets.length-(c+1))}function f(a,b){var c,d,e,f,h=g(a),i=g(b),j="";if(h.hostPart!==i.hostPart)return"";for(d=Math.max(i.directories.length,h.directories.length),c=0;d>c&&i.directories[c]===h.directories[c];c++);for(f=i.directories.slice(c),e=h.directories.slice(c),c=0;c<f.length-1;c++)j+="../";for(c=0;c<e.length-1;c++)j+=e[c]+"/";return j}function g(a,b){var c,d,e=/^((?:[a-z-]+:)?\/\/(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/,f=a.match(e),g={},h=[];if(!f)throw new Error("Could not parse sheet href - '"+a+"'");if(!f[1]||f[2]){if(d=b.match(e),!d)throw new Error("Could not parse page url - '"+b+"'");f[1]=d[1],f[2]||(f[3]=d[3]+f[3])}if(f[3])for(h=f[3].replace("\\","/").split("/"),c=0;c<h.length;c++)".."===h[c]&&c>0&&(h.splice(c-1,2),c-=2);return g.hostPart=f[1],g.directories=h,g.path=f[1]+h.join("/"),g.fileUrl=g.path+(f[4]||""),g.url=g.fileUrl+(f[5]||""),g}function h(b,c,d,e){var h,l=b.contents||{},n=b.files||{},q=g(b.href,a.location.href),r=q.url,s=u&&u.getItem(r),t=u&&u.getItem(r+":timestamp"),v={css:s,timestamp:t};h=p.relativeUrls?p.rootpath?b.entryPath?g(p.rootpath+f(q.path,b.entryPath)).path:p.rootpath:q.path:p.rootpath?p.rootpath:b.entryPath?b.entryPath:q.path,k(r,b.type,function(a,f){if(z+=a.replace(/@import .+?;/gi,""),!d&&v&&f&&new Date(f).valueOf()===new Date(v.timestamp).valueOf())j(v.css,b),c(null,null,a,b,{local:!0,remaining:e},r);else try{l[r]=a,new p.Parser({optimization:p.optimization,paths:[q.path],entryPath:b.entryPath||q.path,mime:b.type,filename:r,rootpath:h,relativeUrls:b.relativeUrls,contents:l,files:n,dumpLineNumbers:p.dumpLineNumbers}).parse(a,function(d,g){if(d)return o(d,r);try{c(d,g,a,b,{local:!1,lastModified:f,remaining:e},r),m(document.getElementById("less-error-message:"+i(r)))}catch(d){o(d,r)}})}catch(g){o(g,r)}},function(a,b){throw new Error("Couldn't load "+b+" ("+a+")")})}function i(a){return a.replace(/^[a-z]+:\/\/?[^\/]+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")}function j(a,b,c){var d,e=b.href||"",f="less:"+(b.title||i(e));if(null===(d=document.getElementById(f))){d=document.createElement("style"),d.type="text/css",b.media&&(d.media=b.media),d.id=f;var g=b&&b.nextSibling||null;(g||document.getElementsByTagName("head")[0]).parentNode.insertBefore(d,g)}if(d.styleSheet)try{d.styleSheet.cssText=a}catch(h){throw new Error("Couldn't reassign styleSheet.cssText.")}else(function(a){d.childNodes.length>0?d.firstChild.nodeValue!==a.nodeValue&&d.replaceChild(a,d.firstChild):d.appendChild(a)})(document.createTextNode(a));if(c&&u){n("saving "+e+" to cache.");try{u.setItem(e,a),u.setItem(e+":timestamp",c)}catch(h){n("failed to save")}}}function k(a,b,c,d){function e(b,c,d){b.status>=200&&b.status<300?c(b.responseText,b.getResponseHeader("Last-Modified")):"function"==typeof d&&d(b.status,a)}var f=l(),g=r?p.fileAsync:p.async;"function"==typeof f.overrideMimeType&&f.overrideMimeType("text/css"),f.open("GET",a,g),f.setRequestHeader("Accept",b||"text/x-less, text/css; q=0.9, */*; q=0.5"),f.send(null),r&&!p.fileAsync?0===f.status||f.status>=200&&f.status<300?c(f.responseText):d(f.status,a):g?f.onreadystatechange=function(){4==f.readyState&&e(f,c,d)}:e(f,c,d)}function l(){if(a.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(b){return n("browser doesn't support AJAX."),null}}function m(a){return a&&a.parentNode.removeChild(a)}function n(a){"development"==p.env&&"undefined"!=typeof console&&console.log("less: "+a)}function o(a,b){var c,d,e="less-error-message:"+i(b),f='<li><label>{line}</label><pre class="{class}">{content}</pre></li>',g=document.createElement("div"),h=[],k=a.filename||b,l=k.match(/([^\/]+(\?.*)?)$/)[1];g.id=e,g.className="less-error-message",d="<h3>"+(a.message||"There is an error in your .less file")+'</h3><p>in <a href="'+k+'">'+l+"</a> ";var m=function(a,b,c){a.extract[b]&&h.push(f.replace(/\{line\}/,parseInt(a.line)+(b-1)).replace(/\{class\}/,c).replace(/\{content\}/,a.extract[b]))};a.stack?d+="<br/>"+a.stack.split("\n").slice(1).join("<br/>"):a.extract&&(m(a,0,""),m(a,1,"line"),m(a,2,""),d+="on line "+a.line+", column "+(a.column+1)+":</p><ul>"+h.join("")+"</ul>"),g.innerHTML=d,j([".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #dd6666;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.line {","color: #ff0000;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"}),g.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";"),"development"==p.env&&(c=setInterval(function(){document.body&&(document.getElementById(e)?document.body.replaceChild(g,document.getElementById(e)):document.body.insertBefore(g,document.body.firstChild),clearInterval(c))},10))}Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)||a instanceof Array}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=this.length>>>0,d=0;c>d;d++)d in this&&a.call(b,this[d],d,this)}),Array.prototype.map||(Array.prototype.map=function(a){for(var b=this.length>>>0,c=new Array(b),d=arguments[1],e=0;b>e;e++)e in this&&(c[e]=a.call(d,this[e],e,this));return c}),Array.prototype.filter||(Array.prototype.filter=function(a){for(var b=[],c=arguments[1],d=0;d<this.length;d++)a.call(c,this[d])&&b.push(this[d]);return b}),Array.prototype.reduce||(Array.prototype.reduce=function(a){var b=this.length>>>0,c=0;if(0===b&&1===arguments.length)throw new TypeError;if(arguments.length>=2)var d=arguments[1];else for(;;){if(c in this){d=this[c++];break}if(++c>=b)throw new TypeError}for(;b>c;c++)c in this&&(d=a.call(null,d,this[c],c,this));return d}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length,c=arguments[1]||0;if(!b)return-1;if(c>=b)return-1;for(0>c&&(c+=b);b>c;c++)if(Object.prototype.hasOwnProperty.call(this,c)&&a===this[c])return c;return-1}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}),String.prototype.trim||(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")});var p,q;"object"==typeof environment&&"[object Environment]"==={}.toString.call(environment)?(p="undefined"==typeof a?{}:a.less={},q=p.tree={},p.mode="rhino"):"undefined"==typeof a?(p=exports,q=b("./tree"),p.mode="node"):("undefined"==typeof a.less&&(a.less={}),p=a.less,q=a.less.tree={},p.mode="browser"),p.Parser=function(a){function c(){v=y[u],w=t,z=t}function d(){y[u]=v,t=w,z=t}function e(){t>z&&(y[u]=y[u].slice(t-z),z=t)}function f(a){var b=a.charCodeAt(0);return 32===b||10===b||9===b}function g(a){var b,c;if(a instanceof Function)return a.call(A.parsers);if("string"==typeof a)b=s.charAt(t)===a?a:null,c=1,e();else{if(e(),!(b=a.exec(y[u])))return null;c=b[0].length}return b?(h(c),"string"==typeof b?b:1===b.length?b[0]:b):void 0}function h(a){for(var b=t,c=u,d=t+y[u].length,e=t+=a;d>t&&f(s.charAt(t));)t++;return y[u]=y[u].slice(a+(t-e)),z=t,0===y[u].length&&u<y.length-1&&u++,b!==t||c!==u}function i(a,b){var c=g(a);return c?c:void j(b||("string"==typeof a?"expected '"+a+"' got '"+s.charAt(t)+"'":"unexpected token"))}function j(a,b){var c=new Error(a);throw c.index=t,c.type=b||"Syntax",c}function k(a){return"string"==typeof a?s.charAt(t)===a:a.test(y[u])?!0:!1}function l(a,b){return a.filename&&b.filename&&a.filename!==b.filename?A.imports.contents[a.filename]:s}function m(a,b){for(var c=a,d=-1;c>=0&&"\n"!==b.charAt(c);c--)d++;return{line:"number"==typeof a?(b.slice(0,a).match(/\n/g)||"").length:null,column:d}}function n(a){return"browser"===p.mode||"rhino"===p.mode?a.filename:b("path").resolve(a.filename)}function o(a,b,c){return{lineNumber:m(a,b).line+1,fileName:n(c)}}function r(a,b){var c=l(a,b),d=m(a.index,c),e=d.line,f=d.column,g=c.split("\n");this.type=a.type||"Syntax",this.message=a.message,this.filename=a.filename||b.filename,this.index=a.index,this.line="number"==typeof e?e+1:null,this.callLine=a.call&&m(a.call,c).line+1,this.callExtract=g[m(a.call,c).line],this.stack=a.stack,this.column=f,this.extract=[g[e-1],g[e],g[e+1]]}var s,t,u,v,w,x,y,z,A,a=a||{};a.contents||(a.contents={}),a.rootpath=a.rootpath||"",a.files||(a.files={});var B=function(){},C=this.imports={paths:a.paths||[],queue:[],files:a.files,contents:a.contents,mime:a.mime,error:null,push:function(b,c){var d=this;this.queue.push(b),p.Parser.importer(b,this.paths,function(a,e,f){d.queue.splice(d.queue.indexOf(b),1);var g=f in d.files;d.files[f]=e,a&&!d.error&&(d.error=a),c(a,e,g),0===d.queue.length&&B(d.error)},a)}};return this.env=a=a||{},this.optimization="optimization"in this.env?this.env.optimization:1,this.env.filename=this.env.filename||null,A={imports:C,parse:function(c,d){var e,f,h,i=null;if(t=u=z=x=0,s=c.replace(/\r\n/g,"\n"),s=s.replace(/^\uFEFF/,""),y=function(b){for(var c,d,e,f,g=0,h=/(?:@\{[\w-]+\}|[^"'`\{\}\/\(\)\\])+/g,j=/\/\*(?:[^*]|\*+[^\/*])*\*+\/|\/\/.*/g,k=/"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'|`((?:[^`]|\\.)*)`/g,l=0,m=b[0],n=0;n<s.length;)if(h.lastIndex=n,(c=h.exec(s))&&c.index===n&&(n+=c[0].length,m.push(c[0])),e=s.charAt(n),j.lastIndex=k.lastIndex=n,(c=k.exec(s))&&c.index===n)n+=c[0].length,m.push(c[0]);else if(d||"/"!==e||(f=s.charAt(n+1),"/"!==f&&"*"!==f||!(c=j.exec(s))||c.index!==n)){switch(e){case"{":if(!d){l++,m.push(e);break}case"}":if(!d){l--,m.push(e),b[++g]=m=[];break}case"(":if(!d){d=!0,m.push(e);break}case")":if(d){d=!1,m.push(e);break}default:m.push(e)}n++}else n+=c[0].length,m.push(c[0]);return 0!=l&&(i=new r({index:n-1,type:"Parse",message:l>0?"missing closing `}`":"missing opening `{`",filename:a.filename},a)),b.map(function(a){return a.join("")})}([[]]),i)return d(i,a);try{e=new q.Ruleset([],g(this.parsers.primary)),e.root=!0}catch(j){return d(new r(j,a))}if(e.toCSS=function(c){return function(d,e){var f,g=[];d=d||{},"object"==typeof e&&!Array.isArray(e)&&(e=Object.keys(e).map(function(a){var b=e[a];return b instanceof q.Value||(b instanceof q.Expression||(b=new q.Expression([b])),b=new q.Value([b])),new q.Rule("@"+a,b,!1,0)}),g=[new q.Ruleset(null,e)]);try{var h=c.call(this,{frames:g}).toCSS([],{compress:d.compress||!1,dumpLineNumbers:a.dumpLineNumbers})}catch(i){throw new r(i,a)}if(f=A.imports.error)throw f instanceof r?f:new r(f,a);return d.yuicompress&&"node"===p.mode?b("ycssmin").cssmin(h):d.compress?h.replace(/(\s)+/g,"$1"):h}}(e.eval),t<s.length-1){t=x,h=s.split("\n"),f=(s.slice(0,t).match(/\n/g)||"").length+1;for(var k=t,l=-1;k>=0&&"\n"!==s.charAt(k);k--)l++;i={type:"Parse",message:"Syntax Error on line "+f,index:t,filename:a.filename,line:f,column:l,extract:[h[f-2],h[f-1],h[f]]}}this.imports.queue.length>0?B=function(a){a=i||a,a?d(a):d(null,e)}:d(i,e)},parsers:{primary:function(){for(var a,b=[];(a=g(this.mixin.definition)||g(this.rule)||g(this.ruleset)||g(this.mixin.call)||g(this.comment)||g(this.directive))||g(/^[\s\n]+/)||g(/^;+/);)a&&b.push(a);return b},comment:function(){var a;if("/"===s.charAt(t))return"/"===s.charAt(t+1)?new q.Comment(g(/^\/\/.*/),!0):(a=g(/^\/\*(?:[^*]|\*+[^\/*])*\*+\/\n?/))?new q.Comment(a):void 0},entities:{quoted:function(){var a,b,c=t;return"~"===s.charAt(c)&&(c++,b=!0),'"'===s.charAt(c)||"'"===s.charAt(c)?(b&&g("~"),(a=g(/^"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'/))?new q.Quoted(a[0],a[1]||a[2],b):void 0):void 0},keyword:function(){var a;return(a=g(/^[_A-Za-z-][_A-Za-z0-9-]*/))?q.colors.hasOwnProperty(a)?new q.Color(q.colors[a].slice(1)):new q.Keyword(a):void 0},call:function(){var b,c,d,e,f=t;if(b=/^([\w-]+|%|progid:[\w\.]+)\(/.exec(y[u])){if(b=b[1],c=b.toLowerCase(),"url"===c)return null;if(t+=b.length,"alpha"===c&&(e=g(this.alpha),"undefined"!=typeof e))return e;if(g("("),d=g(this.entities.arguments),g(")"))return b?new q.Call(b,d,f,a.filename):void 0}},arguments:function(){for(var a,b=[];(a=g(this.entities.assignment)||g(this.expression))&&(b.push(a),g(",")););return b},literal:function(){return g(this.entities.ratio)||g(this.entities.dimension)||g(this.entities.color)||g(this.entities.quoted)||g(this.entities.unicodeDescriptor)},assignment:function(){var a,b;return(a=g(/^\w+(?=\s?=)/i))&&g("=")&&(b=g(this.entity))?new q.Assignment(a,b):void 0},url:function(){var b;if("u"===s.charAt(t)&&g(/^url\(/))return b=g(this.entities.quoted)||g(this.entities.variable)||g(/^(?:(?:\\[\(\)'"])|[^\(\)'"])+/)||"",i(")"),new q.URL(null!=b.value||b instanceof q.Variable?b:new q.Anonymous(b),a.rootpath)},variable:function(){var b,c=t;return"@"===s.charAt(t)&&(b=g(/^@@?[\w-]+/))?new q.Variable(b,c,a.filename):void 0},variableCurly:function(){var b,c=t;return"@"===s.charAt(t)&&(b=g(/^@\{([\w-]+)\}/))?new q.Variable("@"+b[1],c,a.filename):void 0},color:function(){var a;return"#"===s.charAt(t)&&(a=g(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/))?new q.Color(a[1]):void 0},dimension:function(){var a,b=s.charCodeAt(t);if(!(b>57||43>b||47===b||44==b))return(a=g(/^([+-]?\d*\.?\d+)(px|%|em|pc|ex|in|deg|s|ms|pt|cm|mm|rad|grad|turn|dpi|dpcm|dppx|rem|vw|vh|vmin|vm|ch)?/))?new q.Dimension(a[1],a[2]):void 0},ratio:function(){var a,b=s.charCodeAt(t);if(!(b>57||48>b))return(a=g(/^(\d+\/\d+)/))?new q.Ratio(a[1]):void 0},unicodeDescriptor:function(){var a;return(a=g(/^U\+[0-9a-fA-F?]+(\-[0-9a-fA-F?]+)?/))?new q.UnicodeDescriptor(a[0]):void 0},javascript:function(){var a,b,c=t;return"~"===s.charAt(c)&&(c++,b=!0),"`"===s.charAt(c)?(b&&g("~"),(a=g(/^`([^`]*)`/))?new q.JavaScript(a[1],t,b):void 0):void 0}},variable:function(){var a;return"@"===s.charAt(t)&&(a=g(/^(@[\w-]+)\s*:/))?a[1]:void 0},shorthand:function(){var a,b;if(k(/^[@\w.%-]+\/[@\w.-]+/))return c(),(a=g(this.entity))&&g("/")&&(b=g(this.entity))?new q.Shorthand(a,b):void d()},mixin:{call:function(){var b,e,f,h,l,m,n,o,p,r,u=[],v=[],w=[],x=t,y=s.charAt(t),z=!1;if("."===y||"#"===y){for(c();b=g(/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/);)u.push(new q.Element(e,b,t)),e=g(">");if(g("(")){for(m=[];h=g(this.expression);){if(l=null,r=h,1==h.value.length){var A=h.value[0];A instanceof q.Variable&&g(":")&&(m.length>0&&(n&&j("Cannot mix ; and , as delimiter types"),o=!0),r=i(this.expression),l=p=A.name)}m.push(r),w.push({name:l,value:r}),g(",")||(g(";")||n)&&(o&&j("Cannot mix ; and , as delimiter types"),n=!0,m.length>1&&(r=new q.Value(m)),v.push({name:p,value:r}),p=null,m=[],o=!1)}i(")")}return f=n?v:w,g(this.important)&&(z=!0),u.length>0&&(g(";")||k("}"))?new q.mixin.Call(u,f,x,a.filename,z):void d()}},definition:function(){var a,b,e,f,h,j,l=[],m=!1;if(!("."!==s.charAt(t)&&"#"!==s.charAt(t)||k(/^[^{]*\}/))&&(c(),b=g(/^([#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\s*\(/))){a=b[1];do{if(g(this.comment),"."===s.charAt(t)&&g(/^\.{3}/)){m=!0,l.push({variadic:!0});break}if(!(f=g(this.entities.variable)||g(this.entities.literal)||g(this.entities.keyword)))break;if(f instanceof q.Variable)if(g(":"))h=i(this.expression,"expected expression"),l.push({name:f.name,value:h});else{if(g(/^\.{3}/)){l.push({name:f.name,variadic:!0}),m=!0;break}l.push({name:f.name})}else l.push({value:f})}while(g(",")||g(";"));if(g(")")||(x=t,d()),g(this.comment),g(/^when/)&&(j=i(this.conditions,"expected condition")),e=g(this.block),e)return new q.mixin.Definition(a,l,e,j,m);d()}}},entity:function(){return g(this.entities.literal)||g(this.entities.variable)||g(this.entities.url)||g(this.entities.call)||g(this.entities.keyword)||g(this.entities.javascript)||g(this.comment)},end:function(){return g(";")||k("}")},alpha:function(){var a;if(g(/^\(opacity=/i))return(a=g(/^\d+/)||g(this.entities.variable))?(i(")"),new q.Alpha(a)):void 0},element:function(){var a,b,c;return b=g(this.combinator),a=g(/^(?:\d+\.\d+|\d+)%/)||g(/^(?:[.#]?|:*)(?:[\w-]|[^\x00-\x9f]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)||g("*")||g("&")||g(this.attribute)||g(/^\([^()@]+\)/)||g(/^[\.#](?=@)/)||g(this.entities.variableCurly),a||g("(")&&(c=g(this.entities.variableCurly)||g(this.entities.variable)||g(this.selector))&&g(")")&&(a=new q.Paren(c)),a?new q.Element(b,a,t):void 0},combinator:function(){var a=s.charAt(t);if(">"===a||"+"===a||"~"===a||"|"===a){for(t++;s.charAt(t).match(/\s/);)t++;return new q.Combinator(a)}return new q.Combinator(s.charAt(t-1).match(/\s/)?" ":null)},selector:function(){var a,b,c,d=[];if(g("("))return a=g(this.entity),g(")")?new q.Selector([new q.Element("",a,t)]):null;for(;(b=g(this.element))&&(c=s.charAt(t),d.push(b),"{"!==c&&"}"!==c&&";"!==c&&","!==c&&")"!==c););return d.length>0?new q.Selector(d):void 0},attribute:function(){var a,b,c,d="";if(g("[")&&((a=g(/^(?:[_A-Za-z0-9-]|\\.)+/)||g(this.entities.quoted))&&(d=(c=g(/^[|~*$^]?=/))&&(b=g(this.entities.quoted)||g(/^[\w-]+/))?[a,c,b.toCSS?b.toCSS():b].join(""):a),g("]")))return d?"["+d+"]":void 0},block:function(){var a;return g("{")&&(a=g(this.primary))&&g("}")?a:void 0},ruleset:function(){var b,e,f,h=[];for(c(),a.dumpLineNumbers&&(f=o(t,s,a));(b=g(this.selector))&&(h.push(b),g(this.comment),g(","));)g(this.comment);if(h.length>0&&(e=g(this.block))){var i=new q.Ruleset(h,e,a.strictImports);return a.dumpLineNumbers&&(i.debugInfo=f),i}x=t,d()},rule:function(){var a,b,e,f,h=s.charAt(t);if(c(),"."!==h&&"#"!==h&&"&"!==h&&(a=g(this.variable)||g(this.property))){if("@"!=a.charAt(0)&&(f=/^([^@+\/'"*`(;{}-]*);/.exec(y[u]))?(t+=f[0].length-1,b=new q.Anonymous(f[1])):b=g("font"===a?this.font:this.value),e=g(this.important),b&&g(this.end))return new q.Rule(a,b,e,w);x=t,d()}},"import":function(){var b,e,f=t;c();var h=g(/^@import(?:-(once))?\s+/);return h&&(b=g(this.entities.quoted)||g(this.entities.url))&&(e=g(this.mediaFeatures),g(";"))?new q.Import(b,C,e,"once"===h[1],f,a.rootpath):void d()},mediaFeature:function(){var a,b,c=[];do if(a=g(this.entities.keyword))c.push(a);else if(g("(")){if(b=g(this.property),a=g(this.entity),!g(")"))return null;if(b&&a)c.push(new q.Paren(new q.Rule(b,a,null,t,!0)));else{if(!a)return null;c.push(new q.Paren(a))
}}while(a);return c.length>0?new q.Expression(c):void 0},mediaFeatures:function(){var a,b=[];do if(a=g(this.mediaFeature)){if(b.push(a),!g(","))break}else if((a=g(this.entities.variable))&&(b.push(a),!g(",")))break;while(a);return b.length>0?b:null},media:function(){var b,c,d,e;return a.dumpLineNumbers&&(e=o(t,s,a)),g(/^@media/)&&(b=g(this.mediaFeatures),c=g(this.block))?(d=new q.Media(c,b),a.dumpLineNumbers&&(d.debugInfo=e),d):void 0},directive:function(){var b,e,f,h,i,j,k;if("@"===s.charAt(t)){if(e=g(this["import"])||g(this.media))return e;if(c(),b=g(/^@[a-z-]+/)){switch(h=b,"-"==b.charAt(1)&&b.indexOf("-",2)>0&&(h="@"+b.slice(b.indexOf("-",2)+1)),h){case"@font-face":i=!0;break;case"@viewport":case"@top-left":case"@top-left-corner":case"@top-center":case"@top-right":case"@top-right-corner":case"@bottom-left":case"@bottom-left-corner":case"@bottom-center":case"@bottom-right":case"@bottom-right-corner":case"@left-top":case"@left-middle":case"@left-bottom":case"@right-top":case"@right-middle":case"@right-bottom":i=!0;break;case"@page":case"@document":case"@supports":case"@keyframes":i=!0,j=!0;break;case"@namespace":k=!0}if(j&&(b+=" "+(g(/^[^{]+/)||"").trim()),i){if(f=g(this.block))return new q.Directive(b,f)}else if((e=g(k?this.expression:this.entity))&&g(";")){var l=new q.Directive(b,e);return a.dumpLineNumbers&&(l.debugInfo=o(t,s,a)),l}d()}}},font:function(){for(var a,b=[],c=[];a=g(this.shorthand)||g(this.entity);)c.push(a);if(b.push(new q.Expression(c)),g(","))for(;(a=g(this.expression))&&(b.push(a),g(",")););return new q.Value(b)},value:function(){for(var a,b=[];(a=g(this.expression))&&(b.push(a),g(",")););return b.length>0?new q.Value(b):void 0},important:function(){return"!"===s.charAt(t)?g(/^! *important/):void 0},sub:function(){var a;return g("(")&&(a=g(this.expression))&&g(")")?a:void 0},multiplication:function(){var a,b,c,d;if(a=g(this.operand)){for(;!k(/^\/[*\/]/)&&(c=g("/")||g("*"))&&(b=g(this.operand));)d=new q.Operation(c,[d||a,b]);return d||a}},addition:function(){var a,b,c,d;if(a=g(this.multiplication)){for(;(c=g(/^[-+]\s+/)||!f(s.charAt(t-1))&&(g("+")||g("-")))&&(b=g(this.multiplication));)d=new q.Operation(c,[d||a,b]);return d||a}},conditions:function(){var a,b,c,d=t;if(a=g(this.condition)){for(;g(",")&&(b=g(this.condition));)c=new q.Condition("or",c||a,b,d);return c||a}},condition:function(){var a,b,c,d,e=t,f=!1;return g(/^not/)&&(f=!0),i("("),(a=g(this.addition)||g(this.entities.keyword)||g(this.entities.quoted))?((d=g(/^(?:>=|=<|[<=>])/))?(b=g(this.addition)||g(this.entities.keyword)||g(this.entities.quoted))?c=new q.Condition(d,a,b,e,f):j("expected expression"):c=new q.Condition("=",a,new q.Keyword("true"),e,f),i(")"),g(/^and/)?new q.Condition("and",c,g(this.condition)):c):void 0},operand:function(){var a,b=s.charAt(t+1);"-"===s.charAt(t)&&("@"===b||"("===b)&&(a=g("-"));var c=g(this.sub)||g(this.entities.dimension)||g(this.entities.color)||g(this.entities.variable)||g(this.entities.call);return a?new q.Operation("*",[new q.Dimension(-1),c]):c},expression:function(){for(var a,b=[];a=g(this.addition)||g(this.entity);)b.push(a);return b.length>0?new q.Expression(b):void 0},property:function(){var a;return(a=g(/^(\*?-?[_a-z0-9-]+)\s*:/))?a[1]:void 0}}}},("browser"===p.mode||"rhino"===p.mode)&&(p.Parser.importer=function(a,b,c,d){!/^([a-z-]+:)?\//.test(a)&&b.length>0&&(a=b[0]+a),h({href:a,title:a,type:d.mime,contents:d.contents,files:d.files,rootpath:d.rootpath,entryPath:d.entryPath,relativeUrls:d.relativeUrls},function(a,e,f,g,h,i){a&&"function"==typeof d.errback?d.errback.call(null,i,b,c,d):c.call(null,a,e,i)},!0)}),function(a){function b(b){return a.functions.hsla(b.h,b.s,b.l,b.a)}function c(b,c){return b instanceof a.Dimension&&"%"==b.unit?parseFloat(b.value*c/100):d(b)}function d(b){if(b instanceof a.Dimension)return parseFloat("%"==b.unit?b.value/100:b.value);if("number"==typeof b)return b;throw{error:"RuntimeError",message:"color functions take numbers as parameters"}}function e(a){return Math.min(1,Math.max(0,a))}a.functions={rgb:function(a,b,c){return this.rgba(a,b,c,1)},rgba:function(b,e,f,g){var h=[b,e,f].map(function(a){return c(a,256)});return g=d(g),new a.Color(h,g)},hsl:function(a,b,c){return this.hsla(a,b,c,1)},hsla:function(a,b,c,e){function f(a){return a=0>a?a+1:a>1?a-1:a,1>6*a?h+(g-h)*a*6:1>2*a?g:2>3*a?h+(g-h)*(2/3-a)*6:h}a=d(a)%360/360,b=d(b),c=d(c),e=d(e);var g=.5>=c?c*(b+1):c+b-c*b,h=2*c-g;return this.rgba(255*f(a+1/3),255*f(a),255*f(a-1/3),e)},hsv:function(a,b,c){return this.hsva(a,b,c,1)},hsva:function(a,b,c,e){a=d(a)%360/360*360,b=d(b),c=d(c),e=d(e);var f,g;f=Math.floor(a/60%6),g=a/60-f;var h=[c,c*(1-b),c*(1-g*b),c*(1-(1-g)*b)],i=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return this.rgba(255*h[i[f][0]],255*h[i[f][1]],255*h[i[f][2]],e)},hue:function(b){return new a.Dimension(Math.round(b.toHSL().h))},saturation:function(b){return new a.Dimension(Math.round(100*b.toHSL().s),"%")},lightness:function(b){return new a.Dimension(Math.round(100*b.toHSL().l),"%")},red:function(b){return new a.Dimension(b.rgb[0])},green:function(b){return new a.Dimension(b.rgb[1])},blue:function(b){return new a.Dimension(b.rgb[2])},alpha:function(b){return new a.Dimension(b.toHSL().a)},luma:function(b){return new a.Dimension(Math.round((.2126*(b.rgb[0]/255)+.7152*(b.rgb[1]/255)+.0722*(b.rgb[2]/255))*b.alpha*100),"%")},saturate:function(a,c){var d=a.toHSL();return d.s+=c.value/100,d.s=e(d.s),b(d)},desaturate:function(a,c){var d=a.toHSL();return d.s-=c.value/100,d.s=e(d.s),b(d)},lighten:function(a,c){var d=a.toHSL();return d.l+=c.value/100,d.l=e(d.l),b(d)},darken:function(a,c){var d=a.toHSL();return d.l-=c.value/100,d.l=e(d.l),b(d)},fadein:function(a,c){var d=a.toHSL();return d.a+=c.value/100,d.a=e(d.a),b(d)},fadeout:function(a,c){var d=a.toHSL();return d.a-=c.value/100,d.a=e(d.a),b(d)},fade:function(a,c){var d=a.toHSL();return d.a=c.value/100,d.a=e(d.a),b(d)},spin:function(a,c){var d=a.toHSL(),e=(d.h+c.value)%360;return d.h=0>e?360+e:e,b(d)},mix:function(b,c,d){d||(d=new a.Dimension(50));var e=d.value/100,f=2*e-1,g=b.toHSL().a-c.toHSL().a,h=((f*g==-1?f:(f+g)/(1+f*g))+1)/2,i=1-h,j=[b.rgb[0]*h+c.rgb[0]*i,b.rgb[1]*h+c.rgb[1]*i,b.rgb[2]*h+c.rgb[2]*i],k=b.alpha*e+c.alpha*(1-e);return new a.Color(j,k)},greyscale:function(b){return this.desaturate(b,new a.Dimension(100))},contrast:function(a,b,c,d){return a.rgb?("undefined"==typeof c&&(c=this.rgba(255,255,255,1)),"undefined"==typeof b&&(b=this.rgba(0,0,0,1)),d="undefined"==typeof d?.43:d.value,(.2126*(a.rgb[0]/255)+.7152*(a.rgb[1]/255)+.0722*(a.rgb[2]/255))*a.alpha<d?c:b):null},e:function(b){return new a.Anonymous(b instanceof a.JavaScript?b.evaluated:b)},escape:function(b){return new a.Anonymous(encodeURI(b.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},"%":function(b){for(var c=Array.prototype.slice.call(arguments,1),d=b.value,e=0;e<c.length;e++)d=d.replace(/%[sda]/i,function(a){var b=a.match(/s/i)?c[e].value:c[e].toCSS();return a.match(/[A-Z]$/)?encodeURIComponent(b):b});return d=d.replace(/%%/g,"%"),new a.Quoted('"'+d+'"',d)},unit:function(b,c){return new a.Dimension(b.value,c?c.toCSS():"")},round:function(a,b){var c="undefined"==typeof b?0:b.value;return this._math(function(a){return a.toFixed(c)},a)},ceil:function(a){return this._math(Math.ceil,a)},floor:function(a){return this._math(Math.floor,a)},_math:function(b,c){if(c instanceof a.Dimension)return new a.Dimension(b(parseFloat(c.value)),c.unit);if("number"==typeof c)return b(c);throw{type:"Argument",message:"argument must be a number"}},argb:function(b){return new a.Anonymous(b.toARGB())},percentage:function(b){return new a.Dimension(100*b.value,"%")},color:function(b){if(b instanceof a.Quoted)return new a.Color(b.value.slice(1));throw{type:"Argument",message:"argument must be a string"}},iscolor:function(b){return this._isa(b,a.Color)},isnumber:function(b){return this._isa(b,a.Dimension)},isstring:function(b){return this._isa(b,a.Quoted)},iskeyword:function(b){return this._isa(b,a.Keyword)},isurl:function(b){return this._isa(b,a.URL)},ispixel:function(b){return b instanceof a.Dimension&&"px"===b.unit?a.True:a.False},ispercentage:function(b){return b instanceof a.Dimension&&"%"===b.unit?a.True:a.False},isem:function(b){return b instanceof a.Dimension&&"em"===b.unit?a.True:a.False},_isa:function(b,c){return b instanceof c?a.True:a.False},multiply:function(a,b){var c=a.rgb[0]*b.rgb[0]/255,d=a.rgb[1]*b.rgb[1]/255,e=a.rgb[2]*b.rgb[2]/255;return this.rgb(c,d,e)},screen:function(a,b){var c=255-(255-a.rgb[0])*(255-b.rgb[0])/255,d=255-(255-a.rgb[1])*(255-b.rgb[1])/255,e=255-(255-a.rgb[2])*(255-b.rgb[2])/255;return this.rgb(c,d,e)},overlay:function(a,b){var c=a.rgb[0]<128?2*a.rgb[0]*b.rgb[0]/255:255-2*(255-a.rgb[0])*(255-b.rgb[0])/255,d=a.rgb[1]<128?2*a.rgb[1]*b.rgb[1]/255:255-2*(255-a.rgb[1])*(255-b.rgb[1])/255,e=a.rgb[2]<128?2*a.rgb[2]*b.rgb[2]/255:255-2*(255-a.rgb[2])*(255-b.rgb[2])/255;return this.rgb(c,d,e)},softlight:function(a,b){var c=b.rgb[0]*a.rgb[0]/255,d=c+a.rgb[0]*(255-(255-a.rgb[0])*(255-b.rgb[0])/255-c)/255;c=b.rgb[1]*a.rgb[1]/255;var e=c+a.rgb[1]*(255-(255-a.rgb[1])*(255-b.rgb[1])/255-c)/255;c=b.rgb[2]*a.rgb[2]/255;var f=c+a.rgb[2]*(255-(255-a.rgb[2])*(255-b.rgb[2])/255-c)/255;return this.rgb(d,e,f)},hardlight:function(a,b){var c=b.rgb[0]<128?2*b.rgb[0]*a.rgb[0]/255:255-2*(255-b.rgb[0])*(255-a.rgb[0])/255,d=b.rgb[1]<128?2*b.rgb[1]*a.rgb[1]/255:255-2*(255-b.rgb[1])*(255-a.rgb[1])/255,e=b.rgb[2]<128?2*b.rgb[2]*a.rgb[2]/255:255-2*(255-b.rgb[2])*(255-a.rgb[2])/255;return this.rgb(c,d,e)},difference:function(a,b){var c=Math.abs(a.rgb[0]-b.rgb[0]),d=Math.abs(a.rgb[1]-b.rgb[1]),e=Math.abs(a.rgb[2]-b.rgb[2]);return this.rgb(c,d,e)},exclusion:function(a,b){var c=a.rgb[0]+b.rgb[0]*(255-a.rgb[0]-a.rgb[0])/255,d=a.rgb[1]+b.rgb[1]*(255-a.rgb[1]-a.rgb[1])/255,e=a.rgb[2]+b.rgb[2]*(255-a.rgb[2]-a.rgb[2])/255;return this.rgb(c,d,e)},average:function(a,b){var c=(a.rgb[0]+b.rgb[0])/2,d=(a.rgb[1]+b.rgb[1])/2,e=(a.rgb[2]+b.rgb[2])/2;return this.rgb(c,d,e)},negation:function(a,b){var c=255-Math.abs(255-b.rgb[0]-a.rgb[0]),d=255-Math.abs(255-b.rgb[1]-a.rgb[1]),e=255-Math.abs(255-b.rgb[2]-a.rgb[2]);return this.rgb(c,d,e)},tint:function(a,b){return this.mix(this.rgb(255,255,255),a,b)},shade:function(a,b){return this.mix(this.rgb(0,0,0),a,b)}}}(b("./tree")),function(a){a.colors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(b("./tree")),function(a){a.Alpha=function(a){this.value=a},a.Alpha.prototype={toCSS:function(){return"alpha(opacity="+(this.value.toCSS?this.value.toCSS():this.value)+")"},eval:function(a){return this.value.eval&&(this.value=this.value.eval(a)),this}}}(b("../tree")),function(a){a.Anonymous=function(a){this.value=a.value||a},a.Anonymous.prototype={toCSS:function(){return this.value},eval:function(){return this},compare:function(a){if(!a.toCSS)return-1;var b=this.toCSS(),c=a.toCSS();return b===c?0:c>b?-1:1}}}(b("../tree")),function(a){a.Assignment=function(a,b){this.key=a,this.value=b},a.Assignment.prototype={toCSS:function(){return this.key+"="+(this.value.toCSS?this.value.toCSS():this.value)},eval:function(b){return this.value.eval?new a.Assignment(this.key,this.value.eval(b)):this}}}(b("../tree")),function(a){a.Call=function(a,b,c,d){this.name=a,this.args=b,this.index=c,this.filename=d},a.Call.prototype={eval:function(b){var c,d=this.args.map(function(a){return a.eval(b)});if(this.name in a.functions)try{if(c=a.functions[this.name].apply(a.functions,d),null!=c)return c}catch(e){throw{type:e.type||"Runtime",message:"error evaluating function `"+this.name+"`"+(e.message?": "+e.message:""),index:this.index,filename:this.filename}}return new a.Anonymous(this.name+"("+d.map(function(a){return a.toCSS(b)}).join(", ")+")")},toCSS:function(a){return this.eval(a).toCSS()}}}(b("../tree")),function(a){a.Color=function(a,b){this.rgb=Array.isArray(a)?a:6==a.length?a.match(/.{2}/g).map(function(a){return parseInt(a,16)}):a.split("").map(function(a){return parseInt(a+a,16)}),this.alpha="number"==typeof b?b:1},a.Color.prototype={eval:function(){return this},toCSS:function(){return this.alpha<1?"rgba("+this.rgb.map(function(a){return Math.round(a)}).concat(this.alpha).join(", ")+")":"#"+this.rgb.map(function(a){return a=Math.round(a),a=(a>255?255:0>a?0:a).toString(16),1===a.length?"0"+a:a}).join("")},operate:function(b,c){var d=[];c instanceof a.Color||(c=c.toColor());for(var e=0;3>e;e++)d[e]=a.operate(b,this.rgb[e],c.rgb[e]);return new a.Color(d,this.alpha+c.alpha)},toHSL:function(){var a,b,c=this.rgb[0]/255,d=this.rgb[1]/255,e=this.rgb[2]/255,f=this.alpha,g=Math.max(c,d,e),h=Math.min(c,d,e),i=(g+h)/2,j=g-h;if(g===h)a=b=0;else{switch(b=i>.5?j/(2-g-h):j/(g+h),g){case c:a=(d-e)/j+(e>d?6:0);break;case d:a=(e-c)/j+2;break;case e:a=(c-d)/j+4}a/=6}return{h:360*a,s:b,l:i,a:f}},toARGB:function(){var a=[Math.round(255*this.alpha)].concat(this.rgb);return"#"+a.map(function(a){return a=Math.round(a),a=(a>255?255:0>a?0:a).toString(16),1===a.length?"0"+a:a}).join("")},compare:function(a){return a.rgb&&a.rgb[0]===this.rgb[0]&&a.rgb[1]===this.rgb[1]&&a.rgb[2]===this.rgb[2]&&a.alpha===this.alpha?0:-1}}}(b("../tree")),function(a){a.Comment=function(a,b){this.value=a,this.silent=!!b},a.Comment.prototype={toCSS:function(a){return a.compress?"":this.value},eval:function(){return this}}}(b("../tree")),function(a){a.Condition=function(a,b,c,d,e){this.op=a.trim(),this.lvalue=b,this.rvalue=c,this.index=d,this.negate=e},a.Condition.prototype.eval=function(a){var b,c=this.lvalue.eval(a),d=this.rvalue.eval(a),e=this.index,b=function(a){switch(a){case"and":return c&&d;case"or":return c||d;default:if(c.compare)b=c.compare(d);else{if(!d.compare)throw{type:"Type",message:"Unable to perform comparison",index:e};b=d.compare(c)}switch(b){case-1:return"<"===a||"=<"===a;case 0:return"="===a||">="===a||"=<"===a;case 1:return">"===a||">="===a}}}(this.op);return this.negate?!b:b}}(b("../tree")),function(a){a.Dimension=function(a,b){this.value=parseFloat(a),this.unit=b||null},a.Dimension.prototype={eval:function(){return this},toColor:function(){return new a.Color([this.value,this.value,this.value])},toCSS:function(){var a=this.value+this.unit;return a},operate:function(b,c){return new a.Dimension(a.operate(b,this.value,c.value),this.unit||c.unit)},compare:function(b){return b instanceof a.Dimension?b.value>this.value?-1:b.value<this.value?1:b.unit&&this.unit!==b.unit?-1:0:-1}}}(b("../tree")),function(a){a.Directive=function(b,c){this.name=b,Array.isArray(c)?(this.ruleset=new a.Ruleset([],c),this.ruleset.allowImports=!0):this.value=c},a.Directive.prototype={toCSS:function(a,b){return this.ruleset?(this.ruleset.root=!0,this.name+(b.compress?"{":" {\n  ")+this.ruleset.toCSS(a,b).trim().replace(/\n/g,"\n  ")+(b.compress?"}":"\n}\n")):this.name+" "+this.value.toCSS()+";\n"},eval:function(b){var c=this;return this.ruleset&&(b.frames.unshift(this),c=new a.Directive(this.name),c.ruleset=this.ruleset.eval(b),b.frames.shift()),c},variable:function(b){return a.Ruleset.prototype.variable.call(this.ruleset,b)},find:function(){return a.Ruleset.prototype.find.apply(this.ruleset,arguments)},rulesets:function(){return a.Ruleset.prototype.rulesets.apply(this.ruleset)}}}(b("../tree")),function(a){a.Element=function(b,c,d){this.combinator=b instanceof a.Combinator?b:new a.Combinator(b),this.value="string"==typeof c?c.trim():c?c:"",this.index=d},a.Element.prototype.eval=function(b){return new a.Element(this.combinator,this.value.eval?this.value.eval(b):this.value,this.index)},a.Element.prototype.toCSS=function(a){var b=this.value.toCSS?this.value.toCSS(a):this.value;return""==b&&"&"==this.combinator.value.charAt(0)?"":this.combinator.toCSS(a||{})+b},a.Combinator=function(a){this.value=" "===a?" ":a?a.trim():""},a.Combinator.prototype.toCSS=function(a){return{"":""," ":" ",":":" :","+":a.compress?"+":" + ","~":a.compress?"~":" ~ ",">":a.compress?">":" > ","|":a.compress?"|":" | "}[this.value]}}(b("../tree")),function(a){a.Expression=function(a){this.value=a},a.Expression.prototype={eval:function(b){return this.value.length>1?new a.Expression(this.value.map(function(a){return a.eval(b)})):1===this.value.length?this.value[0].eval(b):this},toCSS:function(a){return this.value.map(function(b){return b.toCSS?b.toCSS(a):""}).join(" ")}}}(b("../tree")),function(a){a.Import=function(b,c,d,e,f,g){var h=this;this.once=e,this.index=f,this._path=b,this.features=d&&new a.Value(d),this.rootpath=g,this.path=b instanceof a.Quoted?/(\.[a-z]*$)|([\?;].*)$/.test(b.value)?b.value:b.value+".less":b.value.value||b.value,this.css=/css([\?;].*)?$/.test(this.path),this.css||c.push(this.path,function(b,c,d){b&&(b.index=f),d&&h.once&&(h.skip=d),h.root=c||new a.Ruleset([],[])})},a.Import.prototype={toCSS:function(a){var b=this.features?" "+this.features.toCSS(a):"";return this.css?("string"==typeof this._path.value&&!/^(?:[a-z-]+:|\/)/.test(this._path.value)&&(this._path.value=this.rootpath+this._path.value),"@import "+this._path.toCSS()+b+";\n"):""},eval:function(b){{var c;this.features&&this.features.eval(b)}return this.skip?[]:this.css?this:(c=new a.Ruleset([],this.root.rules.slice(0)),c.evalImports(b),this.features?new a.Media(c.rules,this.features.value):c.rules)}}}(b("../tree")),function(a){a.JavaScript=function(a,b,c){this.escaped=c,this.expression=a,this.index=b},a.JavaScript.prototype={eval:function(b){var c,d=this,e={},f=this.expression.replace(/@\{([\w-]+)\}/g,function(c,e){return a.jsify(new a.Variable("@"+e,d.index).eval(b))});try{f=new Function("return ("+f+")")}catch(g){throw{message:"JavaScript evaluation error: `"+f+"`",index:this.index}}for(var h in b.frames[0].variables())e[h.slice(1)]={value:b.frames[0].variables()[h].value,toJS:function(){return this.value.eval(b).toCSS()}};try{c=f.call(e)}catch(g){throw{message:"JavaScript evaluation error: '"+g.name+": "+g.message+"'",index:this.index}}return"string"==typeof c?new a.Quoted('"'+c+'"',c,this.escaped,this.index):new a.Anonymous(Array.isArray(c)?c.join(", "):c)}}}(b("../tree")),function(a){a.Keyword=function(a){this.value=a},a.Keyword.prototype={eval:function(){return this},toCSS:function(){return this.value},compare:function(b){return b instanceof a.Keyword?b.value===this.value?0:1:-1}},a.True=new a.Keyword("true"),a.False=new a.Keyword("false")}(b("../tree")),function(a){a.Media=function(b,c){var d=this.emptySelectors();this.features=new a.Value(c),this.ruleset=new a.Ruleset(d,b),this.ruleset.allowImports=!0},a.Media.prototype={toCSS:function(a,b){var c=this.features.toCSS(b);return this.ruleset.root=0===a.length||a[0].multiMedia,"@media "+c+(b.compress?"{":" {\n  ")+this.ruleset.toCSS(a,b).trim().replace(/\n/g,"\n  ")+(b.compress?"}":"\n}\n")},eval:function(b){b.mediaBlocks||(b.mediaBlocks=[],b.mediaPath=[]);var c=new a.Media([],[]);return this.debugInfo&&(this.ruleset.debugInfo=this.debugInfo,c.debugInfo=this.debugInfo),c.features=this.features.eval(b),b.mediaPath.push(c),b.mediaBlocks.push(c),b.frames.unshift(this.ruleset),c.ruleset=this.ruleset.eval(b),b.frames.shift(),b.mediaPath.pop(),0===b.mediaPath.length?c.evalTop(b):c.evalNested(b)},variable:function(b){return a.Ruleset.prototype.variable.call(this.ruleset,b)},find:function(){return a.Ruleset.prototype.find.apply(this.ruleset,arguments)},rulesets:function(){return a.Ruleset.prototype.rulesets.apply(this.ruleset)},emptySelectors:function(){var b=new a.Element("","&",0);return[new a.Selector([b])]},evalTop:function(b){var c=this;if(b.mediaBlocks.length>1){var d=this.emptySelectors();c=new a.Ruleset(d,b.mediaBlocks),c.multiMedia=!0}return delete b.mediaBlocks,delete b.mediaPath,c},evalNested:function(b){var c,d,e=b.mediaPath.concat([this]);for(c=0;c<e.length;c++)d=e[c].features instanceof a.Value?e[c].features.value:e[c].features,e[c]=Array.isArray(d)?d:[d];return this.features=new a.Value(this.permute(e).map(function(b){for(b=b.map(function(b){return b.toCSS?b:new a.Anonymous(b)}),c=b.length-1;c>0;c--)b.splice(c,0,new a.Anonymous("and"));return new a.Expression(b)})),new a.Ruleset([],[])},permute:function(a){if(0===a.length)return[];if(1===a.length)return a[0];for(var b=[],c=this.permute(a.slice(1)),d=0;d<c.length;d++)for(var e=0;e<a[0].length;e++)b.push([a[0][e]].concat(c[d]));return b},bubbleSelectors:function(b){this.ruleset=new a.Ruleset(b.slice(0),[this.ruleset])}}}(b("../tree")),function(a){a.mixin={},a.mixin.Call=function(b,c,d,e,f){this.selector=new a.Selector(b),this.arguments=c,this.index=d,this.filename=e,this.important=f},a.mixin.Call.prototype={eval:function(b){var c,d,e,f,g,h,i,j,k=[],l=!1;for(e=this.arguments&&this.arguments.map(function(a){return{name:a.name,value:a.value.eval(b)}}),f=0;f<b.frames.length;f++)if((c=b.frames[f].find(this.selector)).length>0){for(j=!0,g=0;g<c.length;g++){for(d=c[g],i=!1,h=0;h<b.frames.length;h++)if(!(d instanceof a.mixin.Definition)&&d===(b.frames[h].originalRuleset||b.frames[h])){i=!0;break}if(!i&&d.matchArgs(e,b)){if(!d.matchCondition||d.matchCondition(e,b))try{Array.prototype.push.apply(k,d.eval(b,e,this.important).rules)}catch(m){throw{message:m.message,index:this.index,filename:this.filename,stack:m.stack}}l=!0}}if(l)return k}throw j?{type:"Runtime",message:"No matching definition was found for `"+this.selector.toCSS().trim()+"("+(e?e.map(function(a){var b="";return a.name&&(b+=a.name+":"),b+=a.value.toCSS?a.value.toCSS():"???"}).join(", "):"")+")`",index:this.index,filename:this.filename}:{type:"Name",message:this.selector.toCSS().trim()+" is undefined",index:this.index,filename:this.filename}}},a.mixin.Definition=function(b,c,d,e,f){this.name=b,this.selectors=[new a.Selector([new a.Element(null,b)])],this.params=c,this.condition=e,this.variadic=f,this.arity=c.length,this.rules=d,this._lookups={},this.required=c.reduce(function(a,b){return!b.name||b.name&&!b.value?a+1:a},0),this.parent=a.Ruleset.prototype,this.frames=[]},a.mixin.Definition.prototype={toCSS:function(){return""},variable:function(a){return this.parent.variable.call(this,a)},variables:function(){return this.parent.variables.call(this)},find:function(){return this.parent.find.apply(this,arguments)},rulesets:function(){return this.parent.rulesets.apply(this)},evalParams:function(b,c,d,e){var f,g,h,i,j,k,l,m,n=new a.Ruleset(null,[]),o=this.params.slice(0);if(d)for(d=d.slice(0),h=0;h<d.length;h++)if(g=d[h],k=g&&g.name){for(l=!1,i=0;i<o.length;i++)if(!e[i]&&k===o[i].name){e[i]=g.value.eval(b),n.rules.unshift(new a.Rule(k,g.value.eval(b))),l=!0;break}if(l){d.splice(h,1),h--;continue}throw{type:"Runtime",message:"Named argument for "+this.name+" "+d[h].name+" not found"}}for(m=0,h=0;h<o.length;h++)if(!e[h]){if(g=d&&d[m],k=o[h].name)if(o[h].variadic&&d){for(f=[],i=m;i<d.length;i++)f.push(d[i].value.eval(b));n.rules.unshift(new a.Rule(k,new a.Expression(f).eval(b)))}else{if(j=g&&g.value)j=j.eval(b);else{if(!o[h].value)throw{type:"Runtime",message:"wrong number of arguments for "+this.name+" ("+d.length+" for "+this.arity+")"};j=o[h].value.eval(c)}n.rules.unshift(new a.Rule(k,j)),e[h]=j}if(o[h].variadic&&d)for(i=m;i<d.length;i++)e[i]=d[i].value.eval(b);m++}return n},eval:function(b,c,d){var e,f,g=[],h=this.frames.concat(b.frames),i=this.evalParams(b,{frames:h},c,g);return i.rules.unshift(new a.Rule("@arguments",new a.Expression(g).eval(b))),e=d?this.parent.makeImportant.apply(this).rules:this.rules.slice(0),f=new a.Ruleset(null,e).eval({frames:[this,i].concat(h)}),f.originalRuleset=this,f},matchCondition:function(a,b){return this.condition&&!this.condition.eval({frames:[this.evalParams(b,{frames:this.frames.concat(b.frames)},a,[])].concat(b.frames)})?!1:!0},matchArgs:function(a,b){var c,d=a&&a.length||0;if(!this.variadic){if(d<this.required)return!1;if(d>this.params.length)return!1;if(this.required>0&&d>this.params.length)return!1}c=Math.min(d,this.arity);for(var e=0;c>e;e++)if(!this.params[e].name&&!this.params[e].variadic&&a[e].value.eval(b).toCSS()!=this.params[e].value.eval(b).toCSS())return!1;return!0}}}(b("../tree")),function(a){a.Operation=function(a,b){this.op=a.trim(),this.operands=b},a.Operation.prototype.eval=function(b){var c,d=this.operands[0].eval(b),e=this.operands[1].eval(b);if(d instanceof a.Dimension&&e instanceof a.Color){if("*"!==this.op&&"+"!==this.op)throw{name:"OperationError",message:"Can't substract or divide a color from a number"};c=e,e=d,d=c}if(!d.operate)throw{name:"OperationError",message:"Operation on an invalid type"};return d.operate(this.op,e)},a.operate=function(a,b,c){switch(a){case"+":return b+c;case"-":return b-c;case"*":return b*c;case"/":return b/c}}}(b("../tree")),function(a){a.Paren=function(a){this.value=a},a.Paren.prototype={toCSS:function(a){return"("+this.value.toCSS(a)+")"},eval:function(b){return new a.Paren(this.value.eval(b))}}}(b("../tree")),function(a){a.Quoted=function(a,b,c,d){this.escaped=c,this.value=b||"",this.quote=a.charAt(0),this.index=d},a.Quoted.prototype={toCSS:function(){return this.escaped?this.value:this.quote+this.value+this.quote},eval:function(b){var c=this,d=this.value.replace(/`([^`]+)`/g,function(d,e){return new a.JavaScript(e,c.index,!0).eval(b).value}).replace(/@\{([\w-]+)\}/g,function(d,e){var f=new a.Variable("@"+e,c.index).eval(b);return f instanceof a.Quoted?f.value:f.toCSS()});return new a.Quoted(this.quote+d+this.quote,d,this.escaped,this.index)},compare:function(a){if(!a.toCSS)return-1;var b=this.toCSS(),c=a.toCSS();return b===c?0:c>b?-1:1}}}(b("../tree")),function(a){a.Ratio=function(a){this.value=a},a.Ratio.prototype={toCSS:function(){return this.value},eval:function(){return this}}}(b("../tree")),function(a){a.Rule=function(b,c,d,e,f){this.name=b,this.value=c instanceof a.Value?c:new a.Value([c]),this.important=d?" "+d.trim():"",this.index=e,this.inline=f||!1,this.variable="@"===b.charAt(0)?!0:!1},a.Rule.prototype.toCSS=function(a){return this.variable?"":this.name+(a.compress?":":": ")+this.value.toCSS(a)+this.important+(this.inline?"":";")},a.Rule.prototype.eval=function(b){return new a.Rule(this.name,this.value.eval(b),this.important,this.index,this.inline)},a.Rule.prototype.makeImportant=function(){return new a.Rule(this.name,this.value,"!important",this.index,this.inline)},a.Shorthand=function(a,b){this.a=a,this.b=b},a.Shorthand.prototype={toCSS:function(a){return this.a.toCSS(a)+"/"+this.b.toCSS(a)},eval:function(){return this}}}(b("../tree")),function(a){a.Ruleset=function(a,b,c){this.selectors=a,this.rules=b,this._lookups={},this.strictImports=c},a.Ruleset.prototype={eval:function(b){var c,d=this.selectors&&this.selectors.map(function(a){return a.eval(b)}),e=new a.Ruleset(d,this.rules.slice(0),this.strictImports);e.originalRuleset=this,e.root=this.root,e.allowImports=this.allowImports,this.debugInfo&&(e.debugInfo=this.debugInfo),b.frames.unshift(e),(e.root||e.allowImports||!e.strictImports)&&e.evalImports(b);for(var f=0;f<e.rules.length;f++)e.rules[f]instanceof a.mixin.Definition&&(e.rules[f].frames=b.frames.slice(0));for(var g=b.mediaBlocks&&b.mediaBlocks.length||0,f=0;f<e.rules.length;f++)e.rules[f]instanceof a.mixin.Call&&(c=e.rules[f].eval(b),e.rules.splice.apply(e.rules,[f,1].concat(c)),f+=c.length-1,e.resetCache());for(var h,f=0;f<e.rules.length;f++)h=e.rules[f],h instanceof a.mixin.Definition||(e.rules[f]=h.eval?h.eval(b):h);if(b.frames.shift(),b.mediaBlocks)for(var f=g;f<b.mediaBlocks.length;f++)b.mediaBlocks[f].bubbleSelectors(d);return e},evalImports:function(b){var c,d;for(c=0;c<this.rules.length;c++)this.rules[c]instanceof a.Import&&(d=this.rules[c].eval(b),"number"==typeof d.length?(this.rules.splice.apply(this.rules,[c,1].concat(d)),c+=d.length-1):this.rules.splice(c,1,d),this.resetCache())},makeImportant:function(){return new a.Ruleset(this.selectors,this.rules.map(function(a){return a.makeImportant?a.makeImportant():a}),this.strictImports)},matchArgs:function(a){return!a||0===a.length},resetCache:function(){this._rulesets=null,this._variables=null,this._lookups={}},variables:function(){return this._variables?this._variables:this._variables=this.rules.reduce(function(b,c){return c instanceof a.Rule&&c.variable===!0&&(b[c.name]=c),b},{})},variable:function(a){return this.variables()[a]},rulesets:function(){return this._rulesets?this._rulesets:this._rulesets=this.rules.filter(function(b){return b instanceof a.Ruleset||b instanceof a.mixin.Definition})},find:function(b,c){c=c||this;var d,e=[],f=b.toCSS();return f in this._lookups?this._lookups[f]:(this.rulesets().forEach(function(f){if(f!==c)for(var g=0;g<f.selectors.length;g++)if(d=b.match(f.selectors[g])){b.elements.length>f.selectors[g].elements.length?Array.prototype.push.apply(e,f.find(new a.Selector(b.elements.slice(1)),c)):e.push(f);break}}),this._lookups[f]=e)},toCSS:function(b,c){var d,e,f,g=[],h=[],i=[],j=[],k=[];this.root||this.joinSelectors(k,b,this.selectors);for(var l=0;l<this.rules.length;l++)if(f=this.rules[l],f.rules||f instanceof a.Media)j.push(f.toCSS(k,c));else if(f instanceof a.Directive){var m=f.toCSS(k,c);if("@charset"===f.name){if(c.charset){f.debugInfo&&(j.push(a.debugInfo(c,f)),j.push(new a.Comment("/* "+m.replace(/\n/g,"")+" */\n").toCSS(c)));continue}c.charset=!0}j.push(m)}else f instanceof a.Comment?f.silent||(this.root?j.push(f.toCSS(c)):h.push(f.toCSS(c))):f.toCSS&&!f.variable?h.push(f.toCSS(c)):f.value&&!f.variable&&h.push(f.value.toString());
if(j=j.join(""),this.root)g.push(h.join(c.compress?"":"\n"));else if(h.length>0){e=a.debugInfo(c,this),d=k.map(function(a){return a.map(function(a){return a.toCSS(c)}).join("").trim()}).join(c.compress?",":",\n");for(var l=h.length-1;l>=0;l--)-1===i.indexOf(h[l])&&i.unshift(h[l]);h=i,g.push(e+d+(c.compress?"{":" {\n  ")+h.join(c.compress?"":"\n  ")+(c.compress?"}":"\n}\n"))}return g.push(j),g.join("")+(c.compress?"\n":"")},joinSelectors:function(a,b,c){for(var d=0;d<c.length;d++)this.joinSelector(a,b,c[d])},joinSelector:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(e=0;e<d.elements.length;e++)j=d.elements[e],"&"===j.value&&(h=!0);if(h){for(r=[],i=[[]],e=0;e<d.elements.length;e++)if(j=d.elements[e],"&"!==j.value)r.push(j);else{for(s=[],r.length>0&&this.mergeElementsOnToSelectors(r,i),f=0;f<i.length;f++)if(k=i[f],0==c.length)k.length>0&&(k[0].elements=k[0].elements.slice(0),k[0].elements.push(new a.Element(j.combinator,"",0))),s.push(k);else for(g=0;g<c.length;g++)l=c[g],m=[],n=[],p=!0,k.length>0?(m=k.slice(0),q=m.pop(),o=new a.Selector(q.elements.slice(0)),p=!1):o=new a.Selector([]),l.length>1&&(n=n.concat(l.slice(1))),l.length>0&&(p=!1,o.elements.push(new a.Element(j.combinator,l[0].elements[0].value,0)),o.elements=o.elements.concat(l[0].elements.slice(1))),p||m.push(o),m=m.concat(n),s.push(m);i=s,r=[]}for(r.length>0&&this.mergeElementsOnToSelectors(r,i),e=0;e<i.length;e++)b.push(i[e])}else if(c.length>0)for(e=0;e<c.length;e++)b.push(c[e].concat(d));else b.push([d])},mergeElementsOnToSelectors:function(b,c){var d,e;if(0==c.length)return void c.push([new a.Selector(b)]);for(d=0;d<c.length;d++)e=c[d],e.length>0?e[e.length-1]=new a.Selector(e[e.length-1].elements.concat(b)):e.push(new a.Selector(b))}}}(b("../tree")),function(a){a.Selector=function(a){this.elements=a},a.Selector.prototype.match=function(a){var b,c,d,e,f=this.elements,g=f.length;if(b=a.elements.slice(a.elements.length&&"&"===a.elements[0].value?1:0),c=b.length,d=Math.min(g,c),0===c||c>g)return!1;for(e=0;d>e;e++)if(f[e].value!==b[e].value)return!1;return!0},a.Selector.prototype.eval=function(b){return new a.Selector(this.elements.map(function(a){return a.eval(b)}))},a.Selector.prototype.toCSS=function(a){return this._css?this._css:(this._css=""===this.elements[0].combinator.value?" ":"",this._css+=this.elements.map(function(b){return"string"==typeof b?" "+b.trim():b.toCSS(a)}).join(""),this._css)}}(b("../tree")),function(a){a.UnicodeDescriptor=function(a){this.value=a},a.UnicodeDescriptor.prototype={toCSS:function(){return this.value},eval:function(){return this}}}(b("../tree")),function(a){a.URL=function(a,b){this.value=a,this.rootpath=b},a.URL.prototype={toCSS:function(){return"url("+this.value.toCSS()+")"},eval:function(b){var c,d=this.value.eval(b);return"string"==typeof d.value&&!/^(?:[a-z-]+:|\/)/.test(d.value)&&(c=this.rootpath,d.quote||(c=c.replace(/[\(\)'"\s]/g,function(a){return"\\"+a})),d.value=c+d.value),new a.URL(d,this.rootpath)}}}(b("../tree")),function(a){a.Value=function(a){this.value=a,this.is="value"},a.Value.prototype={eval:function(b){return 1===this.value.length?this.value[0].eval(b):new a.Value(this.value.map(function(a){return a.eval(b)}))},toCSS:function(a){return this.value.map(function(b){return b.toCSS(a)}).join(a.compress?",":", ")}}}(b("../tree")),function(a){a.Variable=function(a,b,c){this.name=a,this.index=b,this.file=c},a.Variable.prototype={eval:function(b){var c,d,e=this.name;if(0==e.indexOf("@@")&&(e="@"+new a.Variable(e.slice(1)).eval(b).value),this.evaluating)throw{type:"Name",message:"Recursive variable definition for "+e,filename:this.file,index:this.index};if(this.evaluating=!0,c=a.find(b.frames,function(a){return(d=a.variable(e))?d.value.eval(b):void 0}))return this.evaluating=!1,c;throw{type:"Name",message:"variable "+e+" is undefined",filename:this.file,index:this.index}}}}(b("../tree")),function(a){a.debugInfo=function(b,c){var d="";if(b.dumpLineNumbers&&!b.compress)switch(b.dumpLineNumbers){case"comments":d=a.debugInfo.asComment(c);break;case"mediaquery":d=a.debugInfo.asMediaQuery(c);break;case"all":d=a.debugInfo.asComment(c)+a.debugInfo.asMediaQuery(c)}return d},a.debugInfo.asComment=function(a){return"/* line "+a.debugInfo.lineNumber+", "+a.debugInfo.fileName+" */\n"},a.debugInfo.asMediaQuery=function(a){return"@media -sass-debug-info{filename{font-family:"+("file://"+a.debugInfo.fileName).replace(/[\/:.]/g,"\\$&")+"}line{font-family:\\00003"+a.debugInfo.lineNumber+"}}\n"},a.find=function(a,b){for(var c,d=0;d<a.length;d++)if(c=b.call(a,a[d]))return c;return null},a.jsify=function(a){return Array.isArray(a.value)&&a.value.length>1?"["+a.value.map(function(a){return a.toCSS(!1)}).join(", ")+"]":a.toCSS(!1)}}(b("./tree"));var r=/^(file|chrome(-extension)?|resource|qrc|app):/.test(location.protocol);if(p.env=p.env||("127.0.0.1"==location.hostname||"0.0.0.0"==location.hostname||"localhost"==location.hostname||location.port.length>0||r?"development":"production"),p.async=p.async||!1,p.fileAsync=p.fileAsync||!1,p.poll=p.poll||(r?1e3:1500),p.functions)for(var s in p.functions)p.tree.functions[s]=p.functions[s];var t=/!dumpLineNumbers:(comments|mediaquery|all)/.exec(location.hash);t&&(p.dumpLineNumbers=t[1]),p.watch=function(){return p.watchMode||(p.env="development",c()),this.watchMode=!0},p.unwatch=function(){return clearInterval(p.watchTimer),this.watchMode=!1},/!watch/.test(location.hash)&&p.watch();var u=null;if("development"!=p.env)try{u="undefined"==typeof a.localStorage?null:a.localStorage}catch(v){}var w=document.getElementsByTagName("link"),x=/^text\/(x-)?less$/;p.sheets=[];for(var y=0;y<w.length;y++)("stylesheet/less"===w[y].rel||w[y].rel.match(/stylesheet/)&&w[y].type.match(x))&&p.sheets.push(w[y]);var z="";p.modifyVars=function(a){var b=z;for(name in a)b+=("@"===name.slice(0,1)?"":"@")+name+": "+(";"===a[name].slice(-1)?a[name]:a[name]+";");(new p.Parser).parse(b,function(a,b){j(b.toCSS(),p.sheets[p.sheets.length-1])})},p.refresh=function(a){var b,c;b=c=new Date,e(function(a,d,e,f,g){g.local?n("loading "+f.href+" from cache."):(n("parsed "+f.href+" successfully."),j(d.toCSS(),f,g.lastModified)),n("css for "+f.href+" generated in "+(new Date-c)+"ms"),0===g.remaining&&n("css generated in "+(new Date-b)+"ms"),c=new Date},a),d()},p.refreshStyles=d,p.refresh("development"===p.env),"function"==typeof define&&define.amd&&define("less",[],function(){return p})}(window),function(){var a,b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},g=[].slice;a=jQuery,b=!1,c=function(){function c(b,c,d,f){var g,h=this;this.tam=b,this.name=c,this.speaker=d,this.adjustSelection=e(this.adjustSelection,this),null==f&&(f={}),this.locked="locked"in f?f.locked:!1,this.el=a('<div>\n<div class="emContainerTAM">\n    <div class="emphasisTAM"></div>\n</div>\n<div class="hlContainerTAM">\n    <div class="highlightsTAM"></div>\n</div>\n<div class="taContainerTAM">\n    <textarea class="txtAreaTAM" name="area'+c+'"></textarea>\n</div>\n<div class="overlayContainerTAM">\n    <div class="overlaysTAM"></div>\n</div>\n</div>'),this.hlContainer=this.el.find(".hlContainerTAM"),this.highlights=this.el.find(".highlightsTAM"),this.emContainer=this.el.find(".emContainerTAM"),this.emphasis=this.el.find(".emphasisTAM"),this.overlayContainer=this.el.find(".overlayContainerTAM"),this.overlays=this.el.find(".overlaysTAM"),this.taContainer=this.el.find(".taContainerTAM"),this.area=this.el.find(".txtAreaTAM"),g=[this.area,this.hlContainer,this.highlights,this.emContainer,this.emphasis,this.overlayContainer,this.overlays,this.taContainer],this.$containers=a(_.map(g,function(a){return a[0]})),this.area.bind("copy",function(){return h.tam.processCopy(h)}).bind("cut",function(a){return console.log("Cut not supported at this time"),a.preventDefault(),!1}).bind("paste",function(a){return h.locked?a.preventDefault():h.tam.processPaste(h,h.area.val())}).keypress(function(a){return a.which>=32&&a.preventDefault,!1}).keydown(function(b){var c;switch(b.which){case 8:return b.preventDefault(),h.locked||h.tam.processDelete(h,"backward"),!1;case 46:return b.preventDefault(),h.locked||h.tam.processDelete(h,"forward"),!1;case 37:case 38:case 39:case 40:if(b.shiftKey)return _.defer(h.snapSelectionToWord);break;case 13:return b.preventDefault();case 90:return!1;case 190:if(b.preventDefault(),!h.locked)return h.addPeriod();break;case 69:return b.preventDefault(),h.insertEmphasisPoint();case 87:return c=h.tam.tas.indexOf(h),c>0&&(h.tam.tas[c-1].area.setSelection(0),h.tam.lastFocused=h.tam.tas[c-1],h.tam.container.stop().scrollTo(a(h.tam.tas[c-1].area),200,{offset:-200})),b.preventDefault();case 83:return c=h.tam.tas.indexOf(h),c+1<h.tam.tas.length&&(h.tam.tas[c+1].area.setSelection(0),h.tam.lastFocused=h.tam.tas[c+1],h.tam.container.stop().scrollTo(a(h.tam.tas[c+1].area),200,{offset:-200})),b.preventDefault()}}).bind("mousemove",function(){}).bind("mouseup",this.adjustSelection),this.overlays.bind("mouseup",this.adjustSelection)}return c.prototype.adjustSelection=function(){var a,b,c,d;return this.tam.lastFocused=this,this.snapSelectionToWord(),b=this.area.getSelection(),d=this.rangeIndices(b.start,b.end),c=d[0],a=d[1],this.tam.highlightWordsInWaveform(c,a,this)},c.prototype._renderWord=function(a,b,c,d){var e,g,h;return null==c&&(c=""),null==d&&(d=""),e=[".","?","!"],g='."',h=a.word[a.word.length-1],f.call(e,h)>=0||a.word.slice(-2)===g?b?""+c+a.word+d+"\n":""+c+a.word+d+"<br />":""+c+a.word+d+" "},c.prototype.updateWords=function(a){var c,d,e,g=this;return b&&console.log("UPDATE WORDS"),a&&(this.words=a),e=this._renderWord,c=["UH","UM","AH"],d=_.reduce(this.words,function(a,b){var d;return d=b.alignedWord,f.call(c,d)>=0&&(b.emph=!0),""+a+e(b,!0)},""),this.val(d),this.tam.dirtyTas.push(this),this.refresh(),_.defer(function(){return 0===g.words.length&&1!==g.tam.tas.length?g.tam.removeTA(g):void 0})},c.prototype.height=function(){return this.area.height()},c.prototype.val=function(a){return this.area.val(a)},c.prototype.refresh=function(){return b&&console.log("SA REFRESH"),this.updatePos(),this.adjustHeight()},c.prototype.adjustHeight=function(){var a;return b&&console.log("ADJUST HEIGHT OF",this),this.area.height("20px"),a=this.area.prop("scrollHeight")+"px",this.$containers.height(a),a},c.prototype.snapSelectionToWord=function(){var a,b,c,d,e,g,h,i,j,k;if(d=this.area.getSelection(),console.log(d),a=!1,b=!1,0!==d.length){if(/^\s+$/.exec(d.text)&&this.area.collapseSelection(),g=this.area.val(),e=[" ","\n"],d.length>0){for(;h=g.charAt(d.start),f.call(e,h)>=0&&(b=!0,d.start+1<d.end);)this.area.setSelection(d.start+1,d.end),d=this.area.getSelection();for(;i=g.charAt(d.start-1),f.call(e,i)<0&&""!==g.charAt(d.start-1)&&c!==d.length&&!b;)c=d.length,this.area.setSelection(d.start-1,d.end),d=this.area.getSelection();for(;j=g.charAt(d.end-1),f.call(e,j)>=0&&(a=!0,d.start<d.end-1);)this.area.setSelection(d.start,d.end-1),d=this.area.getSelection();for(;k=g.charAt(d.end),f.call(e,k)<0&&""!==g.charAt(d.end)&&c!==d.length&&!a;)c=d.length,this.area.setSelection(d.start,d.end+1),d=this.area.getSelection()}return console.log("end of snap",d)}},c.prototype.insertEmphasisPoint=function(){var a,b;return TAAPP.use("addEmphasisPoint"),this.selectWord("backward"),a=this.area.getSelection(),this.area.setSelection(a.end),b=this.range(a.start,a.end)[0],b.emphasisPoint=!0,this.tam.dirtyTas.push(this),this.tam.refresh()},c.prototype.selectWord=function(a){var b,c,d,e,g,h;if(null==a&&(a="backward"),d=this.area.getSelection().start,e=this.area.val(),c=[" ","\n"],"backward"===a){for(b=d-1;g=e.charAt(b),f.call(c,g)>=0&&""!==e.charAt(b);)b-=1;this.area.setSelection(b,d)}else if("forward"===a){for(b=d+2;h=e.charAt(b),f.call(c,h)>=0&&""!==e.charAt(b);)b+=1;this.area.setSelection(d,b)}return this.snapSelectionToWord()},c.prototype.updatePos=function(){var a;return a=this.name,_.each(this.words,function(b,c,d){return d[c].taPos=this.total,d[c].taIdx=a,this.total+=b.word.length+1},{total:0})},c.prototype.rangeIndices=function(a,b){var c,d,e,f,g,h,i,j,k,l;for(k=this.words,d=g=0,i=k.length;i>g;d=++g)if(f=k[d],f.taPos>=a){e=d;break}for(l=this.words,d=h=0,j=l.length;j>h;d=++h)f=l[d],f.taPos<b&&(c=d);return[e,c]},c.prototype.range=function(a,b){var c,d,e,f,g,h;if(null==b){for(h=this.words,d=f=0,g=h.length;g>f;d=++f)if(e=h[d],e.taPos>=a){c=e.taPos;break}return[c,d]}return _.filter(this.words,function(c){return c.taPos>=a&&c.taPos<b})},c.prototype.addPeriod=function(){var a,b,c,d,e,g,h,i,j,k=this;return TAAPP.use("addPeriod"),console.log("Adding a period"),i=this.area.getSelection(),h=this.range(i.end),0!==h[1]?(g=h[1]-1,console.log("adding period to word",this.words[g]),f.call(this.words[g].word,".")<0&&(this.words[g].word+="."),c=this.tam.breathInds[this.speaker],j=_.sortBy(c,function(a){return-k.tam.words[a].likelihood}),b=j[Math.floor(Math.random()*j.length)],a=[b],("undefined"!=typeof TAAPP&&null!==TAAPP?TAAPP.speech:void 0)in TAAPP.roomTone&&(d="{gp-0.02}",e="{gp-0.05}",a=[d,b,e]),this.tam.insertWords(a,h.end,this)):void 0},c.prototype.highlightWords=function(a,b){var c,d;return d=this._renderWord,c=_.reduce(this.words,function(c,e,f){var g,h;return g="",h="",f!==a||f!==b-1&&null!=b?f===a?g="<span class='hl'>":f===b-1&&(h="</span>"):(g="<span class='hl'>",h="</span>"),""+c+d(e,!1,g,h)},""),this.highlights.html(c)},c.prototype.emphasizeWords=function(){var a,b,c,d=this;return a=[-1],c=this._renderWord,b=_.reduce(this.words,function(a,b,e){var f,g,h,i;return f="",g="",null!=b.origPos&&b.origPos-1!==d[0]&&(f+="<span class='editLocation'>",g+="</span>"),null!=b.emph&&b.emph&&(f+="<span class='emph'>",g+="</span>"),null!=b.emphasisPoint&&b.emphasisPoint&&(f+="<span class='ePt'>",g+="</span>"),"sp"===b.alignedWord||"gp"===b.alignedWord?(f+="<span class='pause'>",g+="</span>"):"{BR}"===b.alignedWord?(f+="<span class='breath'>",g+="</span>"):(b.alignedWord===(null!=(h=d.words[e-1])?h.alignedWord:void 0)||(null!=(i=d.words[e+1])?i.alignedWord:void 0)===b.alignedWord)&&(f+="<span class='repeatedWord'>",g+="</span>"),d[0]=b.origPos,""+a+c(b,!1,f,g)},"",a),this.emphasis.html(b)},c.prototype.insertDupeOverlays=function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q;return b&&console.log("SA INSERT DUPE OVERLAYS",this),e=this.overlays,g={dupeOrder:[],bounds:[]},j=[],l=d.firsts,k=d.starts,n=this.tam.taIndexSpan[this.tam.tas.indexOf(this)],h='<span class="dropdown overlay">\n    <span class="dropdown-toggle">',i='    </span>\n    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\n        <li class="disabled"><a><%= header %></a></li>\n        <% _.each(dupes[dupeIdx], function (elt) { %>\n            <li><span \n                   class="dupeOpt"\n                   tabindex="-1">\n                   <i class="icon-play dupePlayButton"></i>\n                   <div style="position:relative; display:inline-block">\n                   <span class="copyButton"><%= elt[1] %></span>\n                   </div>\n                </span>\n            </li>\n        <% }) %>\n    </ul>\n</span>',o=this._renderWord,m=this.locked,f=_.reduce(this.words,function(a,b,d,e){var f,g,j,n,p,q,r;if(j=l.indexOf(b.origPos),q="",r="",-1!==j){for(p=d,g=k[j],f=g.idxInDupes;p<e.length&&e[p].origPos>=g.dElt[0][0]&&e[p].origPos<=g.dElt[0][1];)p+=1;this.dupeOrder.push(f),this.bounds.push([d,p-1]),q=h,n=m?"Similar sentences (click to copy)":"Similar sentences",r=_.template(i,{header:n,dupeIdx:f,dupes:c})}return("sp"===b.alignedWord||"gp"===b.alignedWord)&&(q+="<span class='pauseOverlay'>",r+="</span>"),"{BR}"===b.alignedWord&&(q+="<span class='breathOverlay'>",r+="</span>"),""+a+o(b,!1,q,r)},"",g),e.html(f),p=this,q=this.area.width(),this.area.unbind(".tam").bind("click.tam",function(){return console.log("clicked on the box"),a(".dropdown.open").removeClass("open")}),e.find(".dropdown-toggle").dropdown().each(function(b){var d,e,f,h,i;return h=a(this).offset(),e=p.area.offset(),d=c[g.dupeOrder[b]],i=g.bounds[b][0],f=g.bounds[b][1],a(this).click(function(){return TAAPP.use("viewSimilarSentences"),console.log("start",i,"end",f),p.area.setSelection(p.words[i].taPos,p.words[f].taPos+p.words[f].word.length)}).next(".dropdown-menu").css({left:""+(-h.left+e.left+10)+"px",width:""+(q-20)+"px"}).find("span.dupeOpt").each(function(b){var c,e,g;return m?(a(this).closest(".dropdown").addClass("open"),c=function(){g=[];for(var a=e=d[b][0][0],c=d[b][0][1];c>=e?c>=a:a>=c;c>=e?a++:a--)g.push(a);return g}.apply(this),a(this).find(".copyButton").attr("data-clipboard-text",p.tam.generateCopyTextFromIndices(c)).zclip({path:"static/swf/ZeroClipboard.swf",copy:p.tam.generateCopyTextFromIndices(c),afterCopy:function(){return p.area.focus(),console.log("COPPY",a(this).closest(".dropdown")),a(this).closest(".dropdown").removeClass("open")}}),a(this).find(".zclip").css({top:"-4px"}),a(this).closest(".dropdown").removeClass("open")):a(this).click(function(){var a;return TAAPP.use("replaceSentence"),a=p.replaceWords(i,f,d[b][0][0],d[b][0][1]),p.area.setSelection(a[0],a[1]),!1}),a(this).find(".dupePlayButton").click(function(c){var e,f;return TAAPP.use("playSimilarSentence"),f=p.tam.words[d[b][0][0]].start,e=p.tam.words[d[b][0][1]].end,TAAPP.origSound.play({from:1e3*f,to:1e3*e,onstop:function(){return a(this).closest(".dropdown").hasClass("open")?p.area.focus():void 0}}),c.stopPropagation()})})})},c.prototype.replaceWords=function(a,b,c,d){return this.tam.replaceWords(a,b,c,d,this,this.words[a].taPos)},c}(),d=function(){function d(b,c,d,e,f){var g,h,i,j,k,l=this;this.el=b,this.speakers=c,this.words=d,this.current=e,null==f&&(f={}),this.locked="locked"in f?f.locked:!1,this.textAlignedWfs="wfs"in f?f.wfs:null,this.headerTable=a(document.createElement("table")).attr("width","100%").appendTo(this.el),this.container=a(document.createElement("div")).css({"overflow-x":"hidden","overflow-y":"auto"}).appendTo(this.el),this.table=a(document.createElement("table")).attr("width","100%").appendTo(this.container),h=a(document.createElement("tr")).appendTo(this.headerTable),_.each(this.speakers,function(b){var c;return c=document.createElement("th"),a(c).html(b).width(""+100/l.speakers.length+"%").appendTo(h)}),this.tas=[],this.taIndexSpan=[],this.areas=[],this.dirtyTas=[],this.draw(),this.breathInds={},k=this.speakers;for(i=0,j=k.length;j>i;i++)g=k[i],this.breathInds[g]=[];_.each(this.words,function(a,b){var c;if("{BR}"===a.alignedWord){for(c=b;c<l.words.length&&!("speaker"in l.words[c]);)c++;if(c===l.words.length)return;if("speaker"in l.words[c])return l.breathInds[l.words[c].speaker].push(b)}}),this.el.scrollTo(0)}return d.prototype._tr=function(b){var c;return c=a(document.createElement("tr")),_.each(this.speakers,function(){var b;return b=a(document.createElement("td")),c.append(b)}),c.find("td").width(""+100/this.speakers.length+"%"),null!=b?0===b?c.prependTo(this.table):c.insertAfter(this.table.find("tr").eq(b-1)):c.appendTo(this.table),c},d.prototype._newScriptArea=function(a,b,d){var e;return e=new c(this,a,b,{locked:this.locked}),null!=d?(this.tas.splice(d,0,e),this.areas.splice(d,0,e.area)):(this.tas.push(e),this.areas.push(e.area)),e.el},d.prototype.refresh=function(){var c,d,e,f,g;for(b&&console.log("TAM REFRESH"),this.dirtyTas=_.uniq(this.dirtyTas),g=this.tas,c=e=0,f=g.length;f>e;c=++e)d=g[c],d.name=c;return this.updatePos(),this.adjustHeight(),this.emphasizeWords(),this.insertDupeOverlays(this.dupes,this.dupeInfo),null!=this.textAlignedWfs&&a(_.values(this.textAlignedWfs)).textAlignedWaveform({currentWords:this.current}),this.dirtyTas=[]},d.prototype.adjustHeight=function(a){var c,d,e,f,g;for(b&&console.log("ADJUST HEIGHT OF TAM"),null==a&&(a=!1),e=a?this.tas:this.dirtyTas,f=0,g=e.length;g>f;f++)d=e[f],c=d.adjustHeight(),d.el.closest("tr").height(c);return console.log("container height",window.innerHeight-this.el.offset().top-50),this.container.height(window.innerHeight-this.el.offset().top-50),console.log("el height",window.innerHeight-this.el.offset().top-50),this.el.height(window.innerHeight-this.el.offset().top-50)},d.prototype.draw=function(){var a,b,c=this;return this.table.find("tr").remove(),b=this.speakers[0],a=0,this.taIndexSpan=[0],_.each(this.current,function(d,e){var f,g;return 0===e?(f=0,g=c._tr(),g.find("td").eq(f).append(c._newScriptArea(a++,b))):null!=d.speaker&&d.speaker!==b?(c.taIndexSpan.push(e),f=c.speakers.indexOf(d.speaker),g=c._tr(),g.find("td").eq(f).append(c._newScriptArea(a++,d.speaker)),b=d.speaker):void 0}),_.each(this.taIndexSpan,function(a,b){var d;return d=b===c.taIndexSpan.length-1?c.current.slice(a):c.current.slice(a,c.taIndexSpan[b+1]),c.tas[b].updateWords(d)}),this.dirtyTas=this.tas.slice(0),this.refresh(),this.lastFocused=this.tas[0]},d.prototype.pruneByTAPos=function(a,c,d){var e;return b&&console.log("PRUNE BY TA POS"),e=[],_.each(d.words,function(b,d){return b.taPos>=a&&b.taPos<c?e.push(d):void 0}),console.log("prune by TA",e[0],_.last(e)),this.pruneByTAIndex(e[0],_.last(e)+1,d)},d.prototype.pruneByTAIndex=function(a,c,d,e){var f,g;return b&&console.log("PRUNE BY TA INDEX"),null==e&&(e=!0),g=this.tas.indexOf(d),f=this.taIndexSpan[g],this.pruneCurrent(a+f,c+f,e)},d.prototype.pruneCurrent=function(a,c,d){var e,f,g,h,i,j,k,l;for(b&&console.log("PRUNE CURRENT"),null==d&&(d=!0),e=this.current.splice(a,c-a),console.log("start",a,"end",c,"cutwords",e),h=e[0].taIdx,g=this.tas[h],console.log("taIndex",h,"ta",g),l=this.tas,f=j=0,k=l.length;k>j;f=++j)i=l[f],f>h&&(this.taIndexSpan[f]-=c-a);return h===this.tas.length-1?g.updateWords(this.current.slice(this.taIndexSpan[h])):(console.log("Prune current, updating ta with words",this.taIndexSpan[h],this.taIndexSpan[h+1]-1),g.updateWords(this.current.slice(this.taIndexSpan[h],this.taIndexSpan[h+1]))),d?this.refresh():void 0},d.prototype.pruneAll=function(){var a,b,c,d;for(d=this.tas,b=0,c=d.length;c>b;b++)a=d[b],a.updateWords([]);return this.current.splice(0,this.current.length),this.refresh()},d.prototype.highlightWordsInWaveform=function(b,c,d){var e,f,g,h,i,j,k,l;if(null!=this.textAlignedWfs&&(e=this.taIndexSpan[this.tas.indexOf(d)],(null!=(i=this.highlightedWordsRange)?i[0]:void 0)!==e+b||(null!=(j=this.highlightedWordsRange)?j[1]:void 0)!==e+c)){for(this.highlightedWordsRange=[e+b,e+c],a(this.textAlignedWfs[d.speaker]).textAlignedWaveform({highlightedWordsRange:this.highlightedWordsRange}),k=this.speakers,l=[],g=0,h=k.length;h>g;g++)f=k[g],l.push(f!==d.speaker?a(this.textAlignedWfs[f]).textAlignedWaveform({highlightedWordsRange:void 0}):void 0);return l}},d.prototype.highlightWords=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(-1!==a){if(!((null!=(o=this.currentHighlight)?o[0]:void 0)>a&&(null!=(p=this.currentHighlight)?p[0]:void 0)<a+3)){for(this.currentHighlight=[a,b],q=this.tas,c=i=0,l=q.length;l>i&&(g=q[c],!(this.taIndexSpan[c]>a));c=++i);for(0!==c?(g=this.tas[c-1],e=this.taIndexSpan[c-1]):(g=this.tas[0],e=this.taIndexSpan[0]),r=this.tas,j=0,m=r.length;m>j;j++)f=r[j],f.highlights.html("");return null!=b&&(d=b-e),g.highlightWords(a-e,d)}}else for(this.currentHighlight=void 0,n=this.tas,h=0,k=n.length;k>h;h++)g=n[h],g.highlights.html("")},d.prototype.emphasizeWords=function(){var a,b,c,d,e;for(d=this.dirtyTas,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.emphasizeWords());return e},d.prototype.updatePos=function(){var a,b,c,d,e,f,g,h,i,j;for(this.highlightWords(-1),a=0,this.taIndexSpan=[],h=this.tas,b=d=0,f=h.length;f>d;b=++d)c=h[b],c.name=b,this.taIndexSpan.push(a),a+=c.words.length;for(i=this.dirtyTas,j=[],e=0,g=i.length;g>e;e++)c=i[e],j.push(c.updatePos());return j},d.prototype.clean=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(k=this.tas.indexOf(a),f=this.taIndexSpan[k],i=[],g=[],j=[],q=a.words,c=o=0,p=q.length;p>o;c=++o)m=q[c],null!=m.speaker&&m.speaker!==d&&(i.push(c),j.push(m.speaker),g.push(m.speaker===a.speaker),d=m.speaker);return 1===g.length&&g[0]?void this.refresh():1!==g.length||g[0]?2===g.length&&g[0]?(n=a.words.slice(i[1]),k===this.tas.length-1?(console.log("New row"),b=this.speakers.indexOf(j[1]),l=this._tr(k+1),l.find("td").eq(b).append(this._newScriptArea(this.tas.length,j[1],k+1)),a.updateWords(a.words.slice(0,i[1])),this.tas[this.tas.length-1].updateWords(n),this.tas[this.tas.length-1].area.setSelection(0,0),this.refresh()):this.tas[k+1].speaker===j[1]?(console.log("Inserting in next row"),console.log(this.tas,k),e=this.tas[k+1],a.updateWords(a.words.slice(0,i[1])),e.updateWords(n.concat(e.words)),e.area.setSelection(0,0),this.refresh()):window.alert("should not get here (right wrong pattern)"),void console.log("CLEAN: @tas",this.tas,"taIndexSpan",this.taIndexSpan)):2===g.length&&g[1]?(n=a.words.slice(0,i[1]),0===k?(console.log("New row (wrong right)"),b=this.speakers.indexOf(j[0]),l=this._tr(0),l.find("td").eq(b).append(this._newScriptArea(this.tas.length,j[0],0)),a.updateWords(a.words.slice(i[1])),this.tas[0].updateWords(n)):this.tas[k-1].speaker===j[0]?(h=this.tas[k-1],a.updateWords(a.words.slice(i[1])),h.updateWords(h.words.concat(n))):window.alert("should not get here (wrong right pattern)"),a.area.setSelection(0,0),void this.refresh()):void(3===g.length&&(n=a.words.slice(0),b=this.speakers.indexOf(j[1]),l=this._tr(k+1),l.find("td").eq(b).append(this._newScriptArea(this.tas.length,j[1],k+1)),b=this.speakers.indexOf(j[2]),l=this._tr(k+2),l.find("td").eq(b).append(this._newScriptArea(this.tas.length,j[2],k+2)),a.updateWords(n.slice(0,i[1])),this.tas[k+1].updateWords(n.slice(i[1],i[2])),this.tas[k+2].updateWords(n.slice(i[2])),this.refresh(),this.tas[k+1].area.setSelection(0,0))):(n=a.words.slice(0),b=this.speakers.indexOf(d),a.speaker=d,a.el.closest("tr").find("td").eq(b).append(a.el),void this.refresh())},d.prototype.processDelete=function(a,c){var d,e,g,h,i;for(TAAPP.use("delete"),b&&console.log("PROCESSDELETE"),window.TAAPP.sound&&window.TAAPP.sound.stop(),a.snapSelectionToWord(),e=a.area.getSelection(),0===e.length&&a.selectWord(c,!0),e=a.area.getSelection(),d=e.end,h=a.area.val(),g=[" ","\n"];i=h.charAt(d),f.call(g,i)>=0;)d+=1;return console.log("calling prune by ta pos with start",e.start,"end",d),this.pruneByTAPos(e.start,d,a),a.area.setSelection(e.start,e.start)},d.prototype.insertEmphasisPoint=function(a){return null==a&&(a=this.lastFocused),a.insertEmphasisPoint()},d.prototype.insertWords=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(console.log("INSERT WORDS",a,"POS",b,"TA",c),null==c&&(c=this.lastFocused),null==b&&(b=c.area.getSelection().start),j=this.tas.indexOf(c),i=this.taIndexSpan[j],p=c.words,g=m=0,o=p.length;o>m&&(k=p[g],!(k.taPos>=b));g=++m)g===c.words.length-1&&(g=c.words.length);for(e={first:void 0,last:void 0,words:this.words},_.isArray(a)||(a=[a]),l=_.map(a,function(a){var b;return"{gp"===a.toString().split("-")[0]?(b=clone(TAAPP.roomTone[TAAPP.speech]),b.word=a,b.pauseLength=parseFloat(a.split("-")[1]),null==this.first&&(this.first=b),this.last=b,b):(b=clone(this.words[a]),null==this.first&&(this.first=b),this.last=b,b)},e),d=[g+i,0].concat(l),Array.prototype.splice.apply(this.current,d),f=n=0,q=this.tas.length;q>=0?q>n:n>q;f=q>=0?++n:--n)f>j&&(this.taIndexSpan[f]+=l.length);return this.dirtyTas.push(c),c.updateWords(j===this.tas.length-1?this.current.slice(this.taIndexSpan[j]):this.current.slice(this.taIndexSpan[j],this.taIndexSpan[j+1])),this.clean(c),this.refresh(),h=e.last.taPos+e.last.word.length,c.area.setSelection(h,h),this.current.indexOf(e.first)},d.prototype.processPaste=function(a,b){var c=this;return TAAPP.use("paste"),_.defer(function(){var d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(k=/(?:\[(\d+|gp),(e?)\]([^|]+)\|)/g,e=!1,l=[],d=a.area.val(),n=a.area.getSelection(),o=[" ","\n"],b.length-d.length+n.start!==0&&(w=b.charAt(b.length-d.length+n.start),f.call(o,w)<0)&&(x=b.charAt(b.length-d.length+n.start-1),f.call(o,x)<0))return console.log("couldn't paste",b.length,d.length,n.start),a.area.val(b),void c.refresh();for(g=0,i=[];m=k.exec(d);)e=!0,l.push("gp"===m[1]?m[3]:parseInt(m[1],10)),"e"===m[2]&&i.push(g),g+=1;if(e){for(j=c.insertWords(l,b.length-d.length+n.start,a),q=0,t=i.length;t>q;q++)h=i[q],c.current[j+h].emphasisPoint=!0;for(r=0,u=i.length;u>r;r++)for(h=i[r],y=c.tas,p=s=0,v=y.length;v>s;p=++s)a=y[p],c.taIndexSpan[p]<=h&&c.taIndexSpan[p]+a.words.length>h&&c.dirtyTas.push(a);return 0!==i.length&&c.refresh(),void console.log("taindexspan after clean",c.taIndexSpan)}return a.area.val(b),c.refresh()})},d.prototype.generateCopyTextFromIndices=function(a){var b,c,d,e=this;return d=function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.current[b]);return e}.call(this),c=_.reduce(d,function(a,b){var c,d,f,g,h;if("gp"===b.alignedWord)return a+"[gp]"+b.word+"|";for(h=e.words,c=f=0,g=h.length;g>f&&(d=h[c],d.start!==b.start||d.end!==b.end);c=++f);return""+a+"["+c+"]"+b.word+"|"},"")},d.prototype.processCopy=function(b){var c,d,e,f,g,h=this;return TAAPP.use("copy"),f=window.getSelection(),d=document.createElement("div"),e=b.area.getSelection(),g=b.range(e.start,e.end),c=_.reduce(g,function(a,b){var c,d,e,f,g,i;if(c="","emphasisPoint"in b&&b.emphasisPoint&&(c="e"),"gp"===b.alignedWord)return""+a+"[gp,"+c+"]"+b.word+"|";for(i=h.words,d=f=0,g=i.length;g>f&&(e=i[d],e.start!==b.start||e.end!==b.end);d=++f);return""+a+"["+d+","+c+"]"+b.word+"|"},""),a(d).css({position:"absolute",left:"-99999px"}).html(c).appendTo("body"),f.selectAllChildren(d),_.defer(function(){return a(d).remove()})},d.prototype.processCut=function(a){var b,c,d,e,f=this;return d=a.area.getSelection(),e=a.range(d.start,d.end),c=a.area.val(),b=_.reduce(e,function(a,b){var c,d,e,g,h;if("gp"===b.alignedWord)return a+"[gp]"+b.word+"|";for(h=f.words,c=e=0,g=h.length;g>e&&(d=h[c],d.start!==b.start||d.end!==b.end);c=++e);return""+a+"["+c+"]"+b.word+"|"},""),c=c.slice(0,d.start)+b+c.slice(d.end+1),a.area.val(c).setSelection(d.start,d.start+b.length)},d.prototype.insertDupeOverlays=function(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(this.dupes=a,this.dupeInfo=c,b&&console.log("INSERT DUPE OVERLAYS"),null==d&&(d=!1),b&&console.log("DIRTY:",this.dirtyTas),null!=this.dupes){if(d){for(l=this.tas,f=0,i=l.length;i>f;f++)e=l[f],e.insertDupeOverlays(this.dupes,this.dupeInfo);for(m=this.tas,o=[],g=0,j=m.length;j>g;g++)e=m[g],o.push(e.adjustHeight());return o}for(n=this.dirtyTas,p=[],h=0,k=n.length;k>h;h++)e=n[h],p.push(e.insertDupeOverlays(this.dupes,this.dupeInfo));return p}},d.prototype.replaceWords=function(a,b,c,d,e,f){return this.pruneByTAIndex(a,b+1,e),this.insertWords(_.range(c,d+1),f,e)},d.prototype.removeTA=function(a){var b;return console.log("INDEX",this.tas.indexOf(a,"REMOVING TA",a)),b=this.tas.indexOf(a),this.tas.splice(b,1),this.taIndexSpan.splice(b,1),this.table.find("tr").eq(b).remove(),console.log("TA",a,"taIndex",b,"@TAS",this.tas),0!==b&&b<this.tas.length&&this.tas[b-1].speaker===this.tas[b].speaker&&(console.log("### combining 2 text areas"),this.tas[b-1].updateWords(this.tas[b-1].words.concat(this.tas[b].words)),this.removeTA(this.tas[b])),Array.prototype.push.apply(this.dirtyTas,this.tas.slice(b)),this.refresh()},d.prototype.log=function(){var a,b;return b=1<=arguments.length?g.call(arguments,0):[],a=["[TAM]"].concat(b),console.log.apply(console,a)},d}(),window.TextAreaManager=d}.call(this);var TAAPP=TAAPP||{},clone=function(a){var b=a instanceof Array?[]:{};for(i in a)b[i]=a[i]&&"object"==typeof a[i]?clone(a[i]):a[i];return b};soundManager.setup({url:"static/swf/soundmanager2_flash9.swf",flashVersion:9,useFlashBlock:!1,flashLoadTimeout:15e3,useHighPerformance:!0}),TAAPP.state={speechReauthor:{},speechSampleRate:44100,timelineHeight:100,timelineWidth:2e3},TAAPP.spinner=new Spinner({lines:13,length:26,width:9,radius:35,corners:1,rotate:0,color:"#0f82f5",speed:.8,trail:52,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"200px",left:"auto"}),TAAPP.bestBreathIndices=function(){var a=_.min(_.filter(TAAPP.words,function(a){return a.hasOwnProperty("breathLen")}),function(a){return a.breathLen}),b=[a.origPos];return"sp"===TAAPP.words[a.origPos+1].alignedWord&&b.push(a.origPos+1),b},TAAPP.allBreathIndices=function(){var a,b=_.filter(TAAPP.words,function(a){return"{BR}"===a.alignedWord
}),c=[],d=[];for(a=0;a<b.length;a++)d=[b[a].origPos],b[a].origPos+1<TAAPP.words.length&&"sp"===TAAPP.words[b[a].origPos+1].alignedWord&&d.push(d[0]+1),b[a].origPos-1>=0&&"sp"===TAAPP.words[b[a].origPos-1].alignedWord&&d.splice(0,0,b[a].origPos-1),c.push(d),d=[];return c},TAAPP.randomBreathIndices=function(){var a=_.filter(TAAPP.words,function(a){return a.hasOwnProperty("breathLen")}),b=a[Math.floor(Math.random()*a.length)],c=[b.origPos];return"sp"===TAAPP.words[b.origPos+1].alignedWord&&c.push(b.origPos+1),c},TAAPP._createBreathDropdown=function(){var a=TAAPP.allBreathIndices(),b=_.template($("#breathDropdownTemplate").html());$(".breathDropdown").append(b({breaths:a})).find(".breathPlayButton").each(function(b){$(this).click(function(c){var d=TAAPP.words[a[b][0]].start,e=TAAPP.words[_.last(a[b])].end;TAAPP.origSound.play({from:1e3*d,to:1e3*e}),c.stopPropagation()})}),$(".breathDropdown").find(".copyButton").each(function(b){$(this).click(function(){TAAPP.use("insertBreath"),TAAPP.TAManager.insertWords(a[b])})})},TAAPP.insertBreath=function(){var a=TAAPP.randomBreathIndices();TAAPP.TAManager.insertWords(a)},TAAPP.globalBreathFill=function(){var a=/[\.:!\?]$/,b=[];_.each(TAAPP.current,function(c,d,e){if(null!==a.exec(c.word))for(;++d<e.length&&"{BR}"!==e[d].alignedWord;)if("gp"!==e[d].alignedWord&&"sp"!==e[d].alignedWord){b.push(d);break}});var c=0;_.each(b,function(a){var b=TAAPP.randomBreathIndices(),d=_.map(b,function(a){return TAAPP.words[a]}),e=[a+c,0].concat(d);c+=d.length,Array.prototype.splice.apply(TAAPP.current,e)}),TAAPP.updateTextArea(),TAAPP.updatePos()},TAAPP.generateAudio=function(){TAAPP.state.speechReauthor={words:TAAPP.current},TAAPP.state.exportedTimeline=TAAPP.$timeline.timeline("export"),console.log("exported timeline",TAAPP.state.exportedTimeline),TAAPP.spinner.spin($("body")[0]),$.ajax({url:"reauthor",type:"POST",dataType:"json",contentType:"json",data:JSON.stringify(TAAPP.state),success:function(a){var b=void 0;void 0!==TAAPP.sound&&(b=TAAPP.sound.position,TAAPP.sound.destruct()),TAAPP.sound=TAAPP.createSound(a,b),TAAPP.spinner.stop()},error:function(){TAAPP.spinner.stop()}})},TAAPP.createSound=function(a,b){return soundManager.createSound({id:"speech",url:a.url+"?r="+parseInt(1e4*Math.random()),autoPlay:!1,autoLoad:!0,onplay:function(){$(".playBtn").html('<i class="icon-pause icon-white"></i>')},onresume:function(){$(".playBtn").html('<i class="icon-pause icon-white"></i>').removeClass("btn-success").addClass("btn-warning")},onpause:function(){$(".playBtn").html('<i class="icon-play icon-white"></i>').removeClass("btn-warning").addClass("btn-success")},onload:function(){TAAPP.timing=a.timing,_.each(a.timing,function(a,b){var c=1e3*a;this.onPosition(c,function(){TAAPP.TAManager.highlightWords(b)})},this);var c=1e3*(_.last(a.timing)+2);this.onPosition(c,function(){TAAPP.TAManager.highlightWords(-1)}),TAAPP.$timeline.timeline({sound:this}),void 0!==b&&b<=this.duration&&this.setPosition(b),this.play()},onfinish:function(){TAAPP.TAManager.highlightWords(-1),TAAPP.$timeline.timeline("option","position",0)},whileplaying:function(){TAAPP.$timeline.timeline("option","position",this.position)}})},TAAPP.adjustHeight=function(){var a=window.innerHeight-$("#editorRow").offset().top-50;$("#musicLibrary").height(a+"px"),TAAPP.TAManager.adjustHeight(),TAAPP.hasOwnProperty("sliders")&&TAAPP.sliders.each(function(){$(this).tabSlideOut("refresh")}),TAAPP.RawTAManager.adjustHeight(!0),TAAPP.hasOwnProperty("sliders")&&TAAPP.sliders.each(function(){$(this).tabSlideOut("refresh")})},TAAPP.playFromSelection=function(){var a,b=TAAPP.ta.getSelection(),c=TAAPP.currentRange(b.start),d=TAAPP.timing.length-1;for(console.log(c),console.log(TAAPP.timing),a=0;a<TAAPP.timing.length;a++)if(TAAPP.timing[a][0]>=c[1]){d=a-1;break}console.log(1e3*TAAPP.timing[d][1]),TAAPP.sound.stop(),TAAPP.sound.setPosition(1e3*TAAPP.timing[d][1]),TAAPP.sound.play()},TAAPP.roomTone={obama:{start:996.424,end:1001.143,word:"{gpause}",alignedWord:"gp"},memo:{start:8.1,end:8.489,word:"{gpause}",alignedWord:"gp"}},TAAPP.underlayWizard=function(a){{var b=function(a){var b=(TAAPP.current[a],7>a?a:7),c=TAAPP.current-a<7?TAAPP.current-a:7,d=TAAPP.current.slice(a-b,a+1),e=_.reduce(d,function(a,b){return a+=" "+b.word},""),f=TAAPP.current.slice(a+1,a+c+1),g=_.reduce(f,function(a,b){return a+=" "+b.word},"");return[e,g]};b(a)}$("#underlayE1Select").html('<option value=""></option>'),$("#underlayE2Select").html('<option value=""></option>'),_.each(TAAPP.current,function(c,d){if(c.hasOwnProperty("emphasisPoint")&&c.emphasisPoint){var e=b(d),f=document.createElement("option");$(f).val(d).html("<i>..."+e[0]+' <span class="ePtModalMarker">*</span> '+e[1]+"...</i>").appendTo("#underlayE1Select"),$("#underlayE2Select").append($.clone(f)),d===a&&$(f).prop("selected",!0)}});var c=function(a){a=parseInt(a,10),console.log("DISABLE IDX",a),$("#underlayE2Select option").each(function(b,c){console.log("idx",parseInt($(c).val(),10)),parseInt($(c).val(),10)<=a?$(c).prop("disabled",!0).prop("selected",!1):$(c).prop("disabled",!1)}).closest("select").trigger("liszt:updated")};c($("#underlayE1Select").val()),$("#underlayE2Select").trigger("liszt:updated"),$("#underlayE1Select").trigger("liszt:updated").unbind(".underlayWizard").bind("change.underlayWizard",function(){var a=$("#underlayE1Select").val();c(a)}),$("#underlayE2Select").chosen({allow_single_deselect:!0}),$("#underlayModal").modal("show")},TAAPP.createUnderlay=function(a,b,c){console.log("In create underlay. Word index",a);var d=_.reduce(TAAPP.current.slice(0,a+1),function(a,b){return void 0!==b.pauseLength?a+b.pauseLength:a+b.end-b.start},0);console.log("Speech length",d);var e=function(a){TAAPP.use("createSimpleUnderlay");var c=500,e=a[0],f=1e3*e-c,g=TAAPP.songInfo[b],h=f-15e3;15>d&&(h+=1e3*(15-d)),0>h&&(h=0);var i=f+21e3;i>g.dur&&(i=g.dur);var j=[0,3e3,f-h-500,f-h+500,f-h+5e3,f-h+6e3,i-h-3500,i-h-500],k=[0,.15,.15,.75,.75,.15,.15,0],l=document.createElement("div");$(l).musicWaveform({data:g.wfData,name:g.name,filename:g.path,dur:g.dur,len:i-h,start:h,musicGraph:g.graph,volume:{x:j,y:k},loopCallback:function(){TAAPP.use("addLoop")}}),TAAPP.$timeline.timeline("addWaveform",{elt:l,track:TAAPP.speakers.length,pos:1e3*d+h-f}),TAAPP.updateMusicVolumeDropdown()},f=function(e){TAAPP.use("createConstrainedUnderlay");var f,g,h,i=TAAPP.current[a],j=TAAPP.TAManager.tas[i.taIdx],k=TAAPP.current[a].taPos+TAAPP.current[a].word.length;if(TAAPP.TAManager.insertWords(["{gp-"+e.solo1+"}"],k,j),f=TAAPP.current[c+1],g=TAAPP.TAManager.tas[f.taIdx],h=TAAPP.current[c+1].taPos+TAAPP.current[c+1].word.length,TAAPP.TAManager.insertWords(["{gp-"+e.solo2+"}"],h,g),e.before>0)var l=_.map([0,3,e.before-1,e.before,e.before+e.solo1-1.5,e.before+e.solo1-.5,e.before+e.solo1+e.middle-1,e.before+e.solo1+e.middle,e.before+e.solo1+e.middle+e.solo2-1.5,e.before+e.solo1+e.middle+e.solo2-.5,e.total-3.5,e.total-.5],function(a){return 1e3*a}),m=[0,.15,.15,.75,.75,.15,.15,.75,.75,.15,.15,0];else var l=_.map([0,e.solo1-1.5,e.solo1-.5,e.solo1+e.middle-1,e.solo1+e.middle,e.solo1+e.middle+e.solo2-1.5,e.solo1+e.middle+e.solo2-.5,e.total-3.5,e.total-.5],function(a){return 1e3*a}),m=[.75,.75,.15,.15,.75,.75,.15,.15,0];var n=TAAPP.songInfo[b],o=document.createElement("div");$(o).musicWaveform({data:n.wfData,name:n.name,filename:n.path,dur:n.dur,len:1e3*e.total,currentBeats:e.beats,musicGraph:n.graph,volume:{x:l,y:m},loopCallback:function(){TAAPP.use("addLoop")}}),TAAPP.$timeline.timeline("addWaveform",{elt:o,track:TAAPP.speakers.length,pos:1e3*(d-e.before+.5)}),TAAPP.updateMusicVolumeDropdown()};if(TAAPP.spinner.spin($("body")[0]),void 0===c){if(TAAPP.songInfo[b].hasOwnProperty("changepoints"))e(TAAPP.songInfo[b].changepoints),TAAPP.spinner.stop();else{var g=TAAPP.songInfo[b].basename;$.getJSON("changepoints/"+g,function(a){TAAPP.songInfo[b].changepoints=a.changepoints,e(a.changepoints),TAAPP.spinner.stop()})}for(var h=TAAPP.current.slice(a+1),i=0;"sp"===h[0].alignedWord||"{BR}"===h[0].alignedWord||"gp"===h[0].alignedWord;){i+=1;var j=h.splice(0,1)[0];console.log("REMOVED",j),TAAPP.TAManager.pruneCurrent(a+1,a+2,!1)}var k=TAAPP.current[a],l=TAAPP.TAManager.tas[k.taIdx],m=TAAPP.current[a].taPos+TAAPP.current[a].word.length;TAAPP.TAManager.insertWords(["{gp-6}"],m,l)}else{for(var n=TAAPP.current.slice(a+1,c+1),i=0;"sp"===n[0].alignedWord||"{BR}"===n[0].alignedWord||"gp"===n[0].alignedWord;){i+=1;var j=n.splice(0,1)[0];console.log("REMOVED",j),TAAPP.TAManager.pruneCurrent(a+1,a+2,!1)}c-=i;for(var h=TAAPP.current.slice(c+1);"sp"===h[0].alignedWord||"{BR}"===h[0].alignedWord||"gp"===h[0].alignedWord;){i+=1;var j=h.splice(0,1)[0];console.log("REMOVED2",j),TAAPP.TAManager.pruneCurrent(c+1,c+2,!1)}i>0&&TAAPP.TAManager.refresh();var o=_.reduce(n,function(a,b){return b.hasOwnProperty("pauseLength")&&void 0!==b.pauseLength?a+b.pauseLength:a+b.end-b.start},0),p=15.5;p>d&&(p=d);var g=TAAPP.songInfo[b].basename;$.getJSON("underlayRetarget/"+g+"/"+o+"/"+p+"/15.0",function(a){f(a),TAAPP.spinner.stop()})}},TAAPP.buildWaveform=function(a,b){var c=[];if("textaligned"===b)console.log("SPEAKERS",TAAPP.speakers),_.each(TAAPP.speakers,function(b){var d=document.createElement("div");console.log("creating text aligned waveform"),$(d).textAlignedWaveform({dur:a.duration,len:a.duration,filename:a.url,name:"Speech - "+b,currentWords:TAAPP.current,emphasisPointFunc:TAAPP.underlayWizard}),TAAPP.currentWaveforms[b]=d,TAAPP.TAManager.textAlignedWfs=TAAPP.currentWaveforms,c.push(d)});else{var d=document.createElement("div");$(d).waveform({dur:a.duration,len:a.duration,name:a.id}),c.push(d)}return console.log("in buildWaveform",d),1===TAAPP.speakers.length?$.getJSON("static/speechtracks/wfData/"+TAAPP.speech+".wav.json",function(a){$(c).wf({data:a.mid})}):_.each(TAAPP.speakers,function(a,b){$.getJSON("static/speechtracks/wfData/"+TAAPP.speech+"-"+a+".wav.json",function(a){$(c[b]).wf({data:a.mid})})}),c},TAAPP.origSoundURL=function(){return void 0!==TAAPP.env&&"production"===TAAPP.env,"static/speechtracks/"+TAAPP.speech+".mp3"},TAAPP.loadOriginal=function(){var a={url:TAAPP.origSoundURL(),id:"orig",autoLoad:!0,onload:function(){console.log("loaded original sound");var a=TAAPP.buildWaveform(this,"textaligned"),b=$.map(a,function(a,b){return{elt:a,track:b,pos:0}});TAAPP.$timeline.timeline({tracks:TAAPP.speakers.length+1,pxPerMs:.005,width:"100%",wf:b,linkGroups:[a]}),console.log("calling adjust height after timeline creation"),TAAPP.adjustHeight()},autoPlay:!1};void 0===TAAPP.origSound?soundManager.onready(function(){TAAPP.origSound=soundManager.createSound(a)}):(TAAPP.origSound.destruct(),TAAPP.origSound=soundManager.createSound(a))},TAAPP.use=function(a){TAAPP.state.usageData.hasOwnProperty(a)&&void 0!==TAAPP.state.usageData[a]?TAAPP.state.usageData[a]+=1:TAAPP.state.usageData[a]=1},TAAPP.reset=function(){TAAPP.state.usageData={},TAAPP.state.speechAudio=TAAPP.speech+".mp3",TAAPP.sound&&(TAAPP.sound.destruct(),TAAPP.sound=void 0),TAAPP.current=void 0,TAAPP.timing=void 0,TAAPP.dupes=void 0,TAAPP.currentWaveforms={};try{$(".timeline").timeline("destroy")}catch(a){}TAAPP.$timeline=$(".timeline"),$(".TAManager").html(""),TAAPP.TAManager=void 0,$(".rawTAManager").html(""),TAAPP.RawTAManager=void 0,$(".breathDropdown").html(""),$(".dupeList").html(""),TAAPP.state.outfile=TAAPP.speech+"-"+TAAPP.outfile,$(".dlLink").prop("href","download/"+TAAPP.state.outfile),$.getJSON("alignment/"+TAAPP.speech,function(a){var b=a.words;TAAPP.state.speechText=a.speechText,TAAPP.words=b,_.each(TAAPP.words,function(a,b){a.origPos=b}),TAAPP.current=clone(TAAPP.words),TAAPP.speakers=_.chain(TAAPP.words).map(function(a){return a.speaker}).filter(function(a){return!_.isUndefined(a)}).uniq().value(),TAAPP.TAManager=new TextAreaManager($(".TAManager"),TAAPP.speakers,TAAPP.words,TAAPP.current),TAAPP.updateDupes(),TAAPP._createBreathDropdown(),TAAPP.loadOriginal()})},TAAPP.updateDupes=function(){$.ajax({url:"dupes",type:"POST",dataType:"json",contentType:"json",data:JSON.stringify(TAAPP.state),success:function(a){TAAPP.dupes=a,TAAPP._preprocessDupes(),TAAPP.RawTAManager=new TextAreaManager($(".rawTAManager"),TAAPP.speakers,TAAPP.words,clone(TAAPP.current)),TAAPP.TAManager.insertDupeOverlays(TAAPP.dupes,TAAPP.dupeInfo,!0),TAAPP.RawTAManager.insertDupeOverlays(TAAPP.dupes,TAAPP.dupeInfo,!0)}})},TAAPP._preprocessDupes=function(){var a=_.flatten(_.compact(_.map(TAAPP.dupes,function(a,b){return 1!==a.length?_.map(a,function(c){return{firstWord:c[0][0],dupe:a,dElt:c,idxInDupes:b}}):!1}))),b=_.pluck(a,"firstWord");TAAPP.dupeInfo={starts:a,firsts:b}},TAAPP.drawScript=function(){_.each(TAAPP.dupes,function(a,b){var c=document.createElement("button"),d=document.createElement("button"),e=document.createElement("div");$(c).html('<i class="icon-play icon-white"></i>').addClass("btn btn-success").prop("type","button"),$(d).html('<i class="icon-plus icon-white"></i>').addClass("btn btn-primary"),$(e).addClass("scriptLine");var f=TAAPP.words[a[0][0][1]],g="";if(f.hasOwnProperty("speaker")&&(g=f.speaker+": "),1===a.length){$(c).click(function(){TAAPP.origSound.play({from:1e3*TAAPP.words[a[0][0][0]].start,to:1e3*TAAPP.words[a[0][0][1]].end})}),$(d).click(function(){var b=a[0][0];TAAPP.TAManager.insertWords(_.range(b[0],b[1]+1))});var h=document.createElement("div");$(h).addClass("btn-group").append(c).append(d);var i=document.createElement("span");$(i).text(g+a[0][1]).addClass("scriptLineText"),$(e).append(h).append(i),$(".dupeList").append(e)}else{var j=_.map(a,function(a,b){var c=document.createElement("option");return $(c).val(b).text(a[1]),c}),k=document.createElement("select");$(c).click(function(){var b=$(k).val(),c=a[b][0],d=TAAPP.words[c[0]].start,e=TAAPP.words[c[1]].end;TAAPP.origSound.play({from:1e3*d,to:1e3*e})}),$(d).click(function(){var b=$(k).val(),c=a[b][0];TAAPP.TAManager.insertWords(_.range(c[0],c[1]+1))}),$(k).append(j).prop("name","dupe"+b).addClass("span10"),$(e).addClass("input-prepend").append(c).append(d).append(k),$(".dupeList").append(e)}}),TAAPP.adjustHeight()},TAAPP.reauthor=function(){TAAPP.sound&&TAAPP.sound.pause(),TAAPP.TAManager.highlightWords(-1),TAAPP.generateAudio()},TAAPP.rewind=function(){TAAPP.sound&&TAAPP.sound.setPosition(0)},TAAPP.togglePlay=function(){!TAAPP.sound||1!==TAAPP.sound.playState&&TAAPP.$timeline.timeline("isDirty")?TAAPP.reauthor():TAAPP.sound.togglePause()},TAAPP._timelineClickMode="marker",TAAPP.toggleMode=function(a){"split"===a&&"split"===TAAPP._timelineClickMode?TAAPP._timelineClickMode="marker":"split"===a&&"split"!==TAAPP._timelineClickMode&&(TAAPP._timelineClickMode="split"),TAAPP.$timeline.timeline({clickMode:TAAPP._timelineClickMode})},TAAPP._zoom=function(a){var b=TAAPP.$timeline.timeline("option","pxPerMs");TAAPP.$timeline.timeline({pxPerMs:b*a})},TAAPP.zoomIn=function(){TAAPP._zoom(2)},TAAPP.zoomOut=function(){TAAPP._zoom(.5)},TAAPP.songInfo={},TAAPP.addSongToTimeline=function(a){var b=TAAPP.songInfo[a],c=document.createElement("div");$(c).musicWaveform({data:b.wfData,name:b.name,filename:b.path,dur:b.dur,len:b.dur,musicGraph:b.graph,loopCallback:function(){TAAPP.use("addLoop")}});var d=TAAPP.$timeline.timeline("option","tracks");TAAPP.$timeline.timeline("addWaveform",{elt:c,track:d-1,pos:0}),TAAPP.updateMusicVolumeDropdown()},TAAPP.updateMusicVolumeDropdown=function(){var a=TAAPP.$timeline.timeline("option","wf"),b=$("#musicVolumeItemTemplate").html();$(".musicVolumeDropdown").html(""),_.each(a,function(a){var c=$(a.elt);if("musicWaveform"===c.wf("waveformClass")){var d=TAAPP.songInfo[c.wf("option","name")];console.log("SONG INFO",d,c.wf("option","name"));var e=_.template(b,d);$(e).appendTo(".musicVolumeDropdown").find(".musicVolumeSlider").slider({range:"min",value:$(a.elt).wf("option","globalVolume"),min:0,max:1,step:.01,slide:function(a,b){c.wf("option","globalVolume",b.value)}})}})},TAAPP.addSongToLibrary=function(a){var b=$("#songLibraryTemplate").html();TAAPP.songInfo[a.name]=a,$(_.template(b,{name:a.name,title:a.title,artist:a.artist})).appendTo(".musicLibrary table").find("button").click(function(){TAAPP.addSongToTimeline($(this).attr("data-song-name"))});var c=$("#underlaySongTemplate").html(),d=$(_.template(c,{name:a.name,title:a.title,artist:a.artist})).appendTo("#underlaySongSelect");1===$("#underlaySongSelect option").length&&d.prop("selected",!0),$("#underlaySongSelect").trigger("liszt:updated")},TAAPP.uploadSong=function(a){var b=new FormData(a);return TAAPP.spinner.spin($("body")[0]),$.ajax({url:"uploadSong",type:"POST",success:function(b){$(a).find('[data-dismiss="fileupload"]').trigger("click"),TAAPP.addSongToLibrary(b),TAAPP.spinner.stop()},error:function(){TAAPP.spinner.stop()},data:b,cache:!1,contentType:!1,processData:!1}),!1},TAAPP.loadSite=function(){$("#underlayE2Select").chosen({allow_single_deselect:!0}),$("#underlayE1Select").chosen(),$("#underlaySongSelect").chosen(),$(".gPause").click(function(){TAAPP.use("insertPause");var a=clone(TAAPP.roomTone[TAAPP.speech]);return a.pauseLength=parseFloat($(".gpLen").val()),a.word="{gp-"+a.pauseLength+"}",TAAPP.TAManager.insertWords([a.word]),!1}),$(".genLink").click(TAAPP.reauthor),$(".playBtn").click(TAAPP.togglePlay),$(".rewindBtn").click(TAAPP.rewind),$(".zoomInBtn").click(TAAPP.zoomIn),$(".zoomOutBtn").click(TAAPP.zoomOut),$(".razorBtn").click(function(){$(this).toggleClass("buttonActive"),TAAPP.toggleMode("split")}),$("#songUploadForm").submit(function(){return TAAPP.uploadSong($("#songUploadForm")[0]),!1}),$(".clearWords").click(function(){TAAPP.TAManager.pruneAll()}),$(".emphPt").click(function(){TAAPP.TAManager.insertEmphasisPoint()}),$(".createUnderlayBtn").click(function(){var a=parseInt($("#underlayE1Select").val(),10),b=$("#underlaySongSelect").val(),c=$("#underlayE2Select").val();""===b||void 0===b||isNaN(a)||void 0===a||(""===c?TAAPP.createUnderlay(a,b):TAAPP.createUnderlay(a,b,parseInt(c,10)))}),$(window).resize(function(){TAAPP.adjustHeight(),TAAPP.TAManager.insertDupeOverlays(TAAPP.dupes,TAAPP.dupeInfo,!0)}),TAAPP._commandKey=!1,$(document).keydown(function(a){32===a.which?TAAPP.togglePlay():13===a.which?TAAPP.reauthor():85===a.which?TAAPP.underlayWizard():82===a.which?$(".origSliderHandle").trigger("click"):70===a.which?TAAPP._commandKey||$(".browserSliderHandle").trigger("click"):(91===a.which||93===a.which)&&(TAAPP._commandKey=!0)}),$(document).keyup(function(a){(91===a.which||93===a.which)&&(TAAPP._commandKey=!1)});$("#editorRow");TAAPP.sliders=$(".tabSlider"),$(".origSlider").tabSlideOut({tabHandle:".origSliderHandle",tabLocation:"right",speed:300,action:"click",topPos:"0px",leftPos:"20px",pathToTabImage:"static/img/origSlider.png",imageHeight:"200px",imageWidth:"20px",height:function(){return $("#editorRow").height()},topReferenceElement:$("#editorRow")}),$(".browserSlider").tabSlideOut({tabHandle:".browserSliderHandle",tabLocation:"right",speed:300,action:"click",topPos:"220px",leftPos:"20px",pathToTabImage:"static/img/musicBrowserSlider.png",imageHeight:"200px",imageWidth:"20px",topReferenceElement:$("#editorRow"),height:function(){return $("#editorRow").height()}})},TAAPP.newProject=function(a){void 0===a?(TAAPP.speech=$("select[name=speechSelect]").val(),history.pushState({speech:TAAPP.speech},null,"?speech="+TAAPP.speech)):TAAPP.speech=a,TAAPP.reset()},window.onpopstate=function(a){null!=a.state&&(TAAPP.speech=a.state.speech,""===TAAPP.speech?$("#setupModal").modal("show"):($("#setupModal").modal("hide"),TAAPP.reset()))},$(function(){$("#speechSelect").chosen(),TAAPP.outfile=Math.random().toString(36).substring(12);var a=getParameterByName("speech");history.replaceState({speech:a},null,null),$(document).on("keydown","input",function(a){a.stopPropagation()}),$("#setupModal").modal({show:""===a}).find(".createProjectBtn").click(function(){TAAPP.newProject()}),""!==a&&TAAPP.newProject(a),TAAPP.loadSite()});